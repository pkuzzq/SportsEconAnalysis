---
title: "体育经济分析：理论与应用"
subtitle: "专题二: 微观经济基础2"
author: 
   - 周正卿
date: "`r format(Sys.time(), '%d %B %Y')`"

# xaringan模板
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: yes
      countIncrementalSlides: yes
      ratio: '16:10.85'
    seal: true
    lib_dir: libs

knit: pagedown::chrome_print

# beamer模板

# mainfont: Times New Roman
# fontsize: 10pt
# output: 
#   beamer_presentation: 
#     fonttheme: structurebold
#     theme: Madrid
#     colortheme: lily
#     includes:
#         in_header: "../beamer_header.tex"
#     df_print: tibble
#     latex_engine: xelatex

---
class: center, middle, inverse

```{R, setup, include = F}
# devtools::install_github("dill/emoGG")
library(pacman)
p_load(
  broom, tidyverse,
  ggplot2, ggthemes, ggforce, ggridges,
  latex2exp, viridis, extrafont, gridExtra,
  kableExtra, snakecase, janitor,
  data.table, dplyr, estimatr,
  lubridate, knitr, parallel,
  lfe,dslabs,
  here, magrittr, RcmdrPlugin.KMggplot2
)

options(htmltools.dir.version = FALSE)

# Notes directory
dir_slides <- "~/Users/zhouzhengqing/Desktop/SportsEconAnalysis-master/05_MicroeconBasics2"
# Define pink color
red_pink <- "#e64173"
turquoise <- "#20B2AA"
orange <- "#FFA500"
red <- "#fb6107"
blue <- "#3b3b9a"
green <- "#137934"
grey_light <- "grey70"
grey_mid <- "grey50"
grey_dark <- "grey20"
purple <- "#6A5ACD"
slate <- "#314f4f"
met_slate <- "#272822" # metropolis font color 

# Dark slate grey: #314f4f

# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  warning = F,
  message = F
)
opts_chunk$set(dev = "svg")
options(device = function(file, width, height) {
  svg(tempfile(), width = width, height = height)
})
options(crayon.enabled = F)
options(knitr.table.format = "html")
# A blank theme for ggplot
theme_eMPy <- theme_bw() + theme(
  line = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  plot.margin = structure(c(0, 0, -0.5, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_simple <- theme_bw() + theme(
  line = element_blank(),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text.x = element_text(size = 18, family = "STIXGeneral"),
  axis.text.y = element_blank(),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  # plot.margin = structure(c(0, 0, -1, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_math <- theme_void() + theme(
  text = element_text(family = "MathJax_Math"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_serif <- theme_void() + theme(
  text = element_text(family = "MathJax_Main"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes <- theme_void() + theme(
  text = element_text(family = "Fira Sans Book"),
  axis.title = element_text(size = 18),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = grey_light,
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_market <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.title.x = element_text(hjust = 1, size = 17),
  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),
  # axis.text.x = element_text(size = 12),
  # axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_gif <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_goods <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 17, family = cnfont), 
  axis.text.x = element_text(size = 17),
  axis.text.y = element_text(size = 17, angle = 90, hjust = 0.5),
  axis.title.x = element_text(color = purple, size = 19),
  axis.title.y = element_text(color = red_pink, size = 19),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
theme_game <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 20, family = cnfont), 
  axis.text.x = element_text(size = 20, color = met_slate),
  axis.text.y = element_text(size = 20, angle = 90, color = met_slate, hjust = 0.5),
  axis.title.x = element_text(color = met_slate, size = 20),
  axis.title.y = element_text(color = met_slate, size = 20),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
shift_axis <- function(p, y=0){
  g <- ggplotGrob(p)
  dummy <- data.frame(y=y)
  ax <- g[["grobs"]][g$layout$name == "axis-b"][[1]]
  p + annotation_custom(grid::grobTree(ax, vp = grid::viewport(y=1, height=sum(ax$height))), 
                        ymax=y, ymin=y) +
    geom_hline(aes(yintercept=y), data = dummy, size = 0.5, color = met_slate) +
    theme(axis.text.x = element_blank(), 
          axis.ticks.x = element_blank())
}
wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = "\n")
# functions
demand <- function(x) 10 - x
demand_2 <- function(x) 9 - x
demand_3 <- function(x) 8 - x
demand_inc <- function(x) 11 - x
demand_dec <- function(x) 5 - x
supply <- function(x) 1 + (4/5)*x
step_demand <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8), mv = c(8, 7, 6, 5, 4, 3, 2, 1, 0))
step_demand2 <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(10, 10, 9, 9, 8, 8, 7, 7, 6, 6, 5, 4, 4))
step_supply <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 8, 8))
step_supply_tax <- step_supply %>% 
  mutate(mv = mv + 2)

data <- read_csv("/Users/zhouzhengqing/Desktop/SportsEconAnalysis-master/05_MicroeconBasics2/Activity_Pit_Market/Results.csv") %>% 
  dplyr::filter(!is.na(price))

theme_set(theme_gray(base_size = 20))
# Column names for regression results
reg_columns <- c("Term", "Est.", "S.E.", "t stat.", "p-Value")
# Function for formatting p values
format_pvi <- function(pv) {
  return(ifelse(
    pv < 0.0001,
    "<0.0001",
    round(pv, 4) %>% format(scientific = F)
  ))
}
format_pv <- function(pvs) lapply(X = pvs, FUN = format_pvi) %>% unlist()
# Tidy regression results table
tidy_table <- function(x, terms, highlight_row = 1, highlight_color = "black", highlight_bold = T, digits = c(NA, 3, 3, 2, 5), title = NULL) {
  x %>%
    tidy() %>%
    select(1:5) %>%
    mutate(
      term = terms,
      p.value = p.value %>% format_pv()
    ) %>%
    kable(
      col.names = reg_columns,
      escape = F,
      digits = digits,
      caption = title
    ) %>%
    kable_styling(font_size = 20) %>%
    row_spec(1:nrow(tidy(x)), background = "white") %>%
    row_spec(highlight_row, bold = highlight_bold, color = highlight_color)
}
```

```{css, echo = F, eval = T}
@media print {
  .has-continuation {
    display: block !important;
  }
}
```

# 引言

---

name: schedule

# 课程进度

### 上节课

- 消费者理论 .mono[->] 需求
- 生产者理论 .mono[->] 供给
- 市场机制
- 利用供需曲线分析市场变化
- 市场的溢出效应

### 今天

- 专题二: 微观经济基础2
    - 深入生产者理论

---
layout: true
# 需求理论的分析路线
---
class: title-slide-section,inverse, middle
---
layout: false
## 需求理论的分析路线（中级）

WTP .mono[<->] Value .mono[->] TV and MV (Diminishing MV) .mono[->] 最优购买(P=MV)

.mono[->] 消费者盈余 .mono[->] 个体需求曲线 .mono[=] MV 

---- 

WTP .mono[->]总体需求曲线 .mono[->]

需求"定律" （需求 .mono[v.s.]需求量的变动）.mono[->]

响应（价格不敏感，-1<需求的价格弹性<0；价格敏感，需求的价格弹性<-1）.mono[->]

需求的影响因素（需求的收入弹性：正常品>0、劣等品<0和吉芬品（需求的价格弹性>0）；需求的交叉价格弹性：替代品<0和互补品>0）.mono[->] 需求的变动

---
layout: true
# 生产者理论
---
class: title-slide-section,inverse, middle
---
layout: false
## 供给理论的分析路线（中级）

.hi.slate[回忆]

供给曲线 .mono[==>] 

供给定律 .mono[==>]

决定供给的因素 .mono[==>]

供给的变动


---
## 今天

.hi[目标] 生产者理论的分析路线（高级）

- 生产者如何决策？要素、技术、定价能力
- 供应曲线从何而来？

.hi[Q:] 为什么要深入厂商理论？

.hi[A:] 对理解职业球队决策、职业联盟市场结构与规制有帮助 

**路线**

1. 生产成本 .mono[->] 生产
2. 竞争性市场中的企业 .mono[->]
3. 垄断市场 
---
layout: false
## 生产决策（高级）

.less-right[生产者理论主要是指厂商经济行为模型。职业联盟是由多球队构成，球队行为决定了联盟结构，因此本讲中会稍作深入讲解。

- .hi.slate[成本线：生产成本、生产技术、厂商决策]

- 收入线：定价能力、市场结构
]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="500">

]

---
## 利润

**假设:** 企业的目标是寻求利润最大化

- 利润 .mono[=]总收入 .mono[-] 总成本

- 在长期内，企业必须以利润最大化为目标，否则就会被市场淘汰。

- 在短期内，由于所有者(董事长)与经营者（总经理）分离，可能会在一定程度上偏离企业利润最大化的目标，而追求其他利益的目标（个人享受，政治特权，社会知名度等）。

<br>
**问：**体育领域是否所有产权主体都试图实现利润最大化？

**答：** 未必。升降级制的联赛俱乐部(胜率)；国际体育NGO(国际政治)。

---
## 利润最大化

为了实现利润最大化，厂商必须回答的几个问题:

- 应该生产多少？

- 应该设定什么价格？

- 应该投入多少生产要素。雇佣劳动力？购买资本？

- 应该继续生产还是停产？

---
## 利润最大化

对这些问题的回答取决于 

1. 生产技术 .mono[-->] 成本结构(资本密集、技术密集、劳动密集)

2. 市场结构 .mono[-->] 定价格的能力

3. 短期 *vs.* 长期

---
class: inverse, middle

# 生产成本

---
## 成本

- 稀缺性  .mono[->] 机会成本
  
  - 厂商生产的机会成本：生产者所放弃的使用相同生产要素在其他生产用途中所能得到的最高收入。因此,这里的生产成本应从机会成本来理解。

- .purple[显成本(explicit cost)] 与 .pink[隐成本(implicit cost)]

  - 显成本:在要素市场上，从**其他经济主体**购买或租用的**实际支出**。从机会成本来看，总支出就等于这些购买或租用的生产要素（**利息、租金和工资等**）在**次优**路径上得到的最高收入。

  - 隐成本:厂商**已有**生产要素(闲置不算)在**其他公开市场的价值**。已有要素**本就有**对等的总价值。从机会成本看，它们在**次优**路径上同样会获得收入。
  

---
## 成本

### 总成本.mono[=] .purple[显成本] .mono[+] .pink[隐成本]

### .purple[显成本]

- *一般是* 工资、租金、原材料、维修费、缴纳税款, *等*

### .pink[隐成本]

- 丧失的次优投资价值，例如，*等额的固定资产投入，在股票市场的回报*等等。

---

### 例子：创业的显成本与隐成本

用100万创业，利率是5%

.pink[选项1：]借100万

- 显成本 .mono[=] 5万

.pink[选项2：]动用40万的储蓄，借60万

- 显成本 .mono[=] 3万 .mono[<--] 偿还5%的贷款利息

- 隐成本 .mono[=] 2万 .mono[<--] 从储蓄中拿出40万RMB，放弃5%的利息

.pink[任一方案的总成本 .mono[=] 5万]

PS: 投资时不应忽略**隐成本**

---
## 会计利润 *vs.* 经济利润 

### 会计利润 <br> $\quad$ .mono[=] 总收入 .mono[-] .pink[显成本]

### 经济利润 <br> $\quad$ .mono[=] 总收入 .mono[-] (.pink[显成本] .mono[+] .purple[隐成本])  <br> $\quad$ .mono[=] 会计利润 .mono[-] .purple[隐成本]

**重要** 

.center[
## 会计利润 .mono[>] 经济利润
]

---
## 会计利润 *vs.* 经济利润 

所以正的会计利润并不总是意味着一家公司做得很好

-  经济利润 .mono[<] 0 <br> $\quad$ .mono[==>] 当前业务的利润低于次优选择

-  经济利润 .mono[=] 0 <br> $\quad$ .mono[==>] 当前业务与次优选择一样有利可图

-  经济利润 .mono[>] 0 <br> $\quad$ .mono[==>] 当前业务比次优选择更有利可图
---
class: inverse, middle

# 生产
---
##生产技术

.hi.pink[产出：] 产品

.hi.pink[投入：] 用于生产的资源

- 土地：不仅指土地本身，还包括地上和地下的一切自然资源，如森林、江河湖泊、海洋和矿藏等 .mono[->] 地理位置、
- 劳动力：指人类在生产过程中提供的体力和智力的总和，如工人、管理人员等 .mono[->] 高技术、低技术；制度环境
- 资本：表现为实物形态或货币形态，如厂房、机器设备、动力燃料、原材料、电脑、车辆等 

.hi.pink[生产函数: ]对企业生产过程中投入和产出之间关系的数学描述。

.center[
.hi.pink[要素投入 .mono[-->] 生产技术 .mono[-->] 产出]
] 


---
## 总产量(TP)函数

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "TP") +
  stat_function(fun = total_product, color = purple, size = 1)
```
]

.less-right[
### 定义

> 一定数量的要素投入对应的产量

**例子：**假设生产函数 $TP=f(L, K)$ ，其中在一定时期内 $K$ 的数量固定，所以厂商要改变产量就只能改变 $L$ 。这种单可变要素的生产函数称为**短期生产函数**
$TP=f(L, \bar{K})$ 
]

---
count: false
## 总产量(TP)的阶段

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "TP") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速度递增", 15), x = 2.67/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速度递增", 15), x = (2.67 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 15), x = (7.5 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  geom_ribbon(aes(x = z, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank") + # PS
  geom_ribbon(aes(x = u, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank")
```
]

.less-right[
### 定义

> 一定数量的要素投入对应的产量

**例子：**假设生产函数 $TP=f(L, K)$ ，其中在一定时期内 $K$ 的数量固定，所以厂商要改变产量就只能改变 $L$ 。这种单可变要素的生产函数称为**短期生产函数**
$TP=f(L, \bar{K})$ 
]
---
## 边际产量MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 
q_1 <- total_product(3)
q_2 <- total_product(4)

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) +
  theme_market +
  labs(x = "L", y = "TP") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_point(aes(x = 3, y = q_1), color = met_slate, size = 2) +
  geom_point(aes(x = 4, y = q_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 4, y = 0, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_1, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_2, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 10, xend = 4 - 0.1, yend = 10), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_segment(aes(x = 0.5, y = q_1 + 0.75, xend = 0.5, yend = q_2 - 0.75), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  annotate("text", label = expression(Delta*"TP"=="边际产量"), x = 2, y = (q_1 + q_2)/2, color = met_slate, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"L"==1), x = 3.5, y = 7.5, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
### 定义

> 增加一单位可变要素劳动投入量所增加的产量

**例子:** 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
count: false
## 边际产量MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) 

shift_axis(mp1)
```
]

.less-right[
### 定义

> 增加一单位可变要素劳动投入量所增加的产量

**例子:** 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
count: false
## 边际产量MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速递增", 22), x = 2.67/2 - 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速递增", 22), x = (2.67 + 5.68)/2 + 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 22), x = (7.5 + 5.68)/2, y = 14.75, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.less-right[
### 定义

> 增加一单位可变要素劳动投入量所增加的产量

**例子:** 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入


]

---
## 边际产量递减规律

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("边际产量上升", 18), x = 2.67/2 - 0.0, y = 14.85, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("边际产量下降", 18), x = (2.67 + 7.5)/2 + 0.0, y = 14.85, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.less-right[
### 解释

当在其他投入数量固定的情况下，只有一种要素投入时.purple[边际产品最终为负]。

]
---
## TP、AP和MP的关系

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
第一阶段：投入量**在0到L1**之间，平均产量始终上升，达到最大值；边际产量上升，达到最大值后开始下降，且**边际产量始终大于平均产量**。这一阶段总产量始终是增加的。这说明：在这一阶段不变要素的投入量是相对过剩，生产者增加**可变要素（比如劳动）投入量**是有利的。
]
---
count: false

## TP、AP和MP的关系

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
第二阶段：投入量在**L1到L2**之间这个阶段的起点处，**平均产量曲线和边际产量曲线相交**，即平均产量达到最高点。而在这个阶段的终点处，边际产量曲线与水平轴相交，即劳动的**边际产量等于零**。
]
---
count: false

## TP、AP和MP的关系

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
第三阶段：投入量**超过L2**，**平均产量下降**，**边际产量为负**，**总产量也呈现下降**。这说明这一阶段可变要素（劳动）的投入量相对过多，生产者减少可变要素的投入是有利的。
]

---
count: false

## 生产阶段的决策

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
理性的生产者既不会将生产停留在第一阶段，也不会将生产扩张到第三阶段，所以只能在第二阶段进行。因此第二阶段是生产者进行短期生产的决策区间。
**至于在第二阶段的哪一点才能达到利润最大化，需要结合成本、收入和利润进行深入分析**。
]

---
## MP 对 AP 影响的数学表达

设 $T P=Q=f(L) ; A P_{L}=T P / L$，
$L$ 的平均产量对 $L$ 投入的变化率 :


$\frac{d A P_{L}}{d L}=\frac{d(T P / L)}{d L}=\frac{d(Q / L)}{d L}=\frac{\frac{d Q}{d L} L-\frac{d L}{d L} Q}{L^{2}}$


$=\frac{\frac{d Q}{d L} L-Q}{L^{2}}=\frac{1}{L}(\underbrace{\frac{d Q}{d L}}_{M P_{L}}-\underbrace{\frac{Q}{L}}_{A P_{L}})$


- 当 $M P_{L}>A P_{L}, A P_{L}$ 处于递增阶段
- 当 $M P_{L}<A P_{L}, A P_{L}$ 处于递减阶段
- 当 $M P_{L}=A P_{L}, A P_{L}$ 达到最大值

---
## 直觉：在边际处进行要素投入决策

.pink[Q: ]厂商如何决定生产多少产量？

- 利润角度 .mono[->] 只要能增加利润，就会生产
- 利润 .mono[=] 收入 .mono[-] 成本 
- Max 利润 .mono[->] MR v.s. MC

.pink[A: ]边际上考虑

- 若额外生产一单位产品的成本(MC) .mono[<] 其销售收入(MR=MP*P)，那么利润就会随着产量的增加而增加。

- 若额外生产一单位产品的成本(MC) .mono[>] 其销售收入(MR=MP*P)，那么利润就会随着产量的增加而下降。

---
class: clear-slide
## 例子：农场主的要素投入决策过程

.pink[Q: ]假设你是一个西瓜农场主。如果一个西瓜的价格是5元，市场工资是每月2000元，你应该雇佣多少名工人？

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("", "", "", "", "", ""),
  v4 = c("", "", "", "", "", ""),
  v5 = c("￥2000", "￥2000", "￥2000", "￥2000", "￥2000", "￥2000")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "Marginal Product", "VMP = MP &times; P", "Wage"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
## 例子：农场主的要素投入决策过程
.pink[Q: ]假设你是一个西瓜农场主。如果一个西瓜的价格是5元，市场工资是每月2000元，你应该雇佣多少名工人？

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("&mdash;", 1000, 800, 600, 400, 200),
  v4 = c("", "", "", "", "", ""),
  v5 = c("￥2000", "￥2000", "￥2000", "￥2000", "￥2000", "￥2000")) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "Marginal Product", "VMP = MP &times; P", "Wage"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
## 例子：农场主的要素投入决策过程
.pink[Q: ]假设你是一个西瓜农场主。如果一个西瓜的价格是5元，市场工资是每月2000元，你应该雇佣多少名工人？

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("&mdash;", 1000, 800, 600, 400, 200),
  v4 = c("&mdash;", "￥5000", "￥4000", "￥3000", "￥2000", "￥1000"),
  v5 = c("￥2000", "￥2000", "￥2000", "￥2000", "￥2000", "￥2000")) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "Marginal Product", "VMP = MP &times; P", "Wage"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

.purple[**边际上的思考：**]只要 .purple[边际产品.mono[&times;] 价格] $\geq$ .purple[工资]，继续雇用

.pink[A: ] .pink[雇用4名]
---
<br><br><br><br><br>

TP .mono[->] AP和MP

MP已知、P(假设已知)，那么如何计算MC呢？

与TP .mono[->] MP 的分析思路一样，TC .mono[->] MC 

---
class: clear-slide
## 例子：总成本TC
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("", "", "", "", "", ""),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
## 例子：总成本TC
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("￥1000", "￥1000", "￥1000", "￥1000", "￥1000", "￥1000"),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
## 例子：总成本TC
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("￥1000", "￥1000", "￥1000", "￥1000", "￥1000", "￥1000"),
  v4 = c("￥0", "￥2000", "￥4000", "￥6000", "￥8000", "￥10000"),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
## 例子：总成本TC
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("￥1000", "￥1000", "￥1000", "￥1000", "￥1000", "￥1000"),
  v4 = c("￥0", "￥2000", "￥4000", "￥6000", "￥8000", "￥10000"),
  v5 = c("￥1000", "￥3000", "￥5000", "￥7000", "￥9000", "￥11000")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
class: clear-slide
## 例子：总成本TC
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

.center[.purple[**TC曲线**]]

.pull-left[
```{R, echo = F, escape = F}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c("￥1000", "￥3000", "￥5000", "￥7000", "￥9000", "￥11000")
) 
cost_data %>% 
  kable(
  escape = F,
  col.names = c("西瓜 (Q)", "Total Cost"),
  align = c("c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```
]

.pull-right[
```{r, echo = FALSE, fig.height = 3.25, fig.width = 4.25, dev = "svg"}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c(1000, 3000, 5000, 7000, 9000, 11000)
) 
cost_data %>% 
  ggplot(aes(x = q, y = tc)) +
  scale_x_continuous(limits = c(0, 3500)) +
  scale_y_continuous(limits = c(0, 12000), expand=c(0, 0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "TC") +
  geom_point(size = 2, color = purple) +
  geom_line(size = 1, color = purple)
```
]

---
## 供给理论的分析路线（高级）

- 概念：生产成本，会计利润 .mono[>] 经济理论
- 生产技术， $TP$ 函数 .mono[=>] $MP$ 是 $TP$ 的切线斜率 ； $AP$ 是原点到 $TP$ 上点的连线夹角的tan值
  - $MP$ 先增后减，最终为负
  - 生产决策在 $AP_L=MP_L$ 到 $MP_L=0$ 区间内
      - $AP_{max}$ 劳动效率最大； $MP=0$ => $TP_{max}$ <=> $TP_{max}/\bar{K}$ 资本效率最大
- 瓜农： $MC = MR$ (产品市场)，实际是 $MRP_{L}(L的边际收入产品)=ME_{L}(边际雇佣费用)$ 决策雇佣劳动力的数量， $MRP_L\equiv \Delta {TR} /\Delta{L}=MP_L \times MR$ 
  - 插播：产品市场生产 => 劳动力需求
  - 劳动力的短期雇佣条件为： $MRP=ME_{L}$
  - 完全竞争产品市场 + 完全竞争劳动力市场， $MRP_L=VMP_{L}$ ， $ME_{L}=w$ ， $VMP_L \equiv MP_L \times {P}$ 为劳动力的边际产品价值 
  - $MP_L$ 和 $AP_L$ 生产决策 =>  $VMP_L$ 和 $VAP_L$ 的雇佣决策以及短期劳动力需求曲线 <=> $MRP_L$ 

---
## 总成本TC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "TC") +
  stat_function(fun = total_cost, color = purple, size = 1) 
```
]


TP函数 .mono[+] 投入要素价格 <br> .mono[-->] .purple.hi[**TC曲线**] 。

.pink[Q: ]为什么总成本曲线是S型？

.pink[A: ] .purple.hi[边际产量递减] 

--

为什么？图形上如何理解？

用MP .mono[->] TC


---
## 边际成本MC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
tc_1 <- total_cost(3)
tc_2 <- total_cost(4)

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) + 
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "TC") +
  stat_function(fun = total_cost, color = purple, size = 1) +
  geom_point(aes(x = 3, y = tc_1), color = met_slate, size = 2) +
  geom_point(aes(x = 4, y = tc_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = tc_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 4, y = 0, xend = 4, yend = tc_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = tc_1, xend = 3, yend = tc_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = tc_2, xend = 4, yend = tc_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 10, xend = 4 - 0.1, yend = 10), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_segment(aes(x = 0.5, y = tc_1 + 0.75, xend = 0.5, yend = tc_2 - 0.75), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  annotate("text", label = expression(Delta*"TC"=="边际成本"), x = 2 - 0.5, y = (tc_1 + tc_2)/2, color = met_slate, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"TP"==1), x = 3.5, y = 7.5, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
### 定义

> 产量增加一个单位所产生的总成本的变化。

]

---
count: false
## 边际成本MC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
marginal_cost <- function(x) 10 - 8*x + 3*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "SMC") +
  stat_function(fun = marginal_cost, color = purple, size = 1) 
```
]


### 定义

> 产量增加一个单位所产生的总成本的变化。 



--

用MP .mono[->] SMC



---
## TC构成：固定成本 .mono[*vs.*] 可变成本

### 总成本 .mono[=] .green[固定成本] .mono[+] .pink[可变成本]

### .green[固定成本]

> .green[成本不随产出数量的变化而变化]

- 如租金、设备成本、贷款支付等

- 对边际成本MC没有影响

---
## TC构成：固定成本 .mono[*vs.*] 可变成本

### 总成本 .mono[=] .green[固定成本] .mono[+] .pink[可变成本]


### .pink[可变成本]

> .pink[成本随产出数量变化而变化]

- 如工资, 原材料成本等

- 对边际成本MC有影响

---
## TC构成：固定成本 .mono[*vs.*] 可变成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
vc <- function(x) 10*x - 4*x^2 + x^3
fc <- function(x) 10

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = fc, color = green, size = 1) +
  stat_function(fun = total_cost, color = purple, size = 1) +
  stat_function(fun = vc, color = red_pink, size = 1) +
  annotate("text", label = "TC", x = 3.6, y = 50, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = "VC", x = 4.75, y = 50, color = red_pink, family = cnfont, size = 7.7) +
  annotate("text", label = "FC", x = 4.75, y = 13, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
### .green[固定成本(FC)]


### .pink[可变成本 (VC)]

]

---
## 平均固定成本 AFC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
afc <- function(x) 10/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = afc, color = green, size = 1) +
  annotate("text", label = "AFC", x = 4.75, y = 5.5, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
### 定义

> AFC .mono[=] FC &divide; TP

随着产量上升而减少 <br> .mono[-->] 更多产出分摊FC

]

---
## 平均可变成本 AVC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = avc, color = red_pink, size = 1) +
  annotate("text", label = "AVC", x = 4.75, y = 18, color = red_pink, family = cnfont, size = 7.7)

```
]

.less-right[
### 定义

> AVC .mono[=] VC &divide; TP

]

---
## 平均总成本 ATC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[
### 定义

> ATC .mono[=] TC &divide; TP <br> .mono[=] AFC .mono[+] AVC

]

---
count: false
## 有效规模 .mono[*vs.*] ATC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 7.7) +
  geom_vline(xintercept = 2.69, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = "有效规模", x = 2.69, y = 60, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
### 定义

> ATC .mono[=] TC &divide; TP <br> .mono[=] AFC .mono[+] AVC

有效规模 .mono[=]  使ATC最小化的产量TP
]

---
## 有效规模 .mono[*vs.*] ATC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x
afc <- function(x) 10/x
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 7.7) +
  geom_vline(xintercept = 2.69, color = met_slate, size = 1, linetype = "dashed") +
  stat_function(fun = afc, color = green, size = 1) +
  annotate("text", label = "AFC", x = 4.75, y = 5.5, color = green, family = cnfont, size = 7.7) +
  stat_function(fun = avc, color = red_pink, size = 1) +
  annotate("text", label = "AVC", x = 0.4, y = 5, color = red_pink, family = cnfont, size = 7.7) +
  annotate("label", label = "有效规模", x = 2.69, y = 60, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[

有效规模 .mono[=]  使ATC最小化的产量TP

TP .mono[<] 有效规模：.hi.green[AFC]的下降会拉低.hi.purple[ATC]

TP .mono[>] 有效规模：.hi.red_pink[AVC]的上升会拉高.hi.purple[ATC]
]

---
## MC .mono[*vs.*] ATC

.more-left[

```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x
marginal_cost <- function(x) 10 - 8*x + 3*x^2
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 7.7) +
  stat_function(fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 4.8, y = 50, color = red_pink, family = cnfont, size = 7.7) +
  geom_vline(xintercept = 2.69, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = "有效规模", x = 2.69, y = 60, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
类比MP与AP

.hi.red_pink[MC] .mono[<] .hi.purple[ATC] .mono[==>] .hi.purple[ATC]下降

.hi.red_pink[MC] .mono[>] .hi.purple[ATC] .mono[==>] .hi.purple[ATC]上升

.hi.red_pink[MC] **在最小ATC处** 穿过

]
---
## 短期成本分类

![umcxI1](https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/umcxI1.png)


---
## 短期 .mono[*vs.*] 长期

### 短期

某些要素投入是固定的，如土地、工厂、装配线机器人等资本要素投入固定

- 固定投入 .mono[-->] 固定成本

### 长期

所有要素投入是可变的，如厂商可以建立新工厂或出售现有工厂

- 厂商**必须而且可以**配给(rationing)最有效的要素组合，以追求有效产出规模

---
## 长期平均总成本 LATC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data <- tibble(
  q = seq(0, 6, 0.01),
  atc_s = 18 - 8*q + 3*q^2,
  atc_m = 30- 16*q + 3*q^2,
  atc_l = 60 - 24*q + 3*q^2
) %>% 
  mutate(atc = case_when(atc_s <= atc_m & atc_s <= atc_l ~ atc_s,
                         atc_m <= atc_s & atc_m <= atc_l ~ atc_m,
                         atc_l <= atc_s & atc_l <= atc_m ~ atc_l))

cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = atc_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_l), color = orange, size = 1, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SATC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SATC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SATC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "TP", y = "￥")
```
]

.less-right[

- 厂商可以选择从3个工厂规模: S、M、L，按照发展规模从小到大

- 每种规模都有自己的SATC曲线

- 长期可以改变不同规模，但短期不能

]

---
## 长期平均总成本 LATC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = atc_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_l), color = orange, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc), color = purple, size = 1.5, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SATC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SATC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(LATC), x = 4, y = 8.5, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = expression(SATC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "TP", y = "￥")
```
]

.less-right[

长期，厂商会选择任一发展规模下的有效规模

- 几何上的 **包络线(Envelope)**

]

---
## 长期平均总成本 LATC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
atc <- function(x) 10 - 2.75*x + 0.5*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 11), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 4.5, y = 6.4, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[
经典的LATC曲线

- 由许多SATC曲线追溯出来

- "微笑曲线"
 
至于厂商会在选择何种LATC .mono[<==] **规模报酬**

]

---
## 规模报酬 Returns to Scale

- 规模经济，也叫内在经济(economies of scale)

> LATC 随着产出数量的增加而下降的阶段
- 专业化程度变高、知识和技术的溢出效应。例如初创科技公司？

- 规模报酬不变 (constant returns to scale)

> LATC 随着产出数量的增加而保持不变的阶段。例如连锁店?

- 规模不经济，也叫内在经济(diseconomies of scale)

> LATC 随着产出数量的增加而上升的阶段
- 大而慢。例如医院？

---
layout: false
## 生产者理论的分析路线（高级）

.less-right[生产者理论主要是指厂商经济行为模型。职业联盟因为是由多个厂商（俱乐部）构成，俱乐部行为决定了联盟结构，因此本讲中会稍作深入讲解。

- 成本线：生产成本、生产技术、厂商决策

- .hi.slate[收入线：定价能力、市场结构]

]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="500">

]

---
class: inverse, middle

# 竞争市场中的厂商行为

---
## 市场结构的4大因素

- 市场是物品买卖双方相互作用并得以决定其交易价格和数量的一种**组织形式或制度**

- 市场可以是有形场所，也可以是一个虚拟平台

- 有多少种交易商品，就有多少个市场

- 划分市场类型的5大因素： 
    - 买卖方数目
    - 产品差异度
    - 行业壁垒性: 厂商进入/退出一个行业的难易程度
    - 价格控制力: 单个厂商对价格的控制程度
    - 信息完备性

---

## 市场结构的分类

.center[
<img src="figure/markstruc.svg"  height="450" width="600" >
]

---
## 完全竞争性市场

### 条件

1. 买卖方数目: 许多买家和卖家

2. 产品差异度: 相同的、无差异的产品 

3. 行业壁垒性: 自由进入和退出

4. 信息完备的: 消费者和厂商可根据完备信息作出最优决策


### 结果

**没有市场势力: ** 厂商无法操控价格

- 每家企业都是 **价格接受者**

---
## 完全竞争性市场

**问：**现实中，几乎没有完全竞争性市场，为什么费力地建立一个模型？

**答.sub[1]:** 为建立更现实的情景模型奠定基础

- 简单，但是可以解释更多原因

- 对其他市场结构的启示

**答.sub[2]：** 建立一个基准，与 "现实世界 "进行比较

- 通过比较现实世界的市场条件和完全竞争市场的基准条件，可以回答"我们怎样做得更好？"的问题


---
## 总收入、平均收入和边际收入

.center[
#### 总收入.mono[=] 销售数量 .mono[*] .pink[销售价格]
]

完全竞争厂商的销售数量等于它所面临的需求量，销售价格就是产品的市场价格。
- **总收入** 是厂商按一定价格出售一定量产品时所获得的全部收入<br> $T R(TP)=P \cdot TP=\bar{P} \cdot TP$

- **平均收入** 是厂商在平均每单位产品销售上所获得的收入<br> $AR(TP)=\frac{T R(TP)}{TP}=\frac{\bar{P} \cdot TP}{TP}=\bar{P}$ 

- **边际收入** 是厂商增加一单位产品销售所获得的总收入的增量 $M R(TP)=\frac{\Delta T R(TP)}{\Delta TP}=\frac{d T R(TP)}{d TP}=\frac{d(\bar{P} \cdot TP)}{d TP}=\bar{P}$

- 完全竞争厂商的平均收入 $AR$ ，边际收入 $MR$ 和需求曲线 $D$ **三者重叠**的

- 总收入曲线是从原点出发斜率为 $\bar{P}$ 的射线

---
## 实现利润最大化的条件


边际收入 $M R$ 等于边际成本 $M C$ 是厂商实现利润最大化的均衡条件。
<br></br>
厂商利润为 $\pi(TP)=T R(TP)-T C(TP)$

利润最大化要满足一阶导数为零

$\frac{d \pi(TP)}{d(TP)}=\frac{d T R(TP)}{d TP}-\frac{d T C(TP)}{d TP}=0$

由此得出 $M R(TP)-M C(TP)=0$, 即 $M R(TP)=M C(TP)$
<br></br>
以上条件是必要条件，并非充分条件。即要实现利润最大化，必须有 $M R(TP)=M C(TP)$ 。但反过来，如果 $M R(TP)=M C(TP)$ 则不一 定实现利润最大化，因为还可能是利润最小化的点。这时需要结合利润函数的二阶导数 $\frac{d^{2} \pi(TP)}{d TP^{2}}=M R^{\prime}(TP)-M C^{\prime}(TP)<0$ 来判断。
---
## 边际收入

.less-right[
- 定义

> 产出增加一个单位所产生的总收入的变化

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 10, y = 7.6, color = red_pink, family = cnfont, size = 9) +
  annotate("text", label = expression(Delta*"TR"=="MR"), x = 4, y = 4, color = green, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"TP"==1), x = 4, y = 1.5, color = met_slate, family = cnfont, size = 4) +
  geom_point(aes(x = 3, y = 7), color = met_slate, size = 2) +
  geom_point(aes(x = 5, y = 7), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 5, y = 0, xend = 5, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 1, xend = 5 - 0.1, yend = 1), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = 0, ymax = 7), alpha = 0.2, fill = green)
```
]

---
## 边际收入

.less-right[
企业在完全竞争市场中

- MR .mono[<=>] D需求

- MR .mono[=] P

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = green, size = 1) +
  annotate("text", label = expression(MR==P), x = 8, y = 7.6, color = green, family = cnfont, size = 9)
```
]

---
## 完全竞争市场厂商的利润最大化(短期)

- 厂商面对的价格是给定的

- 短期内厂商无法调整生产规模(固定成本给定、其他要素投入给定，如资本)

- 给定的生产规模下，厂商通过调整产量来实现 MR = MC 以满足利润最大化的均衡条件。
---
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(8)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost, p), labels = c(8, 12)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1)+
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
    annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("8", "￥96.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("8", "￥96.00", "￥8.00", "￥64.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_ribbon(aes(x = z, ymin = cost, ymax = p), fill = green, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "利润", x = q/2, y = (p + cost)/2, color = green, family = cnfont, size = 4.5) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("8", "￥96.00", "￥8.00", "￥64.00", "￥32.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_2 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(6)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(7)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("", "\\( \\qquad \\ \\ \\ \\)", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2 <- p_max_2 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("6", "￥42.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("6", "￥42.00", "￥7.00", "￥42.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("6", "￥42.00", "￥7.00", "￥42.00", "￥0.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 13
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_3 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p, cost), labels = c(5, 8)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("", "", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("4", "￥20.00", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = q, xend = q, y = p, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("4", "￥20.00", "￥8.00", "￥32.00", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_ribbon(aes(x = z, ymin = p, ymax = cost), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q/2, y = (p + cost)/2, color = red_pink, family = cnfont, size = 6) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("4", "￥20.00", "￥8.00", "￥32.00", "-$12.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
## 短期决策 .mono[vs.] 长期决策

### 短期

- .green[固定成本]给定 .mono[-->] 但是不影响生产决策

  - 因为无论企业是否开业，都必须支付设备租金

- 可以调整支付.pink[可变成本]

  - 例如为工人安排更短工时、购买更少原材料等
  
- **只要厂商能支付可变成本(球员工资)** .mono[-->] **继续营业**

  - 可以支付.pink[可变成本]时 .mono[-->] 允许亏本经营，延期支付固定成本
  - 无法支付.pink[可变成本]时 .mono[-->] 最好的办法就是停业，以减少损失

---
## 短期决策 .mono[vs.] 长期决策

### 长期

- 所有成本都是可变的

- 因为允许自由进退 .mono[-->] 厂商可以离开这个行业

    - 如通过不续租的方式

- 因为允许自由进退 .mono[-->] 新厂商可以加入这个行业


---
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

sr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停业"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = avc, color = orange, size = 1) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
sr_conditions 
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

]

---
count: false
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

]

---
count: false
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

]

---
count: false
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[ATC] <br> .mono[-->] .pink[存在运营损失]

]

---
count: false
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停业", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[ATC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停业]

]

---
count: false
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停业", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[ATC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停业]

]

---
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停业"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "ATC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = avc, color = orange, size = 1, alpha = 0.5) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "SMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[短期供给曲线]

P .mono[>] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] Y轴

]

---
count: false
## 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停业"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[短期供给曲线]

P .mono[>] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] Y轴

**市场短期供给曲线是多个厂商的短期供给加总，因此市场短期供给曲线也是右上倾斜**

]

---
## 沉没成本 sunk costs

- 定义

> 由于以前的决定而产生的无法收回的成本

- 那些已经投入使用人力、物力、财力和时间，无论是否开业都无法收回

---
## 长期决策

.pink[Q：]长期来看，厂商何时退出还是进入市场？

- 退出市场的好处.mono[=]节约成本.mono[=]TC

- 退出市场的成本.mono[=]收入损失.mono[=]TR
    
.pink[A: ] 如果TC .mono[>] TR就退出，如果TC.mono[<] TR就进入

---
## 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

lr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

]

---
count: false
## 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

]

---
count: false
## 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. P .mono[>] .hi.purple[LATC] <br> .mono[-->] .green[有利润]

]

---
count: false
## 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. P .mono[>] .hi.purple[LATC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LATC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
count: false
## 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. P .mono[>] .hi.purple[LATC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LATC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
## 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "LATC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(atc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LATC]以上的部分


P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]

---
## 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(atc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LATC]以上的部分

P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]
---
## 市场长期供给曲线与行业分类有关

- 厂商进退市场，可能导致要素市场需求侧变化，进而影响要素价格(如工资)。
- 根据要素价格变化，将行业划分为：
- 成本不变行业的市场长期供给曲线是**水平线**，而且是**minLATC时的价格**
>表示以不变的产品市场均衡价格水平提供产量。若产品市场需求侧发生变化，会引起行业长期均衡产量（供给侧）同方向变化。产量变化是由新加入厂商提供的，但长期均衡价格不会变化。

- 成本递增行业的市场长期供给曲线是**右上方倾斜曲线**
>  表示长期产品市场的价格和供给量同方向变动。产品市场需求侧变动不仅引起行业长期均衡价格同方向变动，还同时引起行业长期均衡产量的同方向变动。

- 成本递减行业的市场长期供给曲线？？

---
layout: true
# 完全竞争市场的市场结果
---
class: title-slide-section,inverse, middle
---
layout: false
## 完全竞争市场

.pink[Q: ] 诸多厂商决定对完全竞争产品市场结果的影响是怎样的？

.pink[A: ] 需要构建产品市场供给曲线

- 产品市场供给曲线是所有单厂商供给曲线的加总

- 产品的市场供给曲线和市场需求曲线（向右下倾斜）共同决定了市场均衡时价格和数量

.hi-pink[回忆：]在完全竞争市场条件下

- 单厂商的需求曲线是一条水平线
- 单厂商厂商的长期利润为零（会计利润可能为正）
- 长期，单厂商的水平需求曲线相切于LATC曲线的最低点
- 长期，产品的均衡价格最低，等于最低LATC

---
## 完全竞争市场的短期均衡

**Case 1:** 市场短期价格 .mono[>] 市场长期价格(minLATC)

- 单厂商赚取利润 <br> .mono[-->] 其他企业家看到市场有利可图 <br> .mono[-->] 厂商数量增加 <br> .mono[-->] 市场短期供给曲线右移 <br> .mono[-->] 市场短期价格下降

---
## 完全竞争市场的短期均衡


**Case 2:** 市场短期价格 .mono[<] 市场长期价格(minLATC)

- 单厂商亏损经营（或停业） <br> .mono[-->] 离开市场 <br> .mono[-->] 市场上此类产品供应厂商数量减少 <br> .mono[-->] 市场短期供给曲线左移 <br> .mono[-->] 市场短期价格上升

---
## 完全竞争市场的长期均衡(成本不变行业)

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[厂商]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[市场]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("LATC的最低点"),
  v2 = c("LATC的最低点处的产量"),
  v3 = c("Q.sub[厂商] &times; N.sub[多厂商]"),
  v4 = c("Q.sub[市场] &divide; Q.sub[厂商]")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  align = c("c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
## 完全竞争市场的长期均衡(成本不变行业)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

firm_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(5)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

market_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(5)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("￥5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c("")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
count: false
## 完全竞争市场的长期均衡(成本不变行业)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("￥5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c(750)
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  # scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  # annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # 
  # geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  # annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  # scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = demand_2, color = red_pink, size = 1) +
  # annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  v2 = c("￥5.00", 4, 3000, 750),
  v3 = c("", "", "", ""),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  v2 = c("￥5.00", 4, 3000, 750),
  v3 = c("￥3.00", 3, 2250, 750),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

**A.sub[1]:** .pink[厂商减少原产品生产 .mono[-->] 市场总供给数量下降]

**A.sub[2]:** .pink[短期厂商将会以亏损状态运营]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = supply_2, color = purple, size = 1) +
  # annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  # geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]==MR[3]), x = 6.1, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  v2 = c("￥5.00", 4, 3000, 750),
  v3 = c("￥3.00", 3, 2250, 750),
  v4 = c("￥5.00", 4, 500, 125)
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

.pink[A: ] .pink[厂商不断退出市场，直到经济利润恢复到0 .mono[-->] 市场供应下降]

--

**消费者统治：**指在一个经济社会中消费者在商品生产这一最基本的经济问题上所起的决定性作用。原因在于消费者拥有**货币选票**。厂商为了获得最大利润，只能根据货币选票来安排生产，决定生产什么，生产多少，以及如何生产等问题。它的后果是社会资源得到了合理的利用，从而使全社会的消费者得到最大的满足。

---
exclude: true


```{R, generate pdfs, include = F, eval = F}

pagedown::chrome_print("05_MicroeconBasics2.html", output = "05_MicroeconBasics2.pdf")
```