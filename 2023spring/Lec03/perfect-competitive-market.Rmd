---
title: "体育经济分析: 原理与应用"
subtitle: "单元1补充: 完全竞争市场厂商行为"
author: 
   - 周正卿
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: yes
      countIncrementalSlides: yes
      ratio: '16:10.85'
    seal: true
    lib_dir: libs
  html_document:
    keep_md: yes

knit: pagedown::chrome_print

# beamer模板

# mainfont: Times New Roman
# fontsize: 10pt
# output: 
#   beamer_presentation: 
#     fonttheme: structurebold
#     theme: Madrid
#     colortheme: lily
#     includes:
#         in_header: "../beamer_header.tex"
#     df_print: tibble
#     latex_engine: xelatex

---

```{R, setup, include = F}
# devtools::install_github("dill/emoGG")
library(pacman)
p_load(
  broom, tidyverse,rmarkdown,
  ggplot2, ggthemes, ggforce, ggridges,
  latex2exp, viridis, extrafont, gridExtra,
  kableExtra, snakecase, janitor,
  data.table, dplyr, estimatr,
  lubridate, knitr, parallel,
  lfe,dslabs,
  here, magrittr)

options(htmltools.dir.version = FALSE)

# Notes directory
dir_slides <- "/Users/zhouzhengqing/Desktop/SportsEconAnalysis/2023spring/Lec03"
# Define pink color
red_pink <- "#e64173"
turquoise <- "#20B2AA"
orange <- "#FFA500"
red <- "#fb6107"
blue <- "#3b3b9a"
green <- "#8bb174"
grey_light <- "grey70"
grey_mid <- "grey50"
grey_dark <- "grey20"
purple <- "#6A5ACD"
slate <- "#314f4f"
met_slate <- "#272822" # metropolis font color 

# Dark slate grey: #314f4f

# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  warning = F,
  message = F
)
opts_chunk$set(dev = "svg")
options(device = function(file, width, height) {
  svg(tempfile(), width = width, height = height)
})
options(crayon.enabled = F)
options(knitr.table.format = "html")
# A blank theme for ggplot
theme_empty <- theme_bw() + theme(
  line = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  plot.margin = structure(c(0, 0, -0.5, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_simple <- theme_bw() + theme(
  line = element_blank(),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text.x = element_text(size = 18, family = "STIXGeneral"),
  axis.text.y = element_blank(),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  # plot.margin = structure(c(0, 0, -1, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_math <- theme_void() + theme(
  text = element_text(family = "MathJax_Math"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_serif <- theme_void() + theme(
  text = element_text(family = "MathJax_Main"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes <- theme_void() + theme(
  text = element_text(family = "Fira Sans Book"),
  axis.title = element_text(size = 18),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = grey_light,
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_market <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.title.x = element_text(hjust = 1, size = 17),
  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),
  # axis.text.x = element_text(size = 12),
  # axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_gif <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_goods <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 17, family = cnfont), 
  axis.text.x = element_text(size = 17),
  axis.text.y = element_text(size = 17, angle = 90, hjust = 0.5),
  axis.title.x = element_text(color = purple, size = 19),
  axis.title.y = element_text(color = red_pink, size = 19),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
theme_game <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 20, family = cnfont), 
  axis.text.x = element_text(size = 20, color = met_slate),
  axis.text.y = element_text(size = 20, angle = 90, color = met_slate, hjust = 0.5),
  axis.title.x = element_text(color = met_slate, size = 20),
  axis.title.y = element_text(color = met_slate, size = 20),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
shift_axis <- function(p, y=0){
  g <- ggplotGrob(p)
  dummy <- data.frame(y=y)
  ax <- g[["grobs"]][g$layout$name == "axis-b"][[1]]
  p + annotation_custom(grid::grobTree(ax, vp = grid::viewport(y=1, height=sum(ax$height))), 
                        ymax=y, ymin=y) +
    geom_hline(aes(yintercept=y), data = dummy, size = 0.5, color = met_slate) +
    theme(axis.text.x = element_blank(), 
          axis.ticks.x = element_blank())
}
wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = "\n")
# functions
demand <- function(x) 10 - x
demand_2 <- function(x) 9 - x
demand_3 <- function(x) 8 - x
demand_inc <- function(x) 11 - x
demand_dec <- function(x) 5 - x
supply <- function(x) 1 + (4/5)*x
step_demand <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8), mv = c(8, 7, 6, 5, 4, 3, 2, 1, 0))
step_demand2 <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(10, 10, 9, 9, 8, 8, 7, 7, 6, 6, 5, 4, 4))
step_supply <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 8, 8))
step_supply_tax <- step_supply %>% 
  mutate(mv = mv + 2)

data <- read_csv("/Users/zhouzhengqing/Desktop/SportsEconAnalysis/Activity_Pit_Market/Results.csv") %>% 
  dplyr::filter(!is.na(price))

theme_set(theme_gray(base_size = 20))
# Column names for regression results
reg_columns <- c("Term", "Est.", "S.E.", "t stat.", "p-Value")
# Function for formatting p values
format_pvi <- function(pv) {
  return(ifelse(
    pv < 0.0001,
    "<0.0001",
    round(pv, 4) %>% format(scientific = F)
  ))
}
format_pv <- function(pvs) lapply(X = pvs, FUN = format_pvi) %>% unlist()
# Tidy regression results table
tidy_table <- function(x, terms, highlight_row = 1, highlight_color = "black", highlight_bold = T, digits = c(NA, 3, 3, 2, 5), title = NULL) {
  x %>%
    tidy() %>%
    select(1:5) %>%
    mutate(
      term = terms,
      p.value = p.value %>% format_pv()
    ) %>%
    kable(
      col.names = reg_columns,
      escape = F,
      digits = digits,
      caption = title
    ) %>%
    kable_styling(font_size = 20) %>%
    row_spec(1:nrow(tidy(x)), background = "white") %>%
    row_spec(highlight_row, bold = highlight_bold, color = highlight_color)
}
```
class: center, middle, inverse

# 供给：收入衍生的生产决策

---
layout: false
### 收入线

.less-right[生产者理论主要是指厂商经济行为模型。职业联盟因为是由多个厂商（俱乐部）构成，俱乐部行为决定了联盟结构，因此本讲中会稍作深入讲解。

- 成本线：生产成本、生产技术、厂商决策

- .hi.orange[收入线：市场结构决定了定价能力]

]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="500">

]

---
class: inverse, middle

# 完全竞争性市场的厂商行为

---

#### 条件

1. 买卖方数目: 许多买家和卖家

2. 产品差异度: 相同的、无差异的产品 

3. 行业壁垒性: 自由进入和退出

4. 信息完备的: 消费者和厂商可根据完备信息作出最优决策


#### 结果

**没有市场势力: ** 厂商无法操控价格

- 每家企业都是 **价格接受者**

---
### 完全竞争性市场

**问：**现实中，几乎没有完全竞争性市场，为什么费力地建立一个模型？

**答.sub[1]:** 为建立更现实的情景模型奠定基础

- 简单，但是可以解释更多原因

- 对其他市场结构的启示

**答.sub[2]：** 建立一个基准，与 "现实世界 "进行比较

- 通过比较现实世界的市场条件和完全竞争市场的基准条件，可以回答"我们怎样做得更好？"的问题


---
### 总收入、平均收入和边际收入

.center[
#### 总收入.mono[=] 销售数量 .mono[*] .pink[销售价格]
]

完全竞争厂商的销售数量等于它所面临的需求量，销售价格就是产品的市场价格。
- **总收入** 是厂商按一定价格出售一定量产品时所获得的全部收入<br> $T R(TP)=P \cdot TP=\bar{P} \cdot TP$

- **平均收入** 是厂商在平均每单位产品销售上所获得的收入<br> $AR(TP)=\frac{T R(TP)}{TP}=\frac{\bar{P} \cdot TP}{TP}=\bar{P}$ 

- **边际收入** 是厂商增加一单位产品销售所获得的总收入的增量 $M R(TP)=\frac{\Delta T R(TP)}{\Delta TP}=\frac{d T R(TP)}{d TP}=\frac{d(\bar{P} \cdot TP)}{d TP}=\bar{P}$

- 完全竞争厂商的平均收入 $AR$ ，边际收入 $MR$ 和需求曲线 $D$ **三者重叠**的

- 总收入曲线是从原点出发斜率为 $\bar{P}$ 的射线

---
### 实现利润最大化的条件


边际收入 $M R$ 等于边际成本 $M C$ 是厂商实现利润最大化的均衡条件。
<br></br>
厂商利润为 $\pi(TP)=T R(TP)-T C(TP)$

利润最大化要满足一阶导数为零

$\frac{d \pi(TP)}{d(TP)}=\frac{d T R(TP)}{d TP}-\frac{d T C(TP)}{d TP}=0$

由此得出 $M R(TP)-M C(TP)=0$, 即 $M R(TP)=M C(TP)$
<br></br>
以上条件是必要条件，并非充分条件。即要实现利润最大化，必须有 $M R(TP)=M C(TP)$ 。但反过来，如果 $M R(TP)=M C(TP)$ 则不一 定实现利润最大化，因为还可能是利润最小化的点。这时需要结合利润函数的二阶导数 $\frac{d^{2} \pi(TP)}{d TP^{2}}=M R^{\prime}(TP)-M C^{\prime}(TP)<0$ 来判断。
---
### 边际收入

.less-right[
- 定义

> 产出增加一个单位所产生的总收入的变化

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 10, y = 7.6, color = red_pink, family = cnfont, size = 9) +
  annotate("text", label = expression(Delta*"TR"=="MR"), x = 4, y = 4, color = green, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"TP"==1), x = 4, y = 1.5, color = met_slate, family = cnfont, size = 4) +
  geom_point(aes(x = 3, y = 7), color = met_slate, size = 2) +
  geom_point(aes(x = 5, y = 7), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 5, y = 0, xend = 5, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 1, xend = 5 - 0.1, yend = 1), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = 0, ymax = 7), alpha = 0.2, fill = green)
```
]

---
### 边际收入

.less-right[
企业在完全竞争市场中

- MR .mono[<=>] D需求

- MR .mono[=] P

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = green, size = 1) +
  annotate("text", label = expression(MR==P), x = 8, y = 7.6, color = green, family = cnfont, size = 9)
```
]

---
### 完全竞争市场厂商的利润最大化(短期)

- 厂商面对的价格是给定的

- 短期内厂商无法调整生产规模(固定成本给定、其他要素投入给定，如资本)

- 给定的生产规模下，厂商通过调整产量来实现 MR = MC 以满足利润最大化的均衡条件。
---
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(8)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost, p), labels = c(8, 12)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1)+
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
    annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("8", "￥96.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("8", "￥96.00", "￥8.00", "￥64.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_ribbon(aes(x = z, ymin = cost, ymax = p), fill = green, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "利润", x = q/2, y = (p + cost)/2, color = green, family = cnfont, size = 4.5) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("8", "￥96.00", "￥8.00", "￥64.00", "￥32.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_2 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(6)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(7)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("", "\\( \\qquad \\ \\ \\ \\)", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2 <- p_max_2 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("6", "￥42.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("6", "￥42.00", "￥7.00", "￥42.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
## 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("6", "￥42.00", "￥7.00", "￥42.00", "￥0.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 13
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_3 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p, cost), labels = c(5, 8)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("", "", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("4", "￥20.00", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = q, xend = q, y = p, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("4", "￥20.00", "￥8.00", "￥32.00", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场厂商的利润最大化(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_ribbon(aes(x = z, ymin = p, ymax = cost), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q/2, y = (p + cost)/2, color = red_pink, family = cnfont, size = 6) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "ATC", "TC = ATC &times; TP", "利润"),
  v2 = c("4", "￥20.00", "￥8.00", "￥32.00", "-$12.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "￥5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 短期决策 .mono[vs.] 长期决策

#### 短期

- .green[固定成本]给定 .mono[-->] 但是不影响生产决策

  - 因为无论企业是否开业，都必须支付设备租金

- 可以调整支付.pink[可变成本]

  - 例如为工人安排更短工时、购买更少原材料等
  
- **只要厂商能支付可变成本(球员工资)** .mono[-->] **继续营业**

  - 可以支付.pink[可变成本]时 .mono[-->] 允许亏本经营，延期支付固定成本
  - 无法支付.pink[可变成本]时 .mono[-->] 最好的办法就是停业，以减少损失

---
### 短期决策 .mono[vs.] 长期决策

#### 长期

- 所有成本都是可变的

- 因为允许自由进退 .mono[-->] 厂商可以离开这个行业

    - 如通过不续租的方式

- 因为允许自由进退 .mono[-->] 新厂商可以加入这个行业


---
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

sr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停业"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = avc, color = orange, size = 1) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
sr_conditions 
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

]

---
count: false
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

]

---
count: false
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

]

---
count: false
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[ATC] <br> .mono[-->] .pink[存在运营损失]

]

---
count: false
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停业", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[ATC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停业]

]

---
count: false
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停业", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. .hi.purple[ATC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[ATC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停业]

]

---
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停业"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "ATC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = avc, color = orange, size = 1, alpha = 0.5) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "SMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[短期供给曲线]

P .mono[>] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] Y轴

]

---
count: false
### 短期决策

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停业"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[短期供给曲线]

P .mono[>] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停业] .mono[-->] 短期供给曲线 .mono[=] Y轴

**市场短期供给曲线是多个厂商的短期供给加总，因此市场短期供给曲线也是右上倾斜**

]

---
### 沉没成本 sunk costs

- 定义

> 由于以前的决定而产生的无法收回的成本

- 那些已经投入使用人力、物力、财力和时间，无论是否开业都无法收回

---
### 长期决策

.pink[Q：]长期来看，厂商何时退出还是进入市场？

- 退出市场的好处.mono[=]节约成本.mono[=]TC

- 退出市场的成本.mono[=]收入损失.mono[=]TR
    
.pink[A: ] 如果TC .mono[>] TR就退出，如果TC.mono[<] TR就进入

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

lr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. P .mono[>] .hi.purple[LATC] <br> .mono[-->] .green[有利润]

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. P .mono[>] .hi.purple[LATC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LATC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停业？

.pink[A: ] 完全竞争市场，是否停业完全依赖市场价格

1. P .mono[>] .hi.purple[LATC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LATC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = atc, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "LATC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(atc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LATC]以上的部分


P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(atc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LATC]以上的部分

P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]
---
### 市场长期供给曲线与行业分类有关

- 厂商进退市场，可能导致要素市场需求侧变化，进而影响要素价格(如工资)。
- 根据要素价格变化，将行业划分为：
- 成本不变行业的市场长期供给曲线是**水平线**，而且是**minLATC时的价格**

- 成本递增行业的市场长期供给曲线是**右上方倾斜曲线**


- 成本递减行业的市场长期供给曲线？？

???

.tiny[
表示以不变的产品市场均衡价格水平提供产量。若产品市场需求侧发生变化，会引起行业长期均衡产量同方向变化。
产品高需求，用工高需求，但产量增加是由新加入厂商提供的。产品的长期均衡价格不会变化。


大多数行业（高技术行业）的产品价格增加，会引发用工慌。

产品市场需求侧增加引起行业长期均衡价格上涨，企业扩张，规模扩张，最终行业的长期均衡产量的同方向变动。

]

---
layout: true
# 完全竞争市场的市场结果(自学)
---
class: title-slide-section,inverse, middle
---
layout: false
### 完全竞争市场

.pink[Q: ] 诸多厂商决定对完全竞争产品市场结果的影响是怎样的？

.pink[A: ] 需要构建产品市场供给曲线

- 产品市场供给曲线是所有单厂商供给曲线的加总

- 产品的市场供给曲线和市场需求曲线（向右下倾斜）共同决定了市场均衡时价格和数量

.hi-pink[回忆：]在完全竞争市场条件下

- 单厂商的需求曲线是一条水平线
- 单厂商厂商的长期利润为零（会计利润可能为正）
- 长期，单厂商的水平需求曲线相切于LATC曲线的最低点
- 长期，产品的均衡价格最低，等于最低LATC

---
### 完全竞争市场的短期均衡

**Case 1:** 市场短期价格 .mono[>] 市场长期价格(minLATC)

- 单厂商赚取利润 <br> .mono[-->] 其他企业家看到市场有利可图 <br> .mono[-->] 厂商数量增加 <br> .mono[-->] 市场短期供给曲线右移 <br> .mono[-->] 市场短期价格下降

---
### 完全竞争市场的短期均衡


**Case 2:** 市场短期价格 .mono[<] 市场长期价格(minLATC)

- 单厂商亏损经营（或停业） <br> .mono[-->] 离开市场 <br> .mono[-->] 市场上此类产品供应厂商数量减少 <br> .mono[-->] 市场短期供给曲线左移 <br> .mono[-->] 市场短期价格上升

---
### 完全竞争市场的长期均衡(成本不变行业)

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[厂商]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[市场]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("LATC的最低点"),
  v2 = c("LATC的最低点处的产量"),
  v3 = c("Q.sub[厂商] &times; N.sub[多厂商]"),
  v4 = c("Q.sub[市场] &divide; Q.sub[厂商]")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  align = c("c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
### 完全竞争市场的长期均衡(成本不变行业)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

firm_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(5)) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

market_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(5)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("￥5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c("")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
count: false
### 完全竞争市场的长期均衡(成本不变行业)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("￥5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c(750)
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  # scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  # annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # 
  # geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  # annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  # scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = demand_2, color = red_pink, size = 1) +
  # annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  v2 = c("￥5.00", 4, 3000, 750),
  v3 = c("", "", "", ""),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么短期原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  v2 = c("￥5.00", 4, 3000, 750),
  v3 = c("￥3.00", 3, 2250, 750),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

**A.sub[1]:** .pink[厂商减少原产品生产 .mono[-->] 市场总供给数量下降]

**A.sub[2]:** .pink[短期厂商将会以亏损状态运营]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = supply_2, color = purple, size = 1) +
  # annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  # geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function( fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]==MR[3]), x = 6.1, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么长期原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[多厂商]"),
  v2 = c("￥5.00", 4, 3000, 750),
  v3 = c("￥3.00", 3, 2250, 750),
  v4 = c("￥5.00", 4, 500, 125)
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

.pink[A: ] .pink[厂商不断退出市场，直到经济利润恢复到0 .mono[-->] 市场供应下降]

--

**消费者统治：**指在一个经济社会中消费者在商品生产这一最基本的经济问题上所起的决定性作用。原因在于消费者拥有**货币选票**。厂商为了获得最大利润，只能根据货币选票来安排生产，决定生产什么，生产多少，以及如何生产等问题。它的后果是社会资源得到了合理的利用，从而使全社会的消费者得到最大的满足。

---

exclude: true

```{R, generate pdfs, include = F, eval = F}

pagedown::chrome_print("perfect-competitive-market.html", output = "perfect-competitive-market.pdf")

```


