---
title: "体育经济分析: 原理与应用"
subtitle: "单元1: 概要与预备知识"
author: 
   - 周正卿
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: yes
      countIncrementalSlides: yes
      ratio: '16:10.85'
    seal: true
    lib_dir: libs
  html_document:
    keep_md: yes

knit: pagedown::chrome_print

# beamer模板

# mainfont: Times New Roman
# fontsize: 10pt
# output: 
#   beamer_presentation: 
#     fonttheme: structurebold
#     theme: Madrid
#     colortheme: lily
#     includes:
#         in_header: "../beamer_header.tex"
#     df_print: tibble
#     latex_engine: xelatex

---

```{R, setup, include = F}
# devtools::install_github("dill/emoGG")
library(pacman)
p_load(
  broom, tidyverse,rmarkdown,
  ggplot2, ggthemes, ggforce, ggridges,
  latex2exp, viridis, extrafont, gridExtra,
  kableExtra, snakecase, janitor,
  data.table, dplyr, estimatr,
  lubridate, knitr, parallel,
  lfe,dslabs,
  here, magrittr)

options(htmltools.dir.version = FALSE)

# Notes directory
dir_slides <- "/Users/zhouzhengqing/Desktop/SportsEconAnalysis/2024spring/Lec03/"
# Define pink color
red_pink <- "#e64173"
turquoise <- "#20B2AA"
orange <- "#FFA500"
red <- "#fb6107"
blue <- "#3b3b9a"
green <- "#8bb174"
grey_light <- "grey70"
grey_mid <- "grey50"
grey_dark <- "grey20"
purple <- "#6A5ACD"
slate <- "#314f4f"
met_slate <- "#272822" # metropolis font color 

# Dark slate grey: #314f4f

# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  warning = F,
  message = F
)
opts_chunk$set(dev = "svg")
options(device = function(file, width, height) {
  svg(tempfile(), width = width, height = height)
})
options(crayon.enabled = F)
options(knitr.table.format = "html")
# A blank theme for ggplot
theme_empty <- theme_bw() + theme(
  line = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  plot.margin = structure(c(0, 0, -0.5, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_simple <- theme_bw() + theme(
  line = element_blank(),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text.x = element_text(size = 18, family = "STIXGeneral"),
  axis.text.y = element_blank(),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  # plot.margin = structure(c(0, 0, -1, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_math <- theme_void() + theme(
  text = element_text(family = "MathJax_Math"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_serif <- theme_void() + theme(
  text = element_text(family = "MathJax_Main"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes <- theme_void() + theme(
  text = element_text(family = "Fira Sans Book"),
  axis.title = element_text(size = 18),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = grey_light,
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_market <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.title.x = element_text(hjust = 1, size = 17),
  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),
  # axis.text.x = element_text(size = 12),
  # axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_gif <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_goods <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 17, family = cnfont), 
  axis.text.x = element_text(size = 17),
  axis.text.y = element_text(size = 17, angle = 90, hjust = 0.5),
  axis.title.x = element_text(color = purple, size = 19),
  axis.title.y = element_text(color = red_pink, size = 19),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
theme_game <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 20, family = cnfont), 
  axis.text.x = element_text(size = 20, color = met_slate),
  axis.text.y = element_text(size = 20, angle = 90, color = met_slate, hjust = 0.5),
  axis.title.x = element_text(color = met_slate, size = 20),
  axis.title.y = element_text(color = met_slate, size = 20),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
shift_axis <- function(p, y=0){
  g <- ggplotGrob(p)
  dummy <- data.frame(y=y)
  ax <- g[["grobs"]][g$layout$name == "axis-b"][[1]]
  p + annotation_custom(grid::grobTree(ax, vp = grid::viewport(y=1, height=sum(ax$height))), 
                        ymax=y, ymin=y) +
    geom_hline(aes(yintercept=y), data = dummy, size = 0.5, color = met_slate) +
    theme(axis.text.x = element_blank(), 
          axis.ticks.x = element_blank())
}
wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = "\n")
# functions
demand <- function(x) 10 - x
demand_2 <- function(x) 9 - x
demand_3 <- function(x) 8 - x
demand_inc <- function(x) 11 - x
demand_dec <- function(x) 5 - x
supply <- function(x) 1 + (4/5)*x
step_demand <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8), mv = c(8, 7, 6, 5, 4, 3, 2, 1, 0))
step_demand2 <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(10, 10, 9, 9, 8, 8, 7, 7, 6, 6, 5, 4, 4))
step_supply <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 8, 8))
step_supply_tax <- step_supply %>% 
  mutate(mv = mv + 2)

data <- read_csv("/Users/zhouzhengqing/Desktop/SportsEconAnalysis/Activity_Pit_Market/Results.csv") %>% 
  dplyr::filter(!is.na(price))

theme_set(theme_gray(base_size = 20))
# Column names for regression results
reg_columns <- c("Term", "Est.", "S.E.", "t stat.", "p-Value")
# Function for formatting p values
format_pvi <- function(pv) {
  return(ifelse(
    pv < 0.0001,
    "<0.0001",
    round(pv, 4) %>% format(scientific = F)
  ))
}
format_pv <- function(pvs) lapply(X = pvs, FUN = format_pvi) %>% unlist()
# Tidy regression results table
tidy_table <- function(x, terms, highlight_row = 1, highlight_color = "black", highlight_bold = T, digits = c(NA, 3, 3, 2, 5), title = NULL) {
  x %>%
    tidy() %>%
    select(1:5) %>%
    mutate(
      term = terms,
      p.value = p.value %>% format_pv()
    ) %>%
    kable(
      col.names = reg_columns,
      escape = F,
      digits = digits,
      caption = title
    ) %>%
    kable_styling(font_size = 20) %>%
    kableExtra::row_spec(1:nrow(tidy(x)), background = "white") %>%
    kableExtra::row_spec(highlight_row, bold = highlight_bold, color = highlight_color)
}
```

### 体育产品的形态（供讨论）
- 一部分是单一形态
- 传统能以三次产业划分
- 专业器材、场地设施、运动用品等
- 赛事服务、职业俱乐部、运动训练公共服务部门
- 媒体先关
- 一部分是复合形态
- 通过参与各类可供观赏的运动组合获得体验感，满足人的欲望、提高福祉水平，→ 竞技运动服务业
- 通过增加个体身体运动能力、改善身体和心理健康水平，扩大社交网络，间接实现“再生产”能力提升的服务类产品 → 健身休闲娱乐服务业

---
### 体育企业

- 健身休闲和竞赛表演（职业俱乐部）
  - 1750 年，英国，纽马克特赛马俱乐部（the Jockey club）是世界上第一个按照所有权和经营权分离原则，按独立法人模式商业运营的俱乐部
  - 1888，英格兰足球联赛，欧洲职业俱乐部联盟的起源
  - 1876，MLB是北美职业联盟的起源
- 资本所有权和生产经营权分离，促成了更多资源、人才、知识进入体育行业
  - 生产方式的规律
  - 决策的基本逻辑 → 不同目标的行为差异
  - 联盟的组织形态
      - 收益方式：连锁经营、特许经营等模式
      - 联盟治理：维持竞争均衡（收入分享、工资帽、奢侈税、选秀）；门票定价策略；选址与扩张
      - 治理联盟：反垄断


---
### Jockey Club

.center[
```{R echo=FALSE}
library(htmltools)
library(shiny)

tags$video(
  tags$source(src ="./video/jockclub.mp4", type = "video/mp4"),
  type = "video/mp4",
  width = "840",
  height = "460",
  controls = TRUE,
  tags$track(src = "./video/AN-NFL.vtt", kind = "subtitles", srclang = "cn", label = "Chinese")
)
```
]


---
### 现代企业的起源（从生产体到厂商）

- “协力组合说”（Jacob Viner,1892-1970）：规模经济（Economies of Scale）+ 范畴经济（Economies of Scope）

.center[<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/viner.jpg height=280>]

- 规模经济指，当生产规模增加时平均成本会下降（后续会讲）→ 在规模经济的作用下，小规模的生产体有就动机去扩张规模，追求规模经济
- 范畴经济是厂商在**生产多种产品**比**生产单一产品**的成本要低（资源共享和技术关联） → 小生产体有动机联合更多不同类产品的生产体，从而建立大规模的厂商


???

- 企业部门分为生产部门和非生产部门。像是销售、会计、财务、市场等部门，虽然不直接生产产品，但它们控制成本、提高效率方面发挥着重要作用。有效的内部管理可以进一步降低企业的运营成本，增强其市场竞争力。

- 大型企业通过规模经济实现成本效率，通过范畴经济实现市场风险的分散和管理效率的提高。此外，大型企业在面对市场波动时，由于其产品和服务的多样性，能够更好地吸收市场的冲击，从而实现更稳定的收入。

- 合并与市场波动：当不同的厂商生产技术相互关联，或者处于同一供应链的不同环节时，通过合并可以降低市场波动带来的风险。合并后的大型企业能够更好地控制供应链，减少对外部市场变化的依赖，从而实现更稳定的收入和利润。
---
### 现代企业的起源（从生产体到厂商）

- “长期关系说”（Oliver Williamson,1932-2020） 发展了交易成本理论。企业交易时会面临着高转换成本（switching cost）和特定投资（specific investment）

.center[<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/256px-Nobel_Prize_2009-Press_Conference_KVA-35-3-193x300.jpg>]

- **案例**：在20世纪80年代，Nike与Jordan签订长期合约，推出了“Air Jordan”鞋
  - 专门投入巨大资源进行产品设计、市场营销和广告宣传。这些投资是高度专用的
  - 转换成本： 更换代言人会带来巨大成本。增加了Jordan对Nike依赖程度

???
- 特定投资是在其他用途上的价值较低，反而增加了交易双方在未来持续合作的激励（互惠）。一旦更换新交易对象，就面临着高转换成本（重新谈判、重新投资等），所以实际形成了一种双边独占的情况，为了减少不确定性和潜在的敲诈风险，双方可能会选择签订**长期合约**，作为价格、供应量、质量标准的制度保障 → → 解释了在不确定性和复杂性的市场环境中，企业为何选择特定的治理结构，比如长期合约、垂直整合或合并（从小变大），以管理交易成本并保护对特定交易的投资

---
### 现代企业的起源（从生产体到厂商）

- “不完全契约说”（Ronald Coase,1932-2020） 帮助解释为什么厂商能解决不完全契约问题

.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/220px-Coase_profile_2003.jpg height=270 width=200>
]

- 由于契约中不能穷尽所有情况，特别是**不确定因素和契约遗漏项**、**结果多样性**、**是否履约监督成本**以及高昂的**违约诉讼费** 厂商可以理解为对不完全契约问题的一种回应
- 厂商通过内部化（即在厂商内部进行交易而不通过市场）来减少交易成本，尤其是在监督、协商和执行契约方面的成本

---
class: title-slide-section, middle, inverse
# 供给曲线从何而来?

---
### 为什么

.hi[目标] 生产者理论的分析路线（高级）

- WTP → MV → 需求曲线（P-Q关系）

- 供给曲线从何而来?（P-Q关系）

---

### 讲授路径

.less-right[

- .hi.orange[Cost成本线：生产成本、生产技术、厂商决策]

- Revenue收入线：定价能力、市场结构

- MR=MC
]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="530">

]


---
### 讲授路径（非常重要）

- 从成本线看供给生产函数。当经济学打开厂商生产的黑箱时，首先看到的是要素的投入，包括要素价格、要素数量以及要素组合的方式。我们将会定义出生产函数、生产技术以及生产阶段。在图形上，我们看到是L-Q平面，反映的“要素-产量”关系
- 生产函数不同意味着成本函数差异，而成本函数刻画的是Q-$平面，与需求曲线（回忆：本质是刻画消费者偏好）在同一个维度。成本函数反映的是“产量-成本消耗”关系
- 两条路径是理解单个厂商的供给行为的关键
  - MC 路径：生产技术出发 → 生产函数 → 成本函数 → MC 曲线
  - MR 路径：若限定厂商为价格接受者，就可以获得 MR 曲线 
- 进一步，考虑厂商的相似性 → 理解完全竞争市场下供需均衡分析与福利结果
- 但现实往往不是完全竞争环境
  - 独占市场结构下的厂商决策 → 拥有定价能力，就没有供给曲线（统计学意义的产量产值关系） → 对超额利润的治理 .mono[+] 定价策略
  - 寡头市场、独占性竞争的市场结构 → 经济主体间博弈

---
### MR 和 MC v.s. 内部决策与外部约束

- 两者都是内部决策 → 回忆：受制于外部约束

- 对于拥有定价权的企业来说，MC 相对 MR 更为外部约束一些


---
### 生产技术

经济中的生产技术，是指的投入要素的组合方式。一般要素：土地、劳动力、资本、技术（有时候以人力资本的形式表达）、数据。

数学上，用.hi.pink[生产函数]来反映：对企业生产过程中投入和产出之间关系的数学描述。

.center[
.hi.pink[要素投入 .mono[-->]  生产技术 .mono[-->] 产出方式]
] 

---
### 生产函数TPF

.pull-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "Q") +
  stat_function(fun = total_product, color = purple, size = 1)
```
]

.pull-right[
#### 定义:**一段时间内**生产要素投入量与.pink[产品最大产出量]之间的关系
- $Q=f(L, K)$ 。为了方便，暂且分析短期(只有一种可变要素)。
- 有时以产量(Q,output)代替产品最大产出量(TP)
- 生产行为都是在**一个时间段内**进行的 → TP 是**流量**概念
<br>→像土地而言，是一种**存量**概念
<br>→资本有时是固定的，有时是变动的。不会因生产而马上消失，属于**耐久财**。**当前的资本量是过去新增资本的累积减去耗损与折旧，因此通常也视为存量**
- 劳动?
]


---
count: false
### 最大总产出的三个阶段


```{r, echo = FALSE, fig.height = 7, fig.width = 12, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "Q") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速度递增", 15), x = 2.67/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速度递增", 15), x = (2.67 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 15), x = (7.5 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  geom_ribbon(aes(x = z, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank") + # PS
  geom_ribbon(aes(x = u, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank")
```


---
### 边际产量 MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 
q_1 <- total_product(3)
q_2 <- total_product(4)

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) +
  theme_market +
  labs(x = "L", y = "Q") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_point(aes(x = 3, y = q_1), color = met_slate, size = 2) +
  geom_point(aes(x = 4, y = q_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 4, y = 0, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_1, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_2, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 10, xend = 4 - 0.1, yend = 10), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_segment(aes(x = 0.5, y = q_1 + 0.75, xend = 0.5, yend = q_2 - 0.75), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  annotate("text", label = expression(Delta*"Q"=="边际产量"), x = 2, y = (q_1 + q_2)/2, color = met_slate, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"L"==1), x = 3.5, y = 7.5, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
#### 定义:增加一单位.pink[可变要素]劳动投入量所增加的产量

- 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
count: false
### 边际产量 MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) 

shift_axis(mp1)
```
]

.less-right[
#### 定义:增加一单位.pink[可变要素]劳动投入量所增加的产量

- 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]



---
count: false
### 边际产量 MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速递增", 22), x = 2.67/2 - 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速递增", 22), x = (2.67 + 5.68)/2 + 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 22), x = (7.5 + 5.68)/2, y = 14.75, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.less-right[
#### 定义:增加一单位.pink[可变要素]劳动投入量所增加的产量

- 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
### 最大总产量、平均产量和边际产量的关系

.pull-left[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/yUWHvE.png height=260>
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/43wNVt.png height=260>
]
]

.pull-right[
Stage I，**边际产量始终大于平均产量**：
- MP上升，达到最大值后并开始下降
- 这一阶段总产量始终加速增加的
- .bb[**固定要素（比如土地）**相对过剩，而**可变要素（比如劳动）投入量**持续投入会有利可图 → Q 加速上升、L 持续增加(未来会影响成本函数)]
]

---
count: false

### 总产量、平均产量和边际产量的关系

.pull-left[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/yUWHvE.png height=260>
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/43wNVt.png height=260>
]
]

.pull-right[
Stage II，截止到**边际产量等于零**：
- **平均产量曲线和边际产量曲线相交**，即AP达到最高点。
]
---
count: false

### 总产量、平均产量和边际产量的关系

.pull-left[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/yUWHvE.png height=260>
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/43wNVt.png height=260>
]
]

.pull-right[
Stage III，**总产量也呈现下降**：
- AP下降，MP为负
- 这一阶段减少**可变要素**投入是有利的
]

---
count: false

### 生产阶段的决策


- 理性的生产者既不会将生产停留在Stage I，也不会将生产扩张到Stage III

- 因此Stage II是生产者进行短期生产的决策区间

- **至于在StageII的哪一点才能达到利润最大化，需要结合成本、收入和利润进行深入分析**

- .b[所以**实际中MP**是**向下倾斜的**]

---
### 经验法则:单一要素边际报酬最终会递减

.pull-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("边际报酬递增", 18), x = 2.67/2 - 0.0, y = 14.85, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("边际报酬递减", 18), x = (2.67 + 7.5)/2 + 0.0, y = 14.85, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.pull-right[
#### 解释

持续增加一种要素投入.purple[边际生产效率最终为负] → 边际报酬递减（diminishing marginal returns） <br>←  the law of diminishing marginal returns]


---
### 应用：经营体育场馆

- 假设你是一家体育场馆的经理，场馆有5个篮球场。为了提高场馆的使用率和收入，你决定招聘更多的教练来提供篮球培训课程
    1. 当你招聘了1个教练时，每天可以为20个学员提供培训
    2. 当你招聘第2个教练时，每天又增加了20个学员，总共40个学员
    3. 当你招聘第3个教练时，由于篮球场数量的限制，每天只增加了15个学员，总共55个学员
    4. 当你招聘第4个教练时，每天只增加了10个学员，总共65个学员
- 随着教练数量的增加，每增加一个教练所带来的额外学员数量在逐渐减少。这就是边际报酬递减法则的体现
- 在一定程度上，增加更多的输入（如教练）将不再能够有效地提高产出（如培训学员数量），甚至可能会导致产出的减少


---
### 为什么要区分生产阶段

- 建立**边际决策分析的外部约束机制** → 来自于经验观察的证据

- MP和AP，MP代表边际生产效率，AP代表平均生产率 Q/L

- 平均生产率通常能刻画行业的属性



---
### 数学推导：MP 对 AP 影响的数学表达

设 $T P=Q=f(L) ; A P_{L}=T P / L$，
$L$ 的平均产量对 $L$ 投入的变化率 :


$\frac{d A P_{L}}{d L}=\frac{d(T P / L)}{d L}=\frac{d(Q / L)}{d L}=\frac{\frac{d Q}{d L} L-\frac{d L}{d L} Q}{L^{2}}$


$=\frac{\frac{d Q}{d L} L-Q}{L^{2}}=\frac{1}{L}(\underbrace{\frac{d Q}{d L}}_{M P_{L}}-\underbrace{\frac{Q}{L}}_{A P_{L}})$


- 当 $M P_{L}>A P_{L}, A P_{L}$ 处于递增阶段
- 当 $M P_{L}<A P_{L}, A P_{L}$ 处于递减阶段
- 当 $M P_{L}=A P_{L}, A P_{L}$ 达到最大值


---

class: title-slide-section, middle, inverse
# 成本

---
### 成本要考虑是否影响决策以及时间


- 要素分为**可变要素**和**固定要素**，对于成本来看，是否影响边际生产决策就分为**可变成本**和**固定成本**

- 生产要素分是可变还是固定，还须视时间长短
  
  - 若是生产决策时间非常短，那么所有要素都可能是固定的 → **极短期**
  
  - 随着时间拉长，有些固定要素就会转变为可变要素 → **长期**
  
  - 只要还存在固定要素的生产决策 → **短期**

---
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本，已知总产量函数

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("", "", "", "", "", ""),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")

```

---
count: false
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("$1000", "$1000", "$1000", "$1000", "$1000", "$1000"),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("$1000", "$1000", "$1000", "$1000", "$1000", "$1000"),
  v4 = c("$0", "$2000", "$4000", "$6000", "$8000", "$10000"),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("$1000", "$1000", "$1000", "$1000", "$1000", "$1000"),
  v4 = c("$0", "$2000", "$4000", "$6000", "$8000", "$10000"),
  v5 = c("$1000", "$3000", "$5000", "$7000", "$9000", "$11000")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```
---
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

.center[.purple[**SRTC曲线**]]

.pull-left[
```{R, echo = F, escape = F}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c("$1000", "$3000", "$5000", "$7000", "$9000", "$11000")
) 
cost_data %>% 
  kable(
  escape = F,
  col.names = c("西瓜 (Q)", "总成本"),
  align = c("c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```
]

.pull-right[
```{r, echo = FALSE, fig.height = 3.25, fig.width = 4.25, dev = "svg"}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c(1000, 3000, 5000, 7000, 9000, 11000)
) 
cost_data %>% 
  ggplot(aes(x = q, y = tc)) +
  scale_x_continuous(limits = c(0, 3500)) +
  scale_y_continuous(limits = c(0, 12000), expand=c(0, 0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  geom_point(size = 2, color = purple) +
  geom_line(size = 1, color = purple)
```
]


---
### 生产决策时考虑的成本是.bb[机会成本]

- 稀缺性  .mono[->] 机会成本

- 依据是否能使用会计账目划分：  总成本.mono[=] .purple[显成本] .mono[+] .pink[隐成本]

#### .purple[显成本]

- 一般是工资、租金、原材料、维修费、缴纳税款等。

#### .pink[隐成本]

- 丧失的**次优投资品的价值**。例等额的投资要是放在股票市场的回报。

---

### 例子：给你100万去投资，该如何选？

项目的启动资金是100万，利息是5%。

.pink[方案1：]借100万

- 显成本 .mono[=] 5万

.pink[方案2：]动用40万的储蓄，借60万

- 显成本 .mono[=] 3万 .mono[<--] 偿还5%的贷款利息

- 隐成本 .mono[=] 2万 .mono[<--] 从储蓄中拿出40万RMB，放弃5%的利息

.pink[任一方案的总成本 .mono[=] 5万]

---
###  会计利润  v.s.  经济利润 

#### 会计利润 <br> $\quad$ .mono[=] 总收益 .mono[-] .pink[显成本]

#### 经济利润 <br> $\quad$ .mono[=] 总收益 .mono[-] (.pink[显成本] .mono[+] .purple[隐成本])  <br> $\quad$ .mono[=] 会计利润 .mono[-] .purple[隐成本]

**重要** 

.center[
## 会计利润 .mono[>] 经济利润
]

>所以一家赚钱的公司，并不总是意味着一家公司做得很好


---
### 短期总成本曲线SRC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = total_cost, color = purple, size = 1) 
```
]

.less-right[
#### .purple.hi[**SRTC曲线**]:产出与.pink[最低投入成本]的关系

- Q-$平面

- 短期的前面SR

.hi[思考]为什么总成本曲线是S型？
]

???

.purple.hi[边际产量先增后减。既然边际产量一段时间会增加，意味着该时期内的边际成本很可能是降低的。] 

---
### 总成本的构成

#### 总成本 .mono[=] .green[固定成本] .mono[+] .pink[可变成本]
- SRTC(x)=TFC + TVC(x)
#### .green[固定成本]
> .green[成本不随产出数量的变化而变化]
- 如租金、设备成本、贷款支付等；对短期边际成本SRMC没有影响

#### .pink[可变成本]
> .pink[成本随产出数量变化而变化]
- 如工资, 原材料成本等；对短期边际成本SRMC有影响

---
### 总成本的构成

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
vc <- function(x) 10*x - 4*x^2 + x^3
fc <- function(x) 10

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function(fun = fc, color = green, size = 1) +
  stat_function(fun = total_cost, color = purple, size = 1) +
  stat_function(fun = vc, color = red_pink, size = 1) +
  annotate("text", label = "SRTC", x = 3.6, y = 50, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = "TVC", x = 4.75, y = 50, color = red_pink, family = cnfont, size = 7.7) +
  annotate("text", label = "TFC", x = 4.75, y = 13, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
#### .green[总固定成本(TFC)]

#### .pink[总可变成本 (TVC)]

]

---
### 理解成本函数的关键是理解可变成本

.pull-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/SgaiiJ.png height=444>
]

.pull-right[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/9ZlkV8.png height=420 >
]

---
### 平均固定成本AFC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
afc <- function(x) 10/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function(fun = afc, color = green, size = 1) +
  annotate("text", label = "AFC", x = 4.75, y = 5.5, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
#### 定义

> AFC .mono[=] TFC &divide; 总产量

随着产量上升而减少 <br> .mono[-->] 更多产出分摊TFC

]

---
### 平均可变成本AVC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function(fun = avc, color = red_pink, size = 1) +
  annotate("text", label = "AVC", x = 4.75, y = 18, color = red_pink, family = cnfont, size = 7.7)

```
]

.less-right[
#### 定义

> AVC .mono[=] TVC &divide; 总产量

]

---
### 短期平均成本 SRAC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
SRAC <- function(x) (10 + 10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function(fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "SRAC", x = 1.3, y = 50, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[
#### 定义

> SRAC .mono[=] SRTC &divide; 总产量 <br> .mono[=] AFC .mono[+] AVC

]

---
### 短期边际成本SRMC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
marginal_cost <- function(x) 10 - 8*x + 3*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = marginal_cost, color = purple, size = 1) 
```
]


#### 定义

> 产量增加一个单位所产生的总成本的变化。 

---
### 图形展示：MC与 MP、AVC 与 AP 的关系
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/G7kTx3.png height="570" width="480">
]

---
### 数学推导：MC与 MP、AVC 与 AP 的关系

- $SRTC=TFC+TVC(x)=rK_0+wL$

- $L=f^{-1}(x)$

- $SRTC(x)=TFC+TVC(x)=rK_0+wf^{-1}(x)$

- $SRMC(x)=w \frac{df^{-1}(x)}{dx}$

- $\frac{df^{-1}(x)}{dx}=\frac{dL}{dx}=\frac{1}{\frac{dx}{dL}}=\frac{1}{\frac{df(L)}{dL}}=\frac{1}{f\prime(L)} = \frac{1}{MP_L}$

- $SRMC=\frac {w}{MP_L}$

- 同理： $AVC=\frac {w}{AP_L}$

???
AVC和TVC没有加上SR或者LR是因为它们只有在短期的时候才有区分

---
### 关于成本的讨论
- 场地成本：租赁或者建设
  - “水电气讯”的维护成本
  - 场地维护人员成本
- 设备购置或租赁成本：专项、大型、维护（进入固定资产折旧）；消耗类不算
- 人员成本 → 体育行业的特殊性，特别是职业俱乐部。无论比赛数量多少，每对在册人员要求是固定的
  - 转会费（资本类生产要素） → 运动员进入俱乐部被视为资产，出现在资产负债表的左侧
  - 运动员工资（劳动类生产要素）

- 运营成本：“水电气讯”按时付费、办公室日常开销
- 市场开发成本：比赛日各类开支、宣传、产品渠道等
- 劳务成本：安保、兼职人员、临时人员
  
---
### 长期成本


- 所有要素投入都是**可变**的，如球队可以离开联盟或者更新、扩建现有设施
- 厂商**必须而且能夠**配给(rationing)最有效的要素组合
- **有效规模**

???

那么长期根据企业的盈利能力, 那么可以扩大投入，也可以压缩投入。

---
### 长期成本、短期成本与生产规模调整

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data <- tibble(
  q = seq(0, 6, 0.01),
  SRAC_s = 18 - 8*q + 3*q^2,
  SRAC_m = 30- 16*q + 3*q^2,
  SRAC_l = 60 - 24*q + 3*q^2
) %>% 
  mutate(SRAC = case_when(SRAC_s <= SRAC_m & SRAC_s <= SRAC_l ~ SRAC_s,
                         SRAC_m <= SRAC_s & SRAC_m <= SRAC_l ~ SRAC_m,
                         SRAC_l <= SRAC_s & SRAC_l <= SRAC_m ~ SRAC_l))

cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = SRAC_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SRAC_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SRAC_l), color = orange, size = 1, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SRAC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SRAC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SRAC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "总产量（规模）", y = "$")
```
]

.less-right[
- S、M、L 代表三种规模的短期成本线
- 每种规模下，产量对应的短期平均成本线最低点连接起来，就是长期平均成本线
]

---
### 长期成本、短期成本与生产规模调整

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = SRAC_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SRAC_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SRAC_l), color = orange, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SRAC), color = purple, size = 1.5, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SRAC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SRAC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(LRAC), x = 4, y = 8.5, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = expression(SRAC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "总产量（规模）", y = "$")
```
]

.less-right[
- LRAC 比SRAC 更平缓
  - SRAC 每点对应的规模相同
  - LRAC 每点对应的规模不同

]

---
### 长期情况下使用**规模经济与规模不经济**反映要素集中度与经济效益的关系

.pull-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
SRAC <- function(x) 10 - 2.75*x + 0.5*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 11), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量（规模）", y = "$")+
  stat_function(fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 4.5, y = 6.4, color = purple, family = cnfont, size = 7.7)
```
]

.pull-right[
#### economies/<br>diseconomies of scale:长期平均总成本随**产量**增加而减少的特性
- **规模经济与规模不经济**
<br>反映长期中厂商投入生产要素集中度与经济效益之间的关系
  - 规模经济：SRAC 相切于 LRAC 下降位置
  → 规模扩大时，平均成本有下降趋势
- 导致平均成本曲线 U 型原因不同
  - 短期SR：**边际**报酬递增或递减
  - 长期LR：**规模**报酬递增或递减

]

---
### 长期用规模经济与规模不经济反映要素集中度与经济效益的关系

- **最适规模**：能够使得 LRAC 达到最低点的规模
  - 最适规模量级大：意味着最大产量即便非常大，也能维持 LRAC 持续下降或最低
  - 最适规模有很多个 → 盘子形，比如超市等
  - 最适规模只有一个 → V 型
- 规模经济再细分为**内部经济**(internal)和**外部经济**(external)
  - 内部经济：规模扩大后，厂商内部因素使得LRAC 继续降低
      - 源于：企业自身的规模和运营效率——更有效分工和专业化、采购经济、技术经济(足够资源投入研发)、管理经济(大厂魅力)
      - 结果：处于LRAC负斜率
  - 外部经济：规模扩大后，厂商因外因素使得LRAC持续降低
      - 源于：企业所处的行业和地区的整体环境——行业集聚(体育公园、晋江)、基础设施建设(体育产业园，数字、水电气讯)、技术溢出效应(创业园、科技园)
      - 效果：LRAC整体下移
- 规模不经济(内部不经济)：管理效率下降、分工无法提升生产效率；效果：处于LRAC正斜率

---
class: title-slide-section, middle, inverse
# 供给曲线从何而来?

---
### 收入线

.less-right[生产者理论主要是指厂商经济行为模型。职业联盟因为是由多个厂商（俱乐部）构成，俱乐部行为决定了联盟结构，因此本讲中会稍作深入讲解。
- Cost成本线：生产成本、生产技术、厂商决策
- .hi.orange[Revenue收入线：厂商要素转换为产品后，必须经由市场进行销售。如何销售?定价?与供给关系密切→从最简单开始]

]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="500">

]

---
class: title-slide-section, middle, inverse

# 价格接受厂商的供给曲线

---
#### 价格接受厂商面临的市场环境

1. 买卖双方量大: 许多买家和卖家
2. 产品同质性强: 相同的、无差异的产品 
3. 行业壁垒性小: 自由进入和退出
4. 市场信息完备: 消费者和厂商可根据完备信息作出最优决策

#### 市场结果

- **没有市场势力: ** 厂商无法操控价格 → 无法区别定价:
由于产品的同质性和完全的市场信息，厂商无法对不同的消费者采取不同的价格
- **定价权在市场**:
市场上的价格由供需关系决定，单个厂商必须接受市场价格，无法通过自身的行为来影响价格 → 每家厂商都是**价格接受者**
- **短期利润和长期均衡**:
在短期内，某些厂商可能由于成本控制等因素获得超额利润，但在长期内，市场的自由进出会使得所有厂商的利润趋于正常水平

---
### 完全竞争的市场结构

**问：**现实中，几乎没有完全竞争市场，为什么费力地建立一个模型？

**答.sub[1]:** 理解机制

- 简单，排除了许多现实中的复杂因素，使得分析变得更为直观和简单，易于初级教学
- 价格机制、供需关系以及市场的自我调节功能
- 对其他市场结构的启示，从完全竞争模型出发，逐步引入现实中的复杂因素

**答.sub[2]:** 基准比较
- 政策制定:
在政策制定和评估时，完全竞争模型可以作为一个参考框架。例如，它可以帮助政策制定者评估市场干预的必要性和可能的效果
- 通过比较现实世界的市场条件和完全竞争市场的条件，可以回答"我们怎样做得更好？"的问题

---
### 总收益TR、平均收益AR和边际收益MR

.center[
#### 总收益.mono[=] 销售数量 .mono[*] .pink[销售价格]
]

完全竞争厂商的销售数量等于它所面临的需求量，销售价格就是产品的市场价格。
- **总收益** 是厂商按一定价格出售一定量产品时所获得的全部收入<br> $T R(TP)=P \cdot TP=\bar{P} \cdot TP$

- **平均收益** 是厂商在平均每单位产品销售上所获得的收入<br> $AR(TP)=\frac{T R(TP)}{TP}=\frac{\bar{P} \cdot TP}{TP}=\bar{P}$ 

- **边际收益** 是厂商增加一单位产品销售所获得的总收益的增量 $M R(TP)=\frac{\Delta T R(TP)}{\Delta TP}=\frac{d T R(TP)}{d TP}=\frac{d(\bar{P} \cdot TP)}{d TP}=\bar{P}$

- 价格接受厂商的平均收益 $AR$ ，边际收益 $MR$ 和需求曲线 $D$ **三者重叠**的

- 总收益曲线是从原点出发斜率为 $\bar{P}$ 的射线

???

---
### 实现利润最大化的条件（FOC与SOC）

边际收益 $M R$ 等于边际成本 $M C$ 是厂商实现利润最大化的均衡条件。
<br></br>
厂商利润为 $\pi(TP)=T R(TP)-T C(TP)$

利润最大化要满足一阶导数为零

$\frac{d \pi(TP)}{d(TP)}=\frac{d T R(TP)}{d TP}-\frac{d T C(TP)}{d TP}=0$

由此得出 $M R(TP)-M C(TP)=0$, 即 $M R(TP)=M C(TP)$
<br></br>
以上条件是必要条件，并非充分条件。即要实现利润最大化，必须有 $M R(TP)=M C(TP)$ 。但反过来，如果 $M R(TP)=M C(TP)$ 则不一 定实现利润最大化，因为还可能是利润最小化的点。这时需要结合利润函数的二阶导数 $\frac{d^{2} \pi(TP)}{d TP^{2}}=M R^{\prime}(TP)-M C^{\prime}(TP)<0$ 来判断。
---
### 边际收益

.less-right[
- 定义

> **产出**增加一个单位所产生的总收益的变化

- 为什么价格接受厂商面临的市场需求曲线是水平?
]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 10, y = 7.6, color = red_pink, family = cnfont, size = 9) +
  annotate("text", label = expression(Delta*"TR"=="MR"), x = 4, y = 4, color = green, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"TP"==1), x = 4, y = 1.5, color = met_slate, family = cnfont, size = 4) +
  geom_point(aes(x = 3, y = 7), color = met_slate, size = 2) +
  geom_point(aes(x = 5, y = 7), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 5, y = 0, xend = 5, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 1, xend = 5 - 0.1, yend = 1), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = 0, ymax = 7), alpha = 0.2, fill = green)
```
]

---
### 边际收益

.less-right[
在完全竞争市场中，是价格接受者

- MR .mono[=] P

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = green, size = 1) +
  annotate("text", label = expression(MR==P), x = 8, y = 7.6, color = green, family = cnfont, size = 9)
```
]

---
### 应用：概念辨析

- 假设你是一个运动器材销售商
1. **边际产品 (Marginal Product)**（数学概念）:
   边际产品是指当投入的某一要素（如劳动、资本等）增加一个单位时，产出的增量。例如，如果你雇佣了一个额外的销售员，而他每天能够销售10个篮球，那么这10个篮球就是边际产品
2. **边际报酬 (Marginal Returns)**（经济概念）:
   边际报酬是指投入的某一要素增加一个单位时带来**边际产品的变化方向**。例如，如果雇佣了一个额外的销售员，他每天能够销售10个篮球；再雇佣一个销售员但销售了 8 个，我们就说边际报酬下降了
3. **边际收益 (Marginal Revenue)**（数学概念+经济概念）:
   边际收益是指销售额外一个单位产品时，总收入的增量。例如，每个篮球的售价是$10，当你销售一个额外的篮球时，你的总收入增加$10，所以边际收益是$10
- 边际产品关注的是产量的增加，边际收益关注的是收入的增加，而边际报酬刻画的是生产的边际效率

---
### 完全竞争市场结构下的厂商决策(短期)

- 厂商面对的价格是给定的

- 短期内厂商无法调整生产规模(固定成本给定、其他要素投入给定，如资本)

- 给定的生产规模下，厂商通过调整产量来实现 MR = MC 以满足利润最大化的均衡条件。
---
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SRAC(q)
z <- seq(0, q, 0.001)

p_max_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(8)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost, p), labels = c(8, 12)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1)+
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
    annotate("text", label = "SRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SRAC(q)
z <- seq(0, q, 0.001)

p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("8", "$96.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("8", "$96.00", "$8.00", "$64.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_ribbon(aes(x = z, ymin = cost, ymax = p), fill = green, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "利润", x = q/2, y = (p + cost)/2, color = green, family = cnfont, size = 4.5) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("8", "$96.00", "$8.00", "$64.00", "$32.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SRAC(q)
z <- seq(0, q, 0.001)

p_max_2 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(6)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(7)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "SRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("", "\\( \\qquad \\ \\ \\ \\)", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2 <- p_max_2 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("6", "$42.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("6", "$42.00", "$7.00", "$42.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("6", "$42.00", "$7.00", "$42.00", "$0.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 13
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SRAC(q)
z <- seq(0, q, 0.001)

p_max_3 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p, cost), labels = c(5, 8)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "SRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("", "", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("4", "$20.00", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = q, xend = q, y = p, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("4", "$20.00", "$8.00", "$32.00", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_ribbon(aes(x = z, ymin = p, ymax = cost), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q/2, y = (p + cost)/2, color = red_pink, family = cnfont, size = 6) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SRMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SRAC", "TC = SRAC &times; TP", "利润"),
  v2 = c("4", "$20.00", "$8.00", "$32.00", "-$12.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 短期决策 .mono[vs.] 长期决策

#### 短期

- .green[固定成本]给定 .mono[-->] 但是不影响生产决策
  - 因为无论企业是否开业，都必须支付设备租金(固定成本)

- 可以调整支付.pink[可变成本]

  - 例如为工人安排更短工时、购买更少原材料等
  
- **只要厂商能支付可变成本(比赛日当天的工资)** .mono[-->] **继续营业**

  - 可以支付.pink[可变成本]时 .mono[-->] 允许亏本经营，延期支付固定成本
  - 无法支付.pink[可变成本]时 .mono[-->] 最好的办法就是停工，以减少损失
  
- .bb[短期决策两个目标：1.不停工；2.利润最大化]

---
### 短期决策 .mono[vs.] 长期决策

#### 长期

- 所有成本都是可变的

- 因为允许自由进退 .mono[-->] 厂商可以离开这个行业

    - 如通过不续租的方式或者出售设备

- 因为允许自由进退 .mono[-->] 新厂商可以加入这个行业 .mono[-->] 完全竞争

- .bb[长期决策目标：不退出]

---
### 短期决策
>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SRAC_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- SRAC(SRAC_min)

sr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停工"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "SRAC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = avc, color = orange, size = 1) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
sr_conditions 
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

]

---
count: false
### 短期决策
>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

]

---
count: false
### 短期决策
>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. .hi.purple[SRAC] .mono[<] P <br> .mono[-->] .green[有利润]

]

---
count: false
### 短期决策
>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. .hi.purple[SRAC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[SRAC] <br> .mono[-->] .pink[存在运营损失]

]

---
count: false
### 短期决策
>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停工", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格π

1. .hi.purple[SRAC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[SRAC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停工]

]

---
count: false
### 短期决策

>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停工", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. .hi.purple[SRAC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[SRAC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停工]

]

---
### 短期决策

>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SRAC_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- SRAC(SRAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停工"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SRAC, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "SRAC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = avc, color = orange, size = 1, alpha = 0.5) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "SRMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[短期供给曲线]

P .mono[>] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SRMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] Y轴

]

---
count: false
### 短期决策

>为什么 AVC 在 SRAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SRAC_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- SRAC(SRAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停工"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[短期供给曲线]

P .mono[>] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SRMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] Y轴

**市场短期供给曲线是多个厂商的短期供给加总，因此市场短期供给曲线也是右上倾斜**

]

---
### 长期决策

#### 长期

- 所有成本都是可变的

- 因为允许自由进退 .mono[-->] 厂商可以离开这个行业

    - 如通过不续租的方式或者出售设备

- 因为允许自由进退 .mono[-->] 新厂商可以加入这个行业

.pink[问题是：]长期来看，厂商何时退出还是进入市场？

- 退出市场的好处.mono[=]节约成本.mono[=]TC

- 退出市场的成本.mono[=]收入损失.mono[=]TR
    
.pink[答案: ] 如果TC .mono[>] TR就退出，如果TC.mono[<] TR就进入

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SRAC_min <- 3
p_zero_profit <- SRAC(SRAC_min)

lr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "LRMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. P .mono[>] .hi.purple[LRAC] <br> .mono[-->] .green[有利润]

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. P .mono[>] .hi.purple[LRAC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LRAC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. P .mono[>] .hi.purple[LRAC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LRAC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SRAC_min <- 3
p_zero_profit <- SRAC(SRAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SRAC, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "LRAC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "LRMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(SRAC_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LRAC]以上的部分


P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SRAC_min <- 3
p_zero_profit <- SRAC(SRAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(SRAC_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LRAC]以上的部分

P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]

---
class: title-slide-section,inverse, middle
## 完全竞争环境中的供需与价格接受厂商的调整（比较静态分析）

---

### 完全竞争市场

.pink[问题] 价格接受厂商对市场结果的调整过程如何？

- 注意，只有短期才有所谓的调整
- 长期，产品的均衡价格最低，等于最低LRAC → 经济利润为 0

---
### 完全竞争市场的短期均衡

**Case 1:** 市场短期价格 .mono[>] 市场长期价格(minLRAC)

- 单厂商赚取利润 <br> .mono[-->] 其他企业家看到市场有利可图 <br> .mono[-->] 厂商数量增加 <br> .mono[-->] 市场短期供给曲线右移 <br> .mono[-->] 市场短期价格下降

---
### 完全竞争市场的短期均衡


**Case 2:** 市场短期价格 .mono[<] 市场长期价格(minLRAC)

- 单厂商亏损经营（或停工） <br> .mono[-->] 离开市场 <br> .mono[-->] 市场上此类产品供应厂商数量减少 <br> .mono[-->] 市场短期供给曲线左移 <br> .mono[-->] 市场短期价格上升

---
### 完全竞争市场的短期均衡(单厂商不改变生产规模报酬)

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SRAC(q)
z <- seq(0, q, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[厂商]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[市场]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("LRAC的最低点"),
  v2 = c("LRAC的最低点处的产量"),
  v3 = c("Q.sub[厂商] &times; N.sub[多厂商]"),
  v4 = c("Q.sub[市场] &divide; Q.sub[厂商]")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  align = c("c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
### 完全竞争市场的短期均衡(单厂商不改变生产规模报酬)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SRAC(q)
z <- seq(0, q, 0.001)

firm_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(5)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

market_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(5)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("$5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c("")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
count: false
### 完全竞争市场的短期均衡(单厂商不改变生产规模报酬)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("$5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c(750)
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  # scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  # annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # 
  # geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  # annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  # scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = demand_2, color = red_pink, size = 1) +
  # annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("", "", "", ""),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("$3.00", 3, 2250, 750),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

**A.sub[1]:** .pink[厂商减少原产品生产 .mono[-->] 市场总供给数量下降]

**A.sub[2]:** .pink[短期厂商将会以亏损状态运营]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = supply_2, color = purple, size = 1) +
  # annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  # geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SRAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SRAC(q)
cost_2 <- SRAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SRAC, color = purple, size = 1) +
  annotate("text", label = "LRAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SRMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]==MR[3]), x = 6.1, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("$3.00", 3, 2250, 750),
  v4 = c("$5.00", 4, 500, 125)
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```


**A.sub[1]:** .pink[厂商减少原产品生产 .mono[-->] 市场总供给**数量**下降]

**A.sub[2]:** .pink[短期厂商将会以亏损状态运营]

**A.sub[3]:** .pink[长期厂商不断退出市场，直到经济利润恢复到0 .mono[-->] 市场总供给下降]

