---
title: "体育经济分析: 原理与应用"
subtitle: "单元1: 概要与预备知识"
author: 
   - 周正卿
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: yes
      countIncrementalSlides: yes
      ratio: '16:10.85'
    seal: true
    lib_dir: libs
  html_document:
    keep_md: yes

knit: pagedown::chrome_print

# beamer模板

# mainfont: Times New Roman
# fontsize: 10pt
# output: 
#   beamer_presentation: 
#     fonttheme: structurebold
#     theme: Madrid
#     colortheme: lily
#     includes:
#         in_header: "../beamer_header.tex"
#     df_print: tibble
#     latex_engine: xelatex

---

```{R, setup, include = F}
# devtools::install_github("dill/emoGG")
library(pacman)
p_load(
  broom, tidyverse,rmarkdown,
  ggplot2, ggthemes, ggforce, ggridges,
  latex2exp, viridis, extrafont, gridExtra,
  kableExtra, snakecase, janitor,
  data.table, dplyr, estimatr,
  lubridate, knitr, parallel,
  lfe,dslabs,
  here, magrittr)

options(htmltools.dir.version = FALSE)

# Notes directory
dir_slides <- "/Users/zhouzhengqing/Desktop/SportsEconAnalysis/2024spring/Lec03/"
# Define pink color
red_pink <- "#e64173"
turquoise <- "#20B2AA"
orange <- "#FFA500"
red <- "#fb6107"
blue <- "#3b3b9a"
green <- "#007935"
grey_light <- "grey70"
grey_mid <- "grey50"
grey_dark <- "grey20"
purple <- "#6A5ACD"
slate <- "#314f4f"
met_slate <- "#272822" # metropolis font color 

# Dark slate grey: #314f4f

# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.retina = 3,
  warning = F,
  message = F,
  echo=F
)
opts_chunk$set(dev = "svg")
options(device = function(file, width, height) {
  svg(tempfile(), width = width, height = height)
})
options(crayon.enabled = F)
options(knitr.table.format = "html")
# A blank theme for ggplot
theme_empty <- theme_bw() + theme(
  line = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  plot.margin = structure(c(0, 0, -0.5, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)

theme_simple <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  # axis.text.x = element_text(size = 12),
  # axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_market <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.title.x = element_text(hjust = 1, size = 17),
  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),
  axis.ticks = element_blank()
)
theme_gif <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_goods <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 17, family = cnfont), 
  axis.text.x = element_text(size = 17),
  axis.text.y = element_text(size = 17, angle = 90, hjust = 0.5),
  axis.title.x = element_text(color = purple, size = 19),
  axis.title.y = element_text(color = red_pink, size = 19),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
theme_game <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 20, family = cnfont), 
  axis.text.x = element_text(size = 20, color = met_slate),
  axis.text.y = element_text(size = 20, angle = 90, color = met_slate, hjust = 0.5),
  axis.title.x = element_text(color = met_slate, size = 20),
  axis.title.y = element_text(color = met_slate, size = 20),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
shift_axis <- function(p, y=0){
  g <- ggplotGrob(p)
  dummy <- data.frame(y=y)
  ax <- g[["grobs"]][g$layout$name == "axis-b"][[1]]
  p + annotation_custom(grid::grobTree(ax, vp = grid::viewport(y=1, height=sum(ax$height))), 
                        ymax=y, ymin=y) +
    geom_hline(aes(yintercept=y), data = dummy, size = 0.5, color = met_slate) +
    theme(axis.text.x = element_blank(), 
          axis.ticks.x = element_blank())
}

wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = "\n")
# functions
theme_set(theme_gray(base_size = 20))
# Column names for regression results
reg_columns <- c("Term", "Est.", "S.E.", "t stat.", "p-Value")
# Function for formatting p values
format_pvi <- function(pv) {
  return(ifelse(
    pv < 0.0001,
    "<0.0001",
    round(pv, 4) %>% format(scientific = F)
  ))
}
format_pv <- function(pvs) lapply(X = pvs, FUN = format_pvi) %>% unlist()
# Tidy regression results table
tidy_table <- function(x, terms, highlight_row = 1, highlight_color = "black", highlight_bold = T, digits = c(NA, 3, 3, 2, 5), title = NULL) {
  x %>%
    tidy() %>%
    select(1:5) %>%
    mutate(
      term = terms,
      p.value = p.value %>% format_pv()
    ) %>%
    kable(
      col.names = reg_columns,
      escape = F,
      digits = digits,
      caption = title
    ) %>%
    kable_styling(font_size = 20) %>%
    row_spec(1:nrow(tidy(x)), background = "white") %>%
    row_spec(highlight_row, bold = highlight_bold, color = highlight_color)
}
xaringanExtra::use_tile_view()
xaringanExtra::use_scribble()
xaringanExtra::use_animate_css()
xaringanExtra::use_fit_screen()
xaringanExtra::use_clipboard()
library("tidyverse")
library("mosaic")
library("ggrepel")
library("fontawesome")
xaringanExtra::use_tachyons()
xaringanExtra::use_freezeframe()
update_geom_defaults("label", list(family = "Fira Sans Condensed"))
update_geom_defaults("text", list(family = "Fira Sans Condensed"))
set.seed(256)

```

### 体育产品的形态（供讨论）
- 一部分是单一形态
  - 传统能以三次产业划分
  - 专业器材、场地设施、运动用品等
  - 赛事服务、职业俱乐部、运动训练公共服务部门
  - 媒体相关
- 一部分是复合形态
  - 通过参与各类可供观赏的运动组合获得体验感，满足人的欲望、提高福祉水平，→ 竞技运动服务业
  - 通过增加个体身体运动能力、改善身体和心理健康水平，扩大社交网络，间接实现“再生产”能力提升的服务类产品 → 健身休闲娱乐服务业

---
### 体育企业

- 健身休闲和竞赛表演（职业俱乐部）
  - 1750 年，英国，纽马克特赛马俱乐部（the Jockey club）是世界上第一个按照所有权和经营权分离原则，按独立法人模式商业运营的俱乐部
  - 1888，英格兰足球联赛，欧洲职业俱乐部联盟的起源
  - 1876，MLB是北美职业联盟的起源
- 资本所有权和生产经营权分离，促成了更多资源、人才、知识进入体育行业
  - 生产方式的规律
  - 决策的基本逻辑 → 不同目标的行为差异
  - 联盟的组织形态
      - 收益方式：连锁经营、特许经营等模式
      - 联盟治理：维持竞争均衡（收入分享、工资帽、奢侈税、选秀）；门票定价策略；选址与扩张
      - 治理联盟：反垄断


---
### Jockey Club

.center[
```{R echo=FALSE}
library(htmltools)
library(shiny)

tags$video(
  tags$source(src ="./video/jockclub.mp4", type = "video/mp4"),
  type = "video/mp4",
  width = "840",
  height = "460",
  controls = TRUE,
  tags$track(src = "./video/jockclub.srt", kind = "subtitles", srclang = "cn", label = "Chinese")
)
```
]


---
### 现代企业的起源（从小作坊到企业）I

.left-column[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/viner.jpg height=270 width=200>
.smaller[

Jacob Viner

1892-1970

协力组合说

]
]
]


.right-column[

- 规模经济 + 范畴经济

- **规模经济（Economies of Scale）**指，当生产规模（产品数量）增加时平均成本会下降 → 在规模经济的作用下，小规模的生产体有就动机去扩张规模，追求规模经济
- **范畴经济（Economies of Scope）**是厂商在**生产多种产品**比**生产单一产品**的成本要低（资源共享和技术关联） → 小生产体有动机联合更多不同类产品的生产体，从而建立大规模的厂商

]

???

- 企业部门分为生产部门和非生产部门。像是销售、会计、财务、市场等部门，虽然不直接生产产品，但它们控制成本、提高效率方面发挥着重要作用。有效的内部管理可以进一步降低企业的运营成本，增强其市场竞争力。

- 大型企业通过规模经济实现成本效率，通过范畴经济实现市场风险的分散和管理效率的提高。此外，大型企业在面对市场波动时，由于其产品和服务的多样性，能够更好地吸收市场的冲击，从而实现更稳定的收入。

- 合并与市场波动：当不同的厂商生产技术相互关联，或者处于同一供应链的不同环节时，通过合并可以降低市场波动带来的风险。合并后的大型企业能够更好地控制供应链，减少对外部市场变化的依赖，从而实现更稳定的收入和利润。
---
### 现代企业的起源（从小作坊到企业）II

.left-column[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/256px-Nobel_Prize_2009-Press_Conference_KVA-35-3-193x300.jpg height=270 width=200>
.smaller[

Oliver Williamson

1932-2020

长期关系说

]
]
]


.right-column[

- switching cost +  specific investment

- **“Air Jordan”案例**
  - 在20世纪80年代，Nike与Jordan签订长期合约
  - 专门投入巨大资源进行产品设计、市场营销和广告宣传。这些投资是高度专用的
  - 转换成本： 更换代言人会带来巨大成本。增加了Jordan对Nike依赖程度

]

???
- 特定投资是在其他用途上的价值较低，反而增加了交易双方在未来持续合作的激励（互惠）。一旦更换新交易对象，就面临着高转换成本（重新谈判、重新投资等），所以实际形成了一种双边独占的情况，为了减少不确定性和潜在的敲诈风险，双方可能会选择签订**长期合约**，作为价格、供应量、质量标准的制度保障 → → 解释了在不确定性和复杂性的市场环境中，企业为何选择特定的治理结构，比如长期合约、垂直整合或合并（从小变大），以管理交易成本并保护对特定交易的投资

---
### 现代企业的起源（从小作坊到企业）III

.left-column[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/220px-Coase_profile_2003.jpg height=270 width=200>
.smaller[

Ronald Coase

1910-2013

不完全契约说

]
]
]


.right-column[


- 在不完全契约下，企业存在必然

- 由于契约中不能穷尽所有情况，特别是**不确定因素和契约遗漏项**、**结果多样性**、**是否履约监督成本**以及高昂的**违约诉讼费** 厂商可以理解为对不完全契约问题的一种回应
- 厂商通过内部化（即在厂商内部进行交易而不通过市场）来减少交易成本，尤其是在监督、协商和执行契约方面的成本
]

---
class: title-slide-section, center, middle, inverse
# 供给曲线从何而来? → 生产者理论

Rational Choice Theory: Producers

---
### 为什么

.hi[目标] 生产者理论的分析路线（高级）

- WTP → 需求曲线（P-Q关系）

- 供给曲线从何而来?（P-Q关系）

---
### 思想史：供给理论比需求理论形式化展开的晚

- 供给理论又称为**边际生产率**理论。在亚当斯密之后，古典经济学家对于供给分析（生产环节）是缺失的。通常假定供给是固定（完全无弹性），在有限的供给下如何进行资源配给和要素供应与价格解释，特别是对包括工资、租金、利息和利润之间相互联系与财富分配进行阐述
  - 早期的Longfield（1802-1884）在1834年的《政治经济学讲义》中批评了劳动价值论，并提出边际生产率理论 → 从需求分析中无法解决**要素**配置和财富分配问题
  - 图能（1783-1850）则主要集中在**农业**经济学和**土地使用**的最优分配上，提出的土地使用理论（极差地租） →  暗示了后来的**边际报酬递减律**
- 边际生产率理论为就业理论提供重要启示，特别是与**生产要素市场**链接后，就能得出一个非常重要观点：**在完全竞争市场中，工资应当等于劳动力的边际产出的价值** <br>→ 意味着，如果工资过高将导致失业，因为企业在成本和收益平衡的基础上决定雇佣劳动力的数量；降低工资能够提高就业水平，从而减轻经济萧条的影响
 <br>→  但这种观点在大萧条后，遭遇到了凯恩斯的批评 → 宏观经济理论的提出

---
### 名词解析
- resource allocation 资源配置 → 分配或者拨用人、财、物、时间等资源，以达到某种目的 <br>→ 事前视角

- income distribution 收入分配 → 在一定范围内的分发或者分享某种**单一**要素
 <br>→ 事后视角
- revenue share 收入共享 → 把收入给汇总后，再以某种标准共享给大家，参与者人人有份，且保持公平
 <br>→ 循环视角
 
---
### 讲授路径

.less-right[

- .hi.orange[Cost成本线：生产成本、生产技术、厂商决策]

- Revenue收入线：定价能力、市场结构

- MR=MC
]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="530">

]


---
### 讲授逻辑（写在前面）

- 成本线得到供给生产函数。当经济学打开厂商生产的黑箱时，首先看到的是要素的投入，包括**要素价格**、**要素数量**以及**要素组合方式**。我们将会定义出生产函数、生产技术以及生产阶段。在图形上，我们看到是L-Q平面，反映的“要素-产量”关系 → 技术决定论 
  - 生产函数不同意味着成本函数差异，成本函数刻画的是Q-$平面，与需求曲线（回忆：本质是刻画消费者偏好）在同一个维度。成本函数反映的是“产量-成本消耗”关系             → 成本和要素需求是一个问题的两面（暂不深入）
- 两条路径是理解单个厂商的供给行为的关键
  - MC 路径：生产技术出发 → 生产函数 → 成本函数 → MC 曲线
  - MR 路径：若限定厂商为价格接受者，就可以获得 MR 曲线 
- 进一步，考虑厂商的相似性 → 理解完全竞争市场下供需均衡分析与福利结果
- 但现实往往不是完全竞争环境
  - 独占市场结构下的厂商决策 → 拥有定价能力，就没有供给曲线（统计学意义的产量产值关系） → 对超额利润的治理 .mono[+] 定价策略
  - 寡头市场、独占性竞争的市场结构 → 经济主体间博弈

---
### MR=MC v.s. **内部决策与外部约束** 

- 理解任何决策的微观基础都可以从这个角度出发
  
  - 比如？

- 两者都是内部决策 
  
  - 比较两方的约束差异

- MC 要反映行业特点、行业发展规律

---
class: title-slide-section, center, middle, inverse

# 生产者行为

Producer Behavior

---
### 生产者行为 

生产者如何决定： 

- 生产哪些产品 
- 生产多少 
- 使用哪些投入 
- 以什么价格出售 

这些问题的答案是供给曲线的构建模块

---
### 生产的基础 

.pull-left[ 

- 交换和消费几乎所有商品，必须先**生产**出来
- .hi[消费] 是为了获得**效用**而消耗价值 
  - .hi-purple[消费是所有经济活动最终的目标]
- .hi[生产] 是通过将**低价值**的商品（资源、投入等）转化为**高价值**的商品（产出、消费品等）来创造价值
- 都是**需求（Demand）**表现
  - .hi-red[供应] 实际上是 .hi-blue[需求] 伪装的！ 
  - .hi-red[(机会) 成本] 用于购买（稀缺的）生产投入，因为其他人的 .hi-blue[需求] 这些相同的投入来消费或生产其他有价值的东西！ 
  - 必须支付成本才能将它们从其他有价值的生产用途中**分离**出来
]

.pull-right[
.middle[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/qWNpqa.png>
]
]

---
### 生产技术

经济中的生产技术，是指的投入要素的组合方式。一般要素：土地、劳动力、资本、技术（有时候以人力资本的形式表达）、数据。

数学上，用.hi.pink[生产函数]来反映：对企业生产过程中投入和产出之间关系的数学描述。

.center[
.hi.pink[要素投入 .mono[-->]  生产技术 .mono[-->] 产出方式]
] 

.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/6JglCG.png height=360>

]

---
### 生产要素 I

$$Q=A \,f(T,L,K)$$

.pull-left[
.smaller[
- 经济学家通常将投入分类，称为.hi[“生产要素” (FOP)]：

```{r,results="asis", echo=F}
tribble(
~"要素", ~"所有权", ~"收益", "土地 (T)", "地主", "租金", "劳动力 (L)", "劳动者", "工资", "资本 (K)", "资本家", "利息",
) %>%
  knitr::kable(., format="html")
```
]
.smallest[
- $A$: .b["全要素生产率"] (创意、知识、制度因素)
- $L$:  → $eL$ ：人力资本和劳动力

]
]

.pull-right[
.center[
<img src=./figs/factors.jpg>
]

]

---

### 生产要素 II


$$Q=f(L,K)$$

.pull-left[

- 我们假设只有两个输入：劳动力 L 和资本 K


```{r,results="asis", echo=F}
tribble(
~"要素", ~"所有权", ~"收益", "劳动力 (L)", "劳动者", "工资", "资本 (K)", "资本家", "利息",
) %>%
  knitr::kable(., format="html")
```


]

.pull-right[
.center[
<img src=./figs/factors.jpg>
]

]

---
### 生产函数TPF

#### 定义:**一段时间内**生产要素投入量与.pink[产品最大产出量]之间的关系
- $Q=f(L, K)$ 

- 有时以产量(Q，output)代替产品最大产出量(TP)

- 生产行为都是在**一个时间段内**进行的 → TP 是**流量**概念

<br>→像土地而言，是一种**存量**概念

<br>→资本有时是固定的，有时是变动的。不会因生产而马上消失，属于**耐久财**

  - **当前的资本量是过去新增资本的累积减去耗损与折旧，因此通常也视为存量**




---
### 生产（成本）要考虑时间问题


- **市场期market period**：市场期间是如此短暂，以至于供给是固定的或完全无弹性的。价格对供应量没有反作用，因为这个周期太短，企业无法对价格变化做出反应
- **短期short run**：短期是企业可以改变生产和供应但不能改变厂房规模的时期。更高的价格驱使厂商供应数量增加，供应曲线向上倾斜。只能改变产量，不能改变厂房规模。在短期内，企业的总成本分为随产出变化的成本(**可变成本**)；不随产出变化的成本(**固定成本**)。这种区分来自对商业世界的观察。
- **长期long run**：厂房规模可以变化，所有成本都是可变的。长期供应曲线比短期更有弹性，因为企业能够通过改变厂房规模充分调整以适应价格变化
  - 长期供应曲线可以采取三种一般形式：它可以向上和向右倾斜（成本可能增加）；它可以完全有弹性（成本可能恒定）；或者，在不寻常的情况下，它可以向下和向右倾斜（成本可能减少）→ 规模经济
- **世俗期secular period**：一个行业的世俗期或非常长期，允许技术和人口变化，代际间价格的变动时的时间设定



---
### 短期：生产函数

.pull-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "总产量") +
  stat_function(fun = total_product, color = purple, size = 1)
```
]

.pull-right[

- $Q=f(L, \bar{K})$ 

- 假设资本是固定的（即工厂、店面等数量） 

- 短期决策仅关于使用劳动力

]

---
count: false
### 最大总产出的三个阶段


```{r, echo = FALSE, fig.height = 7, fig.width = 12, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "总产量") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速度递增", 15), x = 2.67/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速度递增", 15), x = (2.67 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 15), x = (7.5 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  geom_ribbon(aes(x = z, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank") + # PS
  geom_ribbon(aes(x = u, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank")
```


---
### 边际产量 MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 
q_1 <- total_product(3)
q_2 <- total_product(4)

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) +
  theme_market +
  labs(x = "L", y = "总产量") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_point(aes(x = 3, y = q_1), color = met_slate, size = 2) +
  geom_point(aes(x = 4, y = q_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 4, y = 0, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_1, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_2, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 10, xend = 4 - 0.1, yend = 10), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_segment(aes(x = 0.5, y = q_1 + 0.75, xend = 0.5, yend = q_2 - 0.75), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  annotate("text", label = expression(Delta*"总产量"=="边际产量"), x = 2, y = (q_1 + q_2)/2, color = met_slate, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"L"==1), x = 3.5, y = 7.5, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
#### 定义:增加一单位.pink[可变要素]劳动投入量所增加的产量
- $$
M P_L=\frac{\Delta Q}{\Delta L}
$$

- 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
count: false
### 边际产量 MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) 

shift_axis(mp1)
```
]

.less-right[
#### 定义:增加一单位.pink[可变要素]劳动投入量所增加的产量
- $$
M P_L=\frac{\Delta Q}{\Delta L}
$$

- 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]



---
count: false
### 边际产量 MP

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速递增", 22), x = 2.67/2 - 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速递增", 22), x = (2.67 + 5.68)/2 + 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 22), x = (7.5 + 5.68)/2, y = 14.75, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.less-right[
#### 定义:增加一单位.pink[可变要素]劳动投入量所增加的产量
- $$
M P_L=\frac{\Delta Q}{\Delta L}
$$

- 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]


---
### 经验法则:单一要素边际报酬最终会递减

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("边际报酬递增", 18), x = 2.67/2 - 0.0, y = 14.85, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("边际报酬递减", 18), x = (2.67 + 7.5)/2 + 0.0, y = 14.85, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.less-right[

- .hi-purple[Law of diminishing marginal returns:]
<br> .hi[在其他所有要素保持不变的情况下],增加单一生产要素，将导致产出增加幅度逐渐降低。


- 为了增加产出，企业需要增加所有要素！

]


---
### 应用：经营体育场馆

- 假设你是一家体育场馆的经理，场馆有5个篮球场。为了提高场馆的使用率和收入，你决定招聘更多的教练来提供篮球培训课程
    1. 当你招聘了1个教练时，每天可以为20个学员提供培训
    2. 当你招聘第2个教练时，每天又增加了20个学员，总共40个学员
    3. 当你招聘第3个教练时，由于篮球场数量的限制，每天只增加了15个学员，总共55个学员
    4. 当你招聘第4个教练时，每天只增加了10个学员，总共65个学员
- 随着教练数量的增加，每增加一个教练所带来的额外学员数量在逐渐减少。这就是边际报酬递减法则的体现
- 在一定程度上，增加更多的输入（如教练）将不再能够有效地提高产出（如培训学员数量），甚至可能会导致产出的减少

---
### 报酬递减原理 principle of diminishing returns

- **重要性**：解释厂商短期供给曲线的形状 + 厂商派生的生产要素需求曲线形状

- **来源于农业生产的观察**。李嘉图Ricardo 在研究农业生产函数时（即土地的实物投入与实物产出间的关系）时发现：当他把土地当成一个可变要素，然后假定整个生产过程中资本对劳动的比率因技术不变而固定，只是持续增加土地要素（可变），然后看单位面积的农产品产出会有什么样的变化。他发现，单位土地的产生是递减的 → “土地的报酬递减”，他认为是由于土地的质量下降引起的（不断耕作新土地，贫瘠土地最终投入使用） → 最终使得全国平均亩产量趋于下降

- **后来者精炼**：一种要素不变，**持续**增加**可变要素**到这种**不变要素**上时，产量开始以递增速度增加，然后以递减的速度增加，最终递减

- **深刻性**：涉及到了要素投入的量与质的关系 
<br> → 对利润来源的解释 <br>→ 对“经济租”(economic rent)和成本的区分 + 大规模非同质要素的假设 <br>→ 机会成本概念的产生

---
### 平均产量

- 平均产量 Average product of labor 

- $$AP_L= \frac{Q}{L}$$

- 衡量：劳动生产率
  - 分析时参照行业还是单个企业
  


---
### 最大总产量、平均产量和边际产量的关系

.pull-left[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/yUWHvE.png height=260>
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/43wNVt.png height=260>
]
]

.pull-right[
Stage I，**边际产量始终大于平均产量**：
- MP上升，达到最大值后并开始下降
- 这一阶段总产量始终加速增加的
- .bb[**固定要素（比如土地）**相对过剩，而**可变要素（比如劳动）投入量**持续投入会有利可图 → Q 加速上升、L 持续增加(未来会影响成本函数)]
]

---
count: false

### 总产量、平均产量和边际产量的关系

.pull-left[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/yUWHvE.png height=260>
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/43wNVt.png height=260>
]
]

.pull-right[
Stage II，截止到**边际产量等于零**：
- **平均产量曲线和边际产量曲线相交**，即AP达到最高点。
]
---
count: false

### 总产量、平均产量和边际产量的关系

.pull-left[
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/yUWHvE.png height=260>
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/43wNVt.png height=260>
]
]

.pull-right[
Stage III，**总产量也呈现下降**：
- AP下降，MP为负
- 这一阶段减少**可变要素**投入是有利的
]

---
count: false

### 生产阶段的决策


- 理性的生产者既不会将生产停留在Stage I，也不会将生产扩张到Stage III

- 因此Stage II是生产者进行短期生产的决策区间

- **至于在StageII的哪一点才能达到利润最大化，需要结合成本、收入和利润进行深入分析**

- .b[所以**实际中MP**是**向下倾斜的**]


---
### 为什么要区分生产阶段

- 建立**边际决策分析的外部约束机制** → 来自于经验观察的证据

- MP和AP，MP代表边际生产效率，AP代表平均生产率 Q/L

- 平均生产率通常能刻画行业的属性



---
### 数学推导：MP 对 AP 影响的数学表达

设 $T P=Q=f(L) ; A P_{L}=T P / L$，
$L$ 的平均产量对 $L$ 投入的变化率 :


$\frac{d A P_{L}}{d L}=\frac{d(T P / L)}{d L}=\frac{d(Q / L)}{d L}=\frac{\frac{d Q}{d L} L-\frac{d L}{d L} Q}{L^{2}}$


$=\frac{\frac{d Q}{d L} L-Q}{L^{2}}=\frac{1}{L}(\underbrace{\frac{d Q}{d L}}_{M P_{L}}-\underbrace{\frac{Q}{L}}_{A P_{L}})$


- 当 $M P_{L}>A P_{L}, A P_{L}$ 处于递增阶段
- 当 $M P_{L}<A P_{L}, A P_{L}$ 处于递减阶段
- 当 $M P_{L}=A P_{L}, A P_{L}$ 达到最大值


---

class: middle, inverse, center

# 成本最小化问题

The Cost Minimization Problem

---
### 生产决策时考虑的成本是.bb[机会成本]

- 稀缺性  .mono[->] 机会成本

- 依据是否能使用会计账目划分：  总成本.mono[=] .purple[显成本] .mono[+] .pink[隐成本]

#### .purple[显成本]

- 一般是工资、租金、原材料、维修费、缴纳税款等。

#### .pink[隐成本]

- 丧失的**次优投资品的价值**。例等额的投资要是放在股票市场的回报

---

### 例子：给你100万去投资，该如何选？

项目的启动资金是100万，利息是5%。

.pink[方案1：]借100万

- 显成本 .mono[=] 5万

.pink[方案2：]动用40万的储蓄，借60万

- 显成本 .mono[=] 3万 .mono[<--] 偿还5%的贷款利息

- 隐成本 .mono[=] 2万 .mono[<--] 从储蓄中拿出40万RMB，放弃5%的利息

.pink[任一方案的总成本 .mono[=] 5万]

---

### 机会成本的出处
.left-column[
.center[
<img src=../images/mises2.png>

.smallest[
Ludwig von Mises

1881—1973

奥地利经济学派
]
]
]

.right-column[
.small[


>成本是**the importance of the next most urgent want that can now no longer be satisfied**（对于决策者而言，当下最紧迫的、不能马上就满足的其他需求的重要性）
  
> 在现代经济学教材中，把**替代的可行方案中价值最高**的方案的价值就是机会成本
- 因此新古典经济学家把超过平均成本的部分定义为利润（无法体会到其经济含义）

> 即便在完全竞争下），0 经济利润也有意义
  - 心理最想满足的欲望，它的心理价值只能用 importance 来衡量（主观价值判断），而不是用 value 来描述 <br>→ 企业家使用当前要素创造的价值会比账目价值高 

]

.source[von Mises, Ludwig, 1949, 《经济学的认识论》第四章]

]


---
###  会计利润  v.s.  经济利润 

#### 会计利润 <br> $\quad$ .mono[=] 总收益 .mono[-] .pink[显成本]

#### 经济利润 <br> $\quad$ .mono[=] 总收益 .mono[-] (.pink[显成本] .mono[+] .purple[隐成本])  <br> $\quad$ .mono[=] 会计利润 .mono[-] .purple[隐成本]

**重要** 

.center[
## 会计利润 .mono[>] 经济利润
]

>所以一家赚钱的公司，并不总是意味着一家公司做得很好



---

### 会计与经济观点 I

.more-left[

- 有助于考虑两个观点：

1. .hi-purple[“会计观点”]：你的收入是否大于支出？
2. .hi[“经济观点”]：你的产品是否使你的资源得到了最佳的社会利用

  - 是否存在你将资源拒之门外的价值更高的用途？

]

.less-right[
.center[
![ 70%](../images/costrevenue.jpg)

![ 70%](../images/disappear.jpg)
]
]

---
### 会计与经济观点 II

.more-left[

- .hi-turquoise[对社会的意义]：消费者是否最希望你用稀缺资源（因为有其他用途！）来生产当前的产品？ 

- .hi-turquoise[这是一门.ul[*经济学*]课程，而不是商业课程]！ 

  - .hi-purple[经济学家是亲市场的，而不是亲商业的]！ 

  - 对一个企业有利/不利的事情对社会可能产生不利/有利的后果！

]

.less-right[
.center[
![ 70%](../images/costrevenue.jpg)

![ 70%](../images/disappear.jpg)
]
]

---

### 市场经济中的消费者主权
.left-column[
.center[
<img src=../images/mises2.png>

.smallest[
Ludwig von Mises

1881—1973
]
]
]

.right-column[
.quitesmall[

> 在市场社会中，所有经济事务的方向都是企业家的任务。他们控制着生产。他们掌舵并驾驶着这艘船。一位肤浅的观察者会认为他们是至高无上的。但事实并非如此。他们必须无条件地服从船长的命令。**船长是消费者**。企业家、农民和资本家都不能决定生产什么。消费者决定这一点。如果一位商人没有严格按照市场价格结构向他传达的公众命令行事，他就会遭受损失，破产，并因此被从掌舵的显赫位置上撤换。其他在满足消费者需求方面做得更好的企业家会取代他。

> 消费者惠顾那些他们能以最便宜的价格买到想要东西的商店。他们的购买和不购买决定了谁应该拥有和经营工厂和土地。他们让穷人变富，让富人变穷。他们准确地决定应该生产什么，生产什么质量，生产什么数量，”（第 270 页）。

]

.source[von Mises, Ludwig, 1949, *Human Action*]

]

---

### 机会成本与沉没成本

.more-left[

- 机会成本是一个**前瞻性**的概念 

  - 过去做出的不可回收成本的选择称为 .hi[沉没成本] 

- 沉没成本**不应**进入未来的决策 

  - 许多人难以放弃不可改变的过去决定： .hi[沉没成本谬误]
]

.less-right[
.center[
![](../images/sunkcost.jpg)
]
]


---

### 企业中常见的沉没成本

.more-left[

- 许可费、长期租赁合同 

- 特定资本（无替代用途）：制服、菜单、标志 

- 研发支出 

- 广告支出

]

.less-right[

.center[
![](../images/sunkcost.jpg)
]
]

---

### 固定成本与沉没成本

.more-left[
.small[
- .hi[固定] 与 .hi-purple[沉没] 成本之间的差异？ 

- .hi-purple[沉没成本] 是一种 .hi[固定成本]，不可避免且不可收回 

  - 从长远来看，许多 .hi[固定成本] 可以避免或改变 
- 常见的 .hi[固定]，但不是 .hi-purple[沉没] 成本：
  - 办公空间租金、耐用品、（可续期的）营业许可证 

- 在决定是否继续经营时，.hi[固定成本] 很重要，.hi-purple[沉没成本] 则无关紧要！
]
]

.less-right[
.center[
![](../images/sunkcost.jpg)
]
]



---
class: title-slide-section, center, middle, inverse

# 短期成本

---
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本，已知总产量函数

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("", "", "", "", "", ""),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")

```

---
count: false
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("$1000", "$1000", "$1000", "$1000", "$1000", "$1000"),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("$1000", "$1000", "$1000", "$1000", "$1000", "$1000"),
  v4 = c("$0", "$2000", "$4000", "$6000", "$8000", "$10000"),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("$1000", "$1000", "$1000", "$1000", "$1000", "$1000"),
  v4 = c("$0", "$2000", "$4000", "$6000", "$8000", "$10000"),
  v5 = c("$1000", "$3000", "$5000", "$7000", "$9000", "$11000")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "总成本"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```
---
class: clear-slide
### 从经验理解短期成本
瓜农种瓜的例子：短期成本

.pink.hi[固定成本] 土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜

.pink.hi[可变成本] 劳动力.mono[-->] 市场工资为每月2000元

.center[.purple[**STC曲线**]]

.pull-left[
```{R, echo = F, escape = F}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c("$1000", "$3000", "$5000", "$7000", "$9000", "$11000")
) 
cost_data %>% 
  kable(
  escape = F,
  col.names = c("西瓜 (Q)", "总成本"),
  align = c("c", "c")#,
) %>%
kableExtra::row_spec(1:6, color = met_slate) %>%
kableExtra::row_spec(1:6, extra_css = "line-height: 110%;")
```
]

.pull-right[
```{r, echo = FALSE, fig.height = 3.25, fig.width = 4.25, dev = "svg"}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c(1000, 3000, 5000, 7000, 9000, 11000)
) 
cost_data %>% 
  ggplot(aes(x = q, y = tc)) +
  scale_x_continuous(limits = c(0, 3500)) +
  scale_y_continuous(limits = c(0, 12000), expand=c(0, 0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  geom_point(size = 2, color = purple) +
  geom_line(size = 1, color = purple)
```
]

---
### 短期总成本曲线SC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = total_cost, color = purple, size = 1) 
```
]

.less-right[
#### .purple.hi[**STC曲线**]:产出与.pink[最低投入成本]的关系

- Q-$平面

- 短期的前面S

.hi[思考]为什么总成本曲线是S型？
]

???

.purple.hi[边际产量先增后减。既然边际产量一段时间会增加，意味着该时期内的边际成本很可能是降低的。] 

---
### 总成本的构成

#### 总成本 .mono[=] .green[固定成本] .mono[+] .pink[可变成本]
- STC(x)=TFC + TVC(x)
#### .green[固定成本]
> .green[成本不随产出数量的变化而变化]
- 如租金、设备成本、贷款支付等；对短期边际成本SMC没有影响

#### .pink[可变成本]
> .pink[成本随产出数量变化而变化]
- 如工资, 原材料成本等；对短期边际成本SMC有影响

---
### 总成本的构成

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
vc <- function(x) 10*x - 4*x^2 + x^3
fc <- function(x) 10

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function(fun = fc, color = green, size = 1) +
  stat_function(fun = total_cost, color = purple, size = 1) +
  stat_function(fun = vc, color = red_pink, size = 1) +
  annotate("text", label = "STC", x = 3.6, y = 50, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = "TVC", x = 4.75, y = 50, color = red_pink, family = cnfont, size = 7.7) +
  annotate("text", label = "TFC", x = 4.75, y = 13, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
#### .green[总固定成本(TFC)]

#### .pink[总可变成本 (TVC)]

]

---
### 理解成本函数的关键是理解可变成本

.pull-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/SgaiiJ.png height=444>
]

.pull-right[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/9ZlkV8.png height=420 >
]

---
### 平均固定成本AFC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
afc <- function(x) 10/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function(fun = afc, color = green, size = 1) +
  annotate("text", label = "AFC", x = 4.75, y = 5.5, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
#### 定义

> AFC .mono[=] TFC &divide; 总产量

随着产量上升而减少 <br> .mono[-->] 更多产出分摊TFC

]

---
### 平均可变成本AVC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function(fun = avc, color = red_pink, size = 1) +
  annotate("text", label = "AVC", x = 4.75, y = 18, color = red_pink, family = cnfont, size = 7.7)

```
]

.less-right[
#### 定义

> AVC .mono[=] TVC &divide; 总产量

]


---
### 平均成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 9)
```
]

.less-right[
#### 定义

> ATC .mono[=] TC &divide; Q <br> .mono[=] AFC .mono[+] AVC

]

---
count: false
### 平均成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 9) +
  geom_vline(xintercept = 2.69, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = "有效规模", x = 2.69, y = 60, color = met_slate, family =  cnfont, size = 4)
```
]

.less-right[
#### 定义

> ATC .mono[=] TC &divide; Q <br> .mono[=] AFC .mono[+] AVC

有效的规模 Efficient scale .mono[=] Q，最小化 ATC
]


---

### 边际和平均之间的关系

- 边际值与平均值之间的数学关系 

  - 如果 .red[边际值] < .orange[平均值]，则 .orange[平均值] 降低 

  - 如果 .red[边际值] > .orange[平均值]，则 .orange[平均值] 提高 

  - 如果 .red[边际值] = .orange[平均值] 时，.orange[平均值] 最大化/最小化 

- .hi-purple[当 MC(q)=AC(q) 时，AC(q) **最小**]（盈亏平衡价格） 

- .hi-purple[当 MC(q)=AVC(q) 时，AVC(q) **最小***]（关门价格）


---
### 平均成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x
afc <- function(x) 10/x
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 9) +
  geom_vline(xintercept = 2.69, color = met_slate, size = 1, linetype = "dashed") +
  stat_function(fun = afc, color = green, size = 1) +
  annotate("text", label = "AFC", x = 4.75, y = 5.5, color = green, family = cnfont, size = 9) +
  stat_function(fun = avc, color = red_pink, size = 1) +
  annotate("text", label = "AVC", x = 0.4, y = 5, color = red_pink, family = cnfont, size = 9) +
  annotate("label", label = "有效规模", x = 2.69, y = 60, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[

有效的规模 Efficient scale .mono[=] Q，最小化 ATC

Q.mono[<]有效规模：下降的AFC拉低ATC

Q.mono[>]有效规模：上升的AVC拉高ATC。
]

---
### 平均成本 .mono[+] 边际成本
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x
marginal_cost <- function(x) 10 - 8*x + 3*x^2
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 9) +
  stat_function(fun = avc, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "AVC", x = 4.8, y = 10, color = red_pink, family = cnfont, size = 9, alpha = 0.5) +
  stat_function(fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 4.8, y = 50, color = red_pink, family = cnfont, size = 9)
```
]

.less-right[
MC .mono[<] ATC .mono[==>] ATC 下降

MC .mono[>] ATC .mono[==>] ATC 上升

MC 在使 ATC 最小的 Q 处与 ATC 相交

]

---
count: false
### 平均成本 .mono[+] 边际成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x
marginal_cost <- function(x) 10 - 8*x + 3*x^2
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 9) +
  stat_function(fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 4.8, y = 50, color = red_pink, family = cnfont, size = 9)
```
]

.less-right[
MC .mono[<] ATC .mono[==>] ATC 下降

MC .mono[>] ATC .mono[==>] ATC 上升

MC 在使 ATC 最小的 Q 处与 ATC 相交

]

---
### 短期边际成本SMC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
marginal_cost <- function(x) 10 - 8*x + 3*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量", y = "$") +
  stat_function(fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 4.8, y = 50, color = red_pink, family = cnfont, size = 9)
```
]

.less-right[
#### 定义
> 产量增加一个单位所产生的总成本的变化。

]

---
### 图形展示：MC与 MP、AVC 与 AP 的关系
.center[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/G7kTx3.png height="570" width="480">
]

---
### 数学推导：MC与 MP、AVC 与 AP 的关系

- $STC=TFC+TVC(x)=rK_0+wL$

- $L=f^{-1}(x)$

- $STC(x)=TFC+TVC(x)=rK_0+wf^{-1}(x)$

- $SMC(x)=w \frac{df^{-1}(x)}{dx}$

- $\frac{df^{-1}(x)}{dx}=\frac{dL}{dx}=\frac{1}{\frac{dx}{dL}}=\frac{1}{\frac{df(L)}{dL}}=\frac{1}{f\prime(L)} = \frac{1}{MP_L}$

- $SMC=\frac {w}{MP_L}$

- 同理： $AVC=\frac {w}{AP_L}$

???
AVC和TVC没有加上S或者L是因为它们只有在短期的时候才有区分

---
### 应用：成本类型的判别
- 场地成本：租赁或者建设
  - “水电气讯”的维护成本
  - 场地维护人员成本
- 设备购置或租赁成本：专项、大型、维护（进入固定资产折旧）；消耗类不算
- 人员成本 → 体育行业的特殊性，特别是职业俱乐部。无论比赛数量多少，每对在册人员要求是固定的
  - 转会费（资本类生产要素） → 运动员进入俱乐部被视为资产，出现在资产负债表的左侧
  - 运动员工资（劳动类生产要素）
- 运营成本：“水电气讯”按时付费、办公室日常开销
- 市场开发成本：比赛日各类开支、宣传、产品渠道等
- 劳务成本：安保、兼职人员、临时人员

---
class: title-slide-section, center, middle, inverse

# 长期成本

---
### 长期决策：要素替代关系与长期成本

- 短期决策 
  - 边际报酬与生产技术：在长期生产函数中，企业可以采用不同的生产技术。每种技术对劳动和资本的边际报酬（即增加一个单位的劳动或资本所带来的额外产量）可能是不同的 <br> → 短期中，我们谈论**边际报酬递减规律**，是建立资本投入为固定的情况下

- 长期决策
- 不仅需要单一要素持续投入会受边际报酬规律影响，原本的单一要素的边际产量也会受到**要素比例投入比例改变**的影响（交叉效果）
- 决策依然延续“生产技术→成本的”思考方式，**但是**
  - 长期中企业可以调整所有生产要素（劳动和资本）→ 允许企业选择最优的要素组合来最大化产量或效率 → 长期生产函数应该反映要素间的**技术替代关系**

---
### 规模报酬<sup>.pink[†]</sup>returns to scale与生产技术

.pull-left[
.small[


- .hi-purple[规模报酬不变 constant returns to scale]：产出与投入以.hi-turquoise[相同比例]增加

- .hi-purple[规模报酬递增 increasing returns to scale ]：产出增加率 .hi-turquoise[超过] 要素增加比率

- .hi-purple[规模报酬递减 decreasing returns to scale]：产出增加率 .hi-turquoise[低于] 要素增加比率

- 生产技术的进步可以改变一个企业或经济体的规模报酬状况
    - 自动化：通过引入自动化和更高效的生产流程，可以将原本规模报酬递减的生产过程转变为规模报酬递增
    - 信息化
]
]

.pull-right[
.middle[
![](./figs/scaleup.png)
]
]
.footnote[<sup>.pink[†]</sup>  生产的.hi[规模报酬]：当**所有**投入.hi-turquoise[以相同比率]（规模）增加时产出的变化
]



---

### 长期成本与规模经济 I

.pull-left[
.center[
![](./figs/scaleup.png)
]
]

.pull-right[
.small[
- 基于生产规模经济的成本的属性：当产量增加（规模化）时平均成本的变化

- .hi-purple[规模经济]：产量增加，平均成本.hi-turquoise[下降]
  - 固定成本高 $AFC > AVC(q)$ 可变成本低 

- .hi-purple[规模不经济]：产量增加，平均成本.hi-turquoise[上升]
  - 固定成本低 $AFC < AVC(q)$ 可变成本高

- .hi-purple[规模经济不变]：产量增加，平均成本.hi-turquoise[不变]

- 公司的平均成本最低（最佳工厂规模），称为.hi[最低有效规模 (MES)]
]
]

---

### 长期成本与规模经济 I

.pull-left[
.center[
![](./figs/scaleup.png)
]
]


.pull-right[
- 注意 .hi[规模经济] **不同于** .hi-purple[规模报酬]! 

- .hi-purple[规模报酬]：投入与产出之间的**技术**关系 → 技术特征表达(数学概念)

- .hi[规模经济]：产出与平均成本之间的**经济**关系 → 经济概念

]

---
### 长期成本、短期成本与生产规模调整

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data <- tibble(
  q = seq(0, 6, 0.01),
  SAC_s = 18 - 8*q + 3*q^2,
  SAC_m = 30- 16*q + 3*q^2,
  SAC_l = 60 - 24*q + 3*q^2
) %>% 
  mutate(SAC = case_when(SAC_s <= SAC_m & SAC_s <= SAC_l ~ SAC_s,
                         SAC_m <= SAC_s & SAC_m <= SAC_l ~ SAC_m,
                         SAC_l <= SAC_s & SAC_l <= SAC_m ~ SAC_l))

cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = SAC_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SAC_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SAC_l), color = orange, size = 1, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SAC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SAC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SAC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "总产量（规模）", y = "$")
```
]

.less-right[
- S、M、L 代表三种规模的短期成本线
- 每种规模下，产量对应的短期平均成本线最低点连接起来，就是长期平均成本线
]

---
### 长期成本、短期成本与生产规模调整

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = SAC_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SAC_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SAC_l), color = orange, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = SAC), color = purple, size = 1.5, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SAC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SAC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(LAC), x = 4, y = 8.5, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = expression(SAC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "总产量（规模）", y = "$")
```
]

.less-right[
- LAC 比SAC 更平缓
  - SAC 每点对应的规模相同
  - LAC 每点对应的规模不同
]

---
### 长期情况下使用**规模经济与规模不经济**反映要素集中度与经济效益的关系

.pull-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
SAC <- function(x) 10 - 2.75*x + 0.5*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 11), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "总产量（规模）", y = "$")+
  stat_function(fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 4.5, y = 6.4, color = purple, family = cnfont, size = 7.7)
```
]

.pull-right[
#### economies/<br>diseconomies of scale

<br> 长期平均总成本随**产量**增加而减少的特性

- **规模经济与规模不经济**
<br>反映长期中厂商投入生产要素集中度与经济效益之间的关系
  - 规模经济：SAC 相切于 LAC 下降位置
  → 规模扩大时，平均成本有下降趋势
- 导致平均成本曲线 U 型原因不同
  - 短期S：**边际**报酬递增或递减
  - 长期L：**规模**报酬递增或递减

]

---
### 长期用规模经济与规模不经济反映要素集中度与经济效益的关系

- **最适规模**：能够使得 LAC 达到最低点的规模
  - 最适规模量级大：意味着最大产量即便非常大，也能维持 LAC 持续下降或最低
  - 最适规模有很多个 → 盘子形，比如超市等
  - 最适规模只有一个 → V 型
- 规模经济再细分为**内部经济**(internal)和**外部经济**(external)
  - 内部经济：规模扩大后，厂商内部因素使得LAC 继续降低
      - 源于：企业自身的规模和运营效率——更有效分工和专业化、采购经济、技术经济(足够资源投入研发)、管理经济(大厂魅力)
      - 结果：处于LAC负斜率
  - 外部经济：规模扩大后，厂商因外部因素使得LAC持续降低
      - 源于：企业所处的行业和地区的整体环境——行业集聚(体育公园、晋江)、基础设施建设(体育产业园，数字、水电气讯)、技术溢出效应(创业园、科技园)
      - 效果：LAC整体下移
- 规模不经济(内部不经济)：管理效率下降、分工无法提升生产效率；效果：处于LAC正斜率

---
class: title-slide-section, middle, inverse ,center
# 供给曲线从何而来?

Where does the supply curve come from?

---
### 收入线

.less-right[生产者理论主要是指厂商经济行为模型。职业联盟因为是由多个厂商（俱乐部）构成，俱乐部行为决定了联盟结构，因此本讲中会稍作深入讲解。
- Cost成本线：生产成本、生产技术、厂商决策
- .hi.orange[Revenue收入线：厂商要素转换为产品后，必须经由市场进行销售。如何销售?定价?与供给关系密切→从最简单开始]

]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="500">

]

---
class: title-slide-section, middle, inverse ,center

# 价格接受厂商的供给曲线

Price-accepting firm' supply curve

---
#### 价格接受厂商面临的市场环境

1. 买卖双方量大: 许多买家和卖家
2. 产品同质性强: 相同的、无差异的产品 
3. 行业壁垒性小: 自由进入和退出
4. 市场信息完备: 消费者和厂商可根据完备信息作出最优决策

#### 市场结果

- **没有市场势力: ** 厂商无法操控价格 → 无法区别定价:
由于产品的同质性和完全的市场信息，厂商无法对不同的消费者采取不同的价格
- **定价权在市场**:
市场上的价格由供需关系决定，单个厂商必须接受市场价格，无法通过自身的行为来影响价格 → 每家厂商都是**价格接受者**
- **短期利润和长期均衡**:
在短期内，某些厂商可能由于成本控制等因素获得超额利润，但在长期内，市场的自由进出会使得所有厂商的利润趋于正常水平

---
### 完全竞争的市场结构

**问：**现实中，几乎没有完全竞争市场，为什么费力地建立一个模型？

**答.sub[1]:** 理解机制

- 简单，排除了许多现实中的复杂因素，使得分析变得更为直观和简单，易于初级教学
- 价格机制、供需关系以及市场的自我调节功能
- 对其他市场结构的启示，从完全竞争模型出发，逐步引入现实中的复杂因素

**答.sub[2]:** 基准比较
- 政策制定:
在政策制定和评估时，完全竞争模型可以作为一个参考框架。例如，它可以帮助政策制定者评估市场干预的必要性和可能的效果
- 通过比较现实世界的市场条件和完全竞争市场的条件，可以回答"我们怎样做得更好？"的问题

---
### 总收益TR、平均收益AR和边际收益MR

.center[
#### 总收益.mono[=] 销售数量 .mono[*] .pink[销售价格]
]

完全竞争厂商的销售数量等于它所面临的需求量，销售价格就是产品的市场价格。
- **总收益** 是厂商按一定价格出售一定量产品时所获得的全部收入<br> $T R(TP)=P \cdot TP=\bar{P} \cdot TP$

- **平均收益** 是厂商在平均每单位产品销售上所获得的收入<br> $AR(TP)=\frac{T R(TP)}{TP}=\frac{\bar{P} \cdot TP}{TP}=\bar{P}$ 

- **边际收益** 是厂商增加一单位产品销售所获得的总收益的增量 $M R(TP)=\frac{\Delta T R(TP)}{\Delta TP}=\frac{d T R(TP)}{d TP}=\frac{d(\bar{P} \cdot TP)}{d TP}=\bar{P}$

- 价格接受厂商的平均收益 $AR$ ，边际收益 $MR$ 和需求曲线 $D$ **三者重叠**的

- 总收益曲线是从原点出发斜率为 $\bar{P}$ 的射线

???

---
### 实现利润最大化的条件（FOC与SOC）

边际收益 $M R$ 等于边际成本 $M C$ 是厂商实现利润最大化的均衡条件。
<br></br>
厂商利润为 $\pi(TP)=T R(TP)-T C(TP)$

利润最大化要满足一阶导数为零

$\frac{d \pi(TP)}{d(TP)}=\frac{d T R(TP)}{d TP}-\frac{d T C(TP)}{d TP}=0$

由此得出 $M R(TP)-M C(TP)=0$, 即 $M R(TP)=M C(TP)$
<br></br>
以上条件是必要条件，并非充分条件。即要实现利润最大化，必须有 $M R(TP)=M C(TP)$ 。但反过来，如果 $M R(TP)=M C(TP)$ 则不一 定实现利润最大化，因为还可能是利润最小化的点。这时需要结合利润函数的二阶导数 $\frac{d^{2} \pi(TP)}{d TP^{2}}=M R^{\prime}(TP)-M C^{\prime}(TP)<0$ 来判断。
---
### 边际收益

.less-right[
- 定义

> **产出**增加一个单位所产生的总收益的变化

- 为什么价格接受厂商面临的市场需求曲线是水平?
]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
x <- seq(0, 8, 0.1)
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 10, y = 7.6, color = red_pink, family = cnfont, size = 9) +
  annotate("text", label = expression(Delta*"TR"=="MR"), x = 4, y = 4, color = green, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"Q"==1), x = 4, y = 1.5, color = met_slate, family = cnfont, size = 4) +
  geom_point(aes(x = 3, y = 7), color = met_slate, size = 2) +
  geom_point(aes(x = 5, y = 7), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 5, y = 0, xend = 5, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 1, xend = 5 - 0.1, yend = 1), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = 0, ymax = 7), alpha = 0.2, fill = green)
```
]

---
### 边际收益

.less-right[
对于一个处于完全竞争市场的公司来说，
- MR .mono[<=>] D.

- MR .mono[=] P.

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "TP", y = "P") +
  geom_hline(yintercept = 7, color = green, size = 1) +
  annotate("text", label = expression(MR==P), x = 8, y = 7.6, color = green, family = cnfont, size = 9)
```
]

---
### 应用：概念辨析

- 假设你是一个运动器材销售商
1. **边际产品 (Marginal Product)**（数学概念）:
   边际产品是指当投入的某一要素（如劳动、资本等）增加一个单位时，产出的增量。例如，如果你雇佣了一个额外的销售员，而他每天能够销售10个篮球，那么这10个篮球就是边际产品
2. **边际报酬 (Marginal Returns)**（经济概念）:
   边际报酬是指投入的某一要素增加一个单位时带来**边际产品的变化方向**。例如，如果雇佣了一个额外的销售员，他每天能够销售10个篮球；再雇佣一个销售员但销售了 8 个，我们就说边际报酬下降了
3. **边际收益 (Marginal Revenue)**（数学概念+经济概念）:
   边际收益是指销售额外一个单位产品时，总收入的增量。例如，每个篮球的售价是$10，当你销售一个额外的篮球时，你的总收入增加$10，所以边际收益是$10
- 边际产品关注的是产量的增加，边际收益关注的是收入的增加，而边际报酬刻画的是生产的边际效率

---
### 完全竞争市场结构下的厂商决策(短期)

- 厂商面对的价格是给定的

- 短期内厂商无法调整生产规模(固定成本给定、其他要素投入给定，如资本)

- 给定的生产规模下，厂商通过调整产量来实现 MR = MC 以满足利润最大化的均衡条件。
---
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SAC(q)
z <- seq(0, q, 0.001)

p_max_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(8)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost, p), labels = c(8, 12)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1)+
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
    annotate("text", label = "SAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SAC(q)
z <- seq(0, q, 0.001)

p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("8", "$96.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("8", "$96.00", "$8.00", "$64.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_ribbon(aes(x = z, ymin = cost, ymax = p), fill = green, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "利润", x = q/2, y = (p + cost)/2, color = green, family = cnfont, size = 4.5) 
p_max_1
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("8", "$96.00", "$8.00", "$64.00", "$32.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SAC(q)
z <- seq(0, q, 0.001)

p_max_2 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(6)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(7)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "SAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("", "\\( \\qquad \\ \\ \\ \\)", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2 <- p_max_2 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("6", "$42.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("6", "$42.00", "$7.00", "$42.00", "")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("6", "$42.00", "$7.00", "$42.00", "$0.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 13
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SAC(q)
z <- seq(0, q, 0.001)

p_max_3 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p, cost), labels = c(5, 8)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "SAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 7.7) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("", "", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("4", "$20.00", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = q, xend = q, y = p, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("4", "$20.00", "$8.00", "$32.00", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
### 完全竞争市场结构下的厂商决策(短期)

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_ribbon(aes(x = z, ymin = p, ymax = cost), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q/2, y = (p + cost)/2, color = red_pink, family = cnfont, size = 6) 
p_max_3
```
]

.less-right[

.pink[Q: ] 厂商如何最大化利润?

.pink[A: ] .pink[在 MR .mono[=] SMC 处选择生产 TP]（.green[MR]= $\bar{P}$）

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("TP", "TR = P &times; TP", "SAC", "TC = SAC &times; TP", "利润"),
  v2 = c("4", "$20.00", "$8.00", "$32.00", "-$12.00")
) %>% kable(
  escape = F,
  col.names = c("产品价格(P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
### 短期决策 .mono[vs.] 长期决策

#### 短期

- .green[固定成本]给定 .mono[-->] 但是不影响生产决策
  - 因为无论企业是否开业，都必须支付设备租金(固定成本)

- 可以调整支付.pink[可变成本]

  - 例如为工人安排更短工时、购买更少原材料等
  
- **只要厂商能支付可变成本(比赛日当天的工资)** .mono[-->] **继续营业**

  - 可以支付.pink[可变成本]时 .mono[-->] 允许亏本经营，延期支付固定成本
  - 无法支付.pink[可变成本]时 .mono[-->] 最好的办法就是停工，以减少损失
  
- .bb[短期决策两个目标：1.不停工；2.利润最大化]

---
### 短期决策 .mono[vs.] 长期决策

#### 长期

- 所有成本都是可变的

- 因为允许自由进退 .mono[-->] 厂商可以离开这个行业

    - 如通过不续租的方式或者出售设备

- 因为允许自由进退 .mono[-->] 新厂商可以加入这个行业 .mono[-->] 完全竞争

- .bb[长期决策目标：不退出]

---
### 短期决策
>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SAC_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- SAC(SAC_min)

sr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停工"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "SAC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = avc, color = orange, size = 1) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
sr_conditions 
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

]

---
count: false
### 短期决策
>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

]

---
count: false
### 短期决策
>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. .hi.purple[SAC] .mono[<] P <br> .mono[-->] .green[有利润]

]

---
count: false
### 短期决策
>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. .hi.purple[SAC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[SAC] <br> .mono[-->] .pink[存在运营损失]

]

---
count: false
### 短期决策
>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停工", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格π

1. .hi.purple[SAC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[SAC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停工]

]

---
count: false
### 短期决策

>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "停工", x = 8.35, y = p_shut_down - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "运营损失", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 厂商何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. .hi.purple[SAC] .mono[<] P <br> .mono[-->] .green[有利润]

2. .hi.orange[AVC] .mono[<] P .mono[<] .hi.purple[SAC] <br> .mono[-->] .pink[存在运营损失]

3. P .mono[<] .hi.orange[AVC] <br> .mono[-->] .orange[停工]

]

---
### 短期决策

>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SAC_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- SAC(SAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停工"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SAC, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "SAC", x = 5.75, y = 31, color = purple, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = avc, color = orange, size = 1, alpha = 0.5) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "SMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[短期供给曲线]

P .mono[>] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] Y轴

]

---
count: false
### 短期决策

>为什么 AVC 在 SAC 的下方?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SAC_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- SAC(SAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["停工"]), expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[短期供给曲线]

P .mono[>] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] .hi.purple[SMC] 在.hi.orange[AVC]以上的部分

P .mono[<] P.sub[停工] .mono[-->] 短期供给曲线 .mono[=] Y轴

**市场短期供给曲线是多个厂商的短期供给加总，因此市场短期供给曲线也是右上倾斜**

]

---
### 长期决策

#### 长期

- 所有成本都是可变的

- 因为允许自由进退 .mono[-->] 厂商可以离开这个行业

    - 如通过不续租的方式或者出售设备

- 因为允许自由进退 .mono[-->] 新厂商可以加入这个行业

.pink[问题是：]长期来看，厂商何时退出还是进入市场？

- 退出市场的好处.mono[=]节约成本.mono[=]TC

- 退出市场的成本.mono[=]收入损失.mono[=]TR
    
.pink[答案: ] 如果TC .mono[>] TR就退出，如果TC.mono[<] TR就进入

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SAC_min <- 3
p_zero_profit <- SAC(SAC_min)

lr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "LMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7)
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions 
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. P .mono[>] .hi.purple[LAC] <br> .mono[-->] .green[有利润]

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. P .mono[>] .hi.purple[LAC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LAC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
count: false
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "退出", x = 8.35, y = p_zero_profit - 3, color = orange, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "利润", x = 8.35, y = p_zero_profit + 3, color = green, family = cnfont, size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

.pink[Q: ] 何时运营？何时停工？

.pink[A: ] 价格接受厂商，是否停工完全依赖市场价格

1. P .mono[>] .hi.purple[LAC] <br> .mono[-->] .green[有利润]

2. .hi.purple[LAC] .mono[>] P <br> .mono[-->] .orange[退出市场]

]

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SAC_min <- 3
p_zero_profit <- SAC(SAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( fun = SAC, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "LAC", x = 6.9, y = 25, color = purple, family = cnfont, size = 7.7) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "LMC", x = 3.5, y = 31, color = red_pink, family = cnfont, size = 7.7, alpha = 0.5) +
  stat_function( xlim = c(SAC_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LAC]以上的部分


P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]

---
### 单个厂商的长期供给曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
SAC_min <- 3
p_zero_profit <- SAC(SAC_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["收支平衡"]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function( xlim = c(SAC_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[

#### .purple[单个厂商的长期供给曲线]

P .mono[>] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=] .hi.red-pink[MC]高于最小.hi.purple[LAC]以上的部分

P .mono[<] P.sub[收支平衡] .mono[-->] 长期供给曲线 <br> .mono[=]  Y轴

]

---
class: title-slide-section,inverse, middle
## 完全竞争环境中的供需与价格接受厂商的调整（比较静态分析）

---

### 完全竞争市场

.pink[问题] 价格接受厂商对市场结果的调整过程如何？

- 注意，只有短期才有所谓的调整
- 长期，产品的均衡价格最低，等于最低LAC → 经济利润为 0

---
### 完全竞争市场的短期均衡

**Case 1:** 市场短期价格 .mono[>] 市场长期价格(minLAC)

- 单厂商赚取利润 <br> .mono[-->] 其他企业家看到市场有利可图 <br> .mono[-->] 厂商数量增加 <br> .mono[-->] 市场短期供给曲线右移 <br> .mono[-->] 市场短期价格下降

---
### 完全竞争市场的短期均衡


**Case 2:** 市场短期价格 .mono[<] 市场长期价格(minLAC)

- 单厂商亏损经营（或停工） <br> .mono[-->] 离开市场 <br> .mono[-->] 市场上此类产品供应厂商数量减少 <br> .mono[-->] 市场短期供给曲线左移 <br> .mono[-->] 市场短期价格上升

---
### 完全竞争市场的短期均衡(单厂商不改变生产规模报酬)

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SAC(q)
z <- seq(0, q, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[厂商]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(expression(P[L]))) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[市场]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(expression(P[L]))) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("LAC的最低点"),
  v2 = c("LAC的最低点处的产量"),
  v3 = c("Q.sub[厂商] &times; N.sub[多厂商]"),
  v4 = c("Q.sub[市场] &divide; Q.sub[厂商]")
) %>% kable(
  escape = F,
  col.names = c("P.sub[L]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  align = c("c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
### 完全竞争市场的短期均衡(单厂商不改变生产规模报酬)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- SAC(q)
z <- seq(0, q, 0.001)

firm_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(5)) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

market_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(5)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("$5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c("")
) %>% kable(
  escape = F,
  col.names = c("P.sub[L]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
count: false
### 完全竞争市场的短期均衡(单厂商不改变生产规模报酬)
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
firm_1
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("$5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c(750)
) %>% kable(
  escape = F,
  col.names = c("P.sub[L]", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  # scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  # annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # 
  # geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  # annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  # scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = demand_2, color = red_pink, size = 1) +
  # annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("", "", "", ""),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("$3.00", 3, 2250, 750),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

**A.sub[1]:** .pink[厂商减少原产品生产 .mono[-->] 市场总供给数量下降]

**A.sub[2]:** .pink[短期厂商将会以亏损状态运营]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function( fun = supply_2, color = purple, size = 1) +
  # annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  # geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "损失", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = cnfont, size = 5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?
.pull-left[
.center[**单个厂商**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
SAC <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- SAC(q)
cost_2 <- SAC(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "总产量", y = "$")+
  stat_function( fun = SAC, color = purple, size = 1) +
  annotate("text", label = "LAC", x = 6.5, y = 35, color = purple, family = cnfont, size = 6) +
  stat_function( fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "SMC", x = 1, y = 8, color = red_pink, family = cnfont, size = 6) +
  stat_function( fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]==MR[3]), x = 6.1, y = p + 2, color = green, family = cnfont, size = 4.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) +
  
  stat_function( fun = marginal_revenue_2, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = cnfont, size = 4.5, alpha = 0.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5)
```
]
.pull-right[
.center[**市场**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "TP", y = "P") +
  stat_function( fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = cnfont, size = 6, alpha = 0.5) +
  stat_function( fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[L]), x = 6, y = lr_supply(q) - 2, color = purple, family = cnfont, size = 6) +
  stat_function( fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = cnfont, size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = cnfont, size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function( fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = cnfont, size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
class: clear-slide
.pink[Q: ] 一项市场原产品的替代品发明，减少了对原产品的需求。那么，从短期到长期，原厂商如何调整产量?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[厂商]", "Q.sub[市场]", "N.sub[厂商数量]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("$3.00", 3, 2250, 750),
  v4 = c("$5.00", 4, 500, 125)
) %>% kable(
  escape = F,
  col.names = c("均衡", "最初", "新短期", "新长期"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  kableExtra::row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```


**A.sub[1]:** .pink[厂商减少原产品生产 .mono[-->] 市场总供给**数量**下降]

**A.sub[2]:** .pink[短期厂商将会以亏损状态运营]

**A.sub[3]:** .pink[长期厂商不断退出市场，直到经济利润恢复到0 .mono[-->] 市场总供给下降]

---
### 边际成本分析表达的深刻观点
- 成本是经济学最核心的概念。因为生产决策是在边际成本线上的决策，而一旦决定生产就会产生所谓的**派生需求**（derived demand）。厂商的需求不像消费者的需求是直接源自于效用和预算约束的优化，而厂商之所以需要劳动和资本，是为了把生产的产品卖出去
- 时间维度划分的重要性。

---
### 报酬递增的来源

- 论劳动分工与市场广度



