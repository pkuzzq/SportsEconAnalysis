---
title: "Producer Theory"
subtitle: "EC 201: Principles of Microeconomics"
author: "Kyle Raze"
date: "Winter 2020"
output:
  xaringan::moon_reader:
    css: ['default', 'metropolis', 'metropolis-fonts', 'my-css.css']
    self_contained: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "https://platform.twitter.com/widgets.js"
---
class: inverse, middle

```{r Setup, include = F}
options(htmltools.dir.version = FALSE)
library(pacman)
p_load(ggthemes, readxl, viridis, knitr, dslabs, gapminder, extrafont, Ecdat, wooldridge, tidyverse, magrittr, janitor, kableExtra)
# Define colors
red_pink <- "#e64173"
met_slate <- "#272822" # metropolis font color 
purple <- "#9370DB"
green <- "#007935"
light_green <- "#7DBA97"
orange <- "#FD5F00"
turquoise <- "#44C1C4"
red <- "#b92e34"
# Notes directory
dir_slides <- "~/GitHub/Intro_Microeconomics_W20/Lectures/03-Consumer_Theory/"
# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  #dpi = 300,
  #cache = T,
  warning = F,
  message = F
)  
theme_simple <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = "Fira Sans", color = met_slate, size = 17),
  # axis.text.x = element_text(size = 12),
  # axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_market <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = "Fira Sans", color = met_slate, size = 17),
  axis.title.x = element_text(hjust = 1, size = 17),
  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),
  axis.ticks = element_blank()
)
theme_gif <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  text = element_text(family = "Fira Sans", color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_goods <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 17, family = "Fira Sans"), 
  axis.text.x = element_text(size = 17),
  axis.text.y = element_text(size = 17, angle = 90, hjust = 0.5),
  axis.title.x = element_text(color = purple, size = 19),
  axis.title.y = element_text(color = red_pink, size = 19),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
theme_game <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 20, family = "Fira Sans"), 
  axis.text.x = element_text(size = 20, color = met_slate),
  axis.text.y = element_text(size = 20, angle = 90, color = met_slate, hjust = 0.5),
  axis.title.x = element_text(color = met_slate, size = 20),
  axis.title.y = element_text(color = met_slate, size = 20),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
shift_axis <- function(p, y=0){
  g <- ggplotGrob(p)
  dummy <- data.frame(y=y)
  ax <- g[["grobs"]][g$layout$name == "axis-b"][[1]]
  p + annotation_custom(grid::grobTree(ax, vp = grid::viewport(y=1, height=sum(ax$height))), 
                        ymax=y, ymin=y) +
    geom_hline(aes(yintercept=y), data = dummy, size = 0.5, color = met_slate) +
    theme(axis.text.x = element_blank(), 
          axis.ticks.x = element_blank())
}
wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = "\n")
```

# Prologue

---
# Agenda

**Goal:** Understand the tradeoffs that producers face.

- How do producers make decisions?

- Where does the supply curve come from?

**Outline**

1. Costs of production.

2. Firms in competitive markets (today).

3. Monopoly (next week).

---
class: inverse, middle

# Firms in Competitive Markets

---
# (Perfectly) Competitive Markets

## Conditions

1. Many buyers and sellers.

2. Identical, undifferentiated products.

3. Free entry and exit.

4. Each firm is small relative to the market.

--

## Result

**No market power:** Firms have no control over the market price.

- Each firm is a **price taker**.

---
# Competitive Markets

## Examples?

**Q:** Is a stock market perfectly competitive? .purple[Why] or .pink[why not]?

--

- .purple[Many buyers and sellers of a single stock .mono[+] real-time information.]

- .pink[Large institutional investors big enough to influence prices.]

--

**A:** .pink[Competitive, but far from perfectly.]

---
# Competitive Markets

## Examples?

**Q:** Is a farmers' market perfectly competitive? .purple[Why] or .pink[why not]?

--

- .purple[Many buyers and sellers .mono[+] similar products .mono[+] sellers can enter at low cost.]

- .pink[Sometimes there are few sellers .mono[-->] ability to set higher prices.]

--

**A:** .purple[Not perfectly competitive, but close in some settings.]

---
# Competitive Markets

## Examples?

**Q:** Is an online ticket auction perfectly competitive? .purple[Why] or .pink[why not]?

--

- .purple[Many buyers and sellers of the same event.]

- .pink[Some companies get special privileges to buy or sell tickets before others .mono[-->] barriers to entry.]

--

**A:** .purple[Not perfectly competitive, but close.]

---
# Competitive Markets

## Examples?

**Q:** Is the Amazon.com marketplace perfectly competitive? .purple[Why] or .pink[why not]?

--

- .purple[Many buyers and sellers of similar products.]

- .pink[Differentiated products .mono[+] imperfect information .mono[+] Amazon big enough to force other sellers out by temporarily undercutting prices.]

--

**A:** .pink[Probably not.]

---
# Competitive Markets

## Examples?

**Q:** Is the market for corn perfectly competitive? .purple[Why] or .pink[why not]?

--

- .purple[Many buyers and sellers .mono[+] genetically identical crops.]

- .pink[Farm consolidation .mono[+] government manipulation of prices (*e.g.,* subsidies).]

--

**A:** .purple[Not perfectly competitive, but close.]

---
# Competitive Markets

## Examples?

**Q:** Is the market for corn seed perfectly competitive? .purple[Why] or .pink[why not]?

--

- .pink[Few sellers (*e.g.,* Monsanto and Syngenta) .mono[+] barriers to entry (*e.g.,* patents).]

--

**A:** .pink[Not a chance.]

---
# Competitive Markets

**Q:** If there are no examples of a perfectly competitive market, why bother modelling one?

--

**A.sub[1]:** Lay groundwork for modelling more-realistic scenarios.

- Simple, but not for simplicity's sake.

- Insights for other market structures.

--

**A.sub[2]:** Establish a benchmark to compare the "real world" against.

- Helps us answer the question "can we do better?"

- Can address "how can we do better?" by comparing market conditions of "real world" to benchmark conditions.

---
# Market Structure

```{r, echo = FALSE, fig.height = 5.5, fig.width = 7.5,  dev = "svg"}
strategies_p1 <- c("Yes", "No")
strategies_p2 <- c("One", "Few", "Many")

w <- seq(0, 5, 0.01)
x <- seq(10, 15, 0.01)
z <- seq(5, 10, 0.01)

ggplot() + 
  scale_x_continuous(limits = c(0, 15), expand = c(0,0), breaks = c(2.5, 7.5, 12.5), labels = strategies_p2, position = "top")+
  scale_y_continuous(limits = c(0, 10), expand = c(0,0), breaks = c(2.5, 7.5), labels = strategies_p1) +
  labs(x = "Number of Producers", y = "Differentiated Products?") +
  # Player 1 payoffs
  annotate("text", label = expression("Monopoly"), x = 2.5, y = 7.5, family = "Fira Sans", size = 7, color = red_pink) +
  annotate("text", label = expression("Oligopoly"), x = 7.5, y = 5, family = "Fira Sans", size = 7, color = orange) +
  annotate("text", label = expression("N/A"), x = 2.5, y = 2.5, family = "Fira Sans", size = 7, color = met_slate) +
  annotate("text", label = wrapper("Monopolistic Competition", 10), x = 12.5, y = 2.5, family = "Fira Sans", size = 7, color = purple) +
  annotate("text", label = wrapper("Perfect Competition", 10), x = 12.5, y = 7.5, family = "Fira Sans", size = 7, color = green) +
  # theme stuff
  theme_game +
  geom_segment(aes(x = 5, y = 0, xend = 5, yend = 10), linetype  = "solid", size = 1) +
  geom_segment(aes(x = 10, y = 0, xend = 10, yend = 10), linetype  = "solid", size = 1) +
  geom_segment(aes(x = 0, y = 5, xend = 5, yend = 5), linetype  = "solid", size = 1) +
  geom_segment(aes(x = 10, y = 5, xend = 15, yend = 5), linetype  = "solid", size = 1) +
  geom_ribbon(aes(x = w, ymin = 5, ymax = 10), fill = red_pink, alpha = 0.2, linetype = "blank") +
  geom_ribbon(aes(x = z, ymin = 0, ymax = 10), fill = orange, alpha = 0.2, linetype = "blank") +
  geom_ribbon(aes(x = x, ymin = 0, ymax = 5), fill = purple, alpha = 0.2, linetype = "blank") +
  geom_ribbon(aes(x = x, ymin = 5, ymax = 10), fill = green, alpha = 0.2, linetype = "blank")
```

---
class: clear-slide

<iframe width="900" height="600" src="https://www.youtube.com/embed/COf2bQEQ7Zw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

---
# Market Structure

.pink[Price elasticity of demand] for a particular firm's product is an important determinant of market structure.

.pull-left[
.center[**Monopolist**]
```{r, echo = FALSE, fig.height = 3.75, fig.width = 3.75, dev = "svg"}
demand <- function(x) 8 - 0.6*x
inv_demand <- function(x) (5/3)*(8 - x)
p_1 <- 7
p_2 <- 6
q_1 <- inv_demand(p_1) 
q_2 <- inv_demand(p_2)
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 10, y = 2.65, color = red_pink, family = "Fira Sans", size = 9) 
```
]
.pull-right[
.center[**Perfectly Competitive Firm**]
```{r, echo = FALSE, fig.height = 3.75, fig.width = 3.75,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "Q", y = "P") +
  geom_hline(yintercept = 5, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 10, y = 5.5, color = red_pink, family = "Fira Sans", size = 9)
```
]

---
# Marginal Revenue

.less-right[
## Definition

> Change in total revenue that arises from a one-unit increase in output.

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "Q", y = "P") +
  geom_hline(yintercept = 7, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 10, y = 7.6, color = red_pink, family = "Fira Sans", size = 9) +
  annotate("text", label = expression(Delta*"TR"=="MR"), x = 4, y = 4, color = green, family = "Fira Sans", size = 4) +
  annotate("text", label = expression(Delta*"Q"==1), x = 4, y = 1.5, color = met_slate, family = "Fira Sans", size = 4) +
  geom_point(aes(x = 3, y = 7), color = met_slate, size = 2) +
  geom_point(aes(x = 5, y = 7), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 5, y = 0, xend = 5, yend = 7), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 1, xend = 5 - 0.1, yend = 1), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = 0, ymax = 7), alpha = 0.2, fill = green)
```
]

---
# Marginal Revenue

.less-right[
For a firm in a perfectly competitive market,

- MR .mono[<=>] D.

- MR .mono[=] P.

]
.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5,  dev = "svg"}
ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = NULL) +
  theme_market +
  labs(x = "Q", y = "P") +
  geom_hline(yintercept = 7, color = green, size = 1) +
  annotate("text", label = expression(MR==P), x = 8, y = 7.6, color = green, family = "Fira Sans", size = 9)
```
]

---
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(8)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost, p), labels = c(8, 12)) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 9)
p_max_1
```
]

.less-right[

**Q:** How does a firm maximize profit?

]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = "Fira Sans", size = 9) 
p_max_1
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 30
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_1
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("8", "$96.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_1
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("8", "$96.00", "$8.00", "$64.00", "")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_1 <- p_max_1 +
  geom_ribbon(aes(x = z, ymin = cost, ymax = p), fill = green, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "Profit", x = q/2, y = (p + cost)/2, color = green, family = "Fira Sans", size = 6) 
p_max_1
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("8", "$96.00", "$8.00", "$64.00", "$32.00")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$12.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_2 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(6)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(7)) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = "Fira Sans", size = 9) 
p_max_2
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("", "\\( \\qquad \\ \\ \\ \\)", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2 <- p_max_2 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
p_max_2
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("6", "$42.00", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("6", "$42.00", "$7.00", "$42.00", "")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_2
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("6", "$42.00", "$7.00", "$42.00", "$0.00")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$7.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 13
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_3 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p, cost), labels = c(5, 8)) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = "Fira Sans", size = 9) 
p_max_3
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("", "", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_3
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("4", "$20.00", "", "", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = q, xend = q, y = p, yend = cost), color = met_slate, linetype = "dashed", size = 1) 
p_max_3
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("4", "$20.00", "$8.00", "$32.00", "\\( \\qquad \\: \\ \\ \\ \\)")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
count: false
# Profit Maximization

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_3 <- p_max_3 +
  geom_ribbon(aes(x = z, ymin = p, ymax = cost), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "Loss", x = q/2, y = (p + cost)/2, color = red_pink, family = "Fira Sans", size = 6) 
p_max_3
```
]

.less-right[

**Q:** How does a firm maximize profit?

**A:** .pink[Pick Q at MR .mono[=] MC.]

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Q", "TR = P &times; Q", "ATC", "TC = ATC &times; Q", "Profit"),
  v2 = c("4", "$20.00", "$8.00", "$32.00", "-$12.00")
) %>% kable(
  escape = F,
  col.names = c("Price (P)", "$5.00"),
  align = c("l", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```
]

---
# Short-Run *vs.* Long-Run Decisions

## Short Run

Cannot avoid fixed costs .mono[-->] ignore them when making production decisions.

- Must pay rent whether business or open or not.

Can avoid paying variable costs.

- Schedule shorter or fewer shifts for workers, buy fewer raw materials, *etc.*

--

Businesses will stay open as long as they can cover their variable costs.

- Variable costs covered .mono[-->] can operate at a loss to defray fixed costs.
- Variable costs not covered .mono[-->] shut down to minimize loss.

---
# Short-Run *vs.* Long-Run Decisions

## Long Run

All costs are variable.

Free exit .mono[-->] businesses can leave the industry.

- *e.g.,* by not renewing the lease.

Free entry .mono[-->] entrepreneurs can join the industry.

---
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

sr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["Shut Down"]), expression(P["Break Even"]))) +
  theme_market +
  labs(x = "Q", y = "$") +
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 5.75, y = 31, color = purple, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = avc, color = orange, size = 1) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = "Fira Sans", size = 9)
sr_conditions 
```
]

.less-right[

**Q:** When does a firm operate? When does it shut down?

]

---
count: false
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions
```
]

.less-right[

**Q:** When does a firm operate? When does it shut down?

**A:** Depends on price.

]

---
count: false
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "Profit", x = 8.35, y = p_zero_profit + 3, color = green, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

**Q:** When does a firm operate? When does it shut down?

**A:** Depends on price.

1. P .mono[>] ATC <br> .mono[-->] .green[Profit.]

]

---
count: false
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "Operating Loss", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank")
```
]

.less-right[

**Q:** When does a firm operate? When does it shut down?

**A:** Depends on price.

1. P .mono[>] ATC <br> .mono[-->] .green[Profit.]

2. ATC .mono[>] P .mono[>] AVC <br> .mono[-->] .pink[Operating loss.]

]

---
count: false
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "Shut Down", x = 8.35, y = p_shut_down - 3, color = orange, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

**Q:** When does a firm operate? When does it shut down?

**A:** Depends on price.

1. P .mono[>] ATC <br> .mono[-->] .green[Profit.]

2. ATC .mono[>] P .mono[>] AVC <br> .mono[-->] .pink[Operating loss.]

3. AVC .mono[>] P <br> .mono[-->] .orange[Shut down.]

]

---
count: false
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
sr_conditions +
  annotate("label", label = "Shut Down", x = 8.35, y = p_shut_down - 3, color = orange, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_shut_down), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "Operating Loss", x = 8.35, y = (p_shut_down + p_zero_profit)/2, color = red_pink, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_shut_down, ymax = p_zero_profit), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "Profit", x = 8.35, y = p_zero_profit + 3, color = green, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

**Q:** When does a firm operate? When does it shut down?

**A:** Depends on price.

1. P .mono[>] ATC <br> .mono[-->] .green[Profit.]

2. ATC .mono[>] P .mono[>] AVC <br> .mono[-->] .pink[Operating loss.]

3. AVC .mono[>] P <br> .mono[-->] .orange[Shut down.]

]

---
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["Shut Down"]), expression(P["Break Even"]))) +
  theme_market +
  labs(x = "Q", y = "$") +
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function(aes(x), fun = atc, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "ATC", x = 5.75, y = 31, color = purple, family = "Fira Sans", size = 9, alpha = 0.5) +
  stat_function(aes(x), fun = avc, color = orange, size = 1, alpha = 0.5) +
  annotate("text", label = "AVC", x = 7.8, y = 31, color = orange, family = "Fira Sans", size = 9, alpha = 0.5) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = "Fira Sans", size = 9, alpha = 0.5) +
  stat_function(aes(x), xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = "Fira Sans", size = 9)
```
]

.less-right[

## .purple[Short-Run Supply]

P .mono[>] P.sub[Shut Down] .mono[-->] short-run supply curve .mono[=] marginal cost curve.

P .mono[<] P.sub[Shut Down] .mono[-->] short-run supply curve .mono[=]  vertical line at 0.

]

---
count: false
# Short-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
avc <- function(x) (12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
avc_min <- 3/2
p_shut_down <- avc(avc_min)
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_shut_down, p_zero_profit), labels = c(expression(P["Shut Down"]), expression(P["Break Even"]))) +
  theme_market +
  labs(x = "Q", y = "$") +
  geom_hline(yintercept = p_shut_down, size = 1, linetype = "dashed", color = met_slate) +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function(aes(x), xlim = c(avc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_shut_down), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = "Fira Sans", size = 9)
```
]

.less-right[

## .purple[Short-Run Supply]

P .mono[>] P.sub[Shut Down] .mono[-->] short-run supply curve .mono[=] marginal cost curve.

P .mono[<] P.sub[Shut Down] .mono[-->] short-run supply curve .mono[=]  vertical line at 0.

]

---
# Sunk Costs

## Definition

> Unrecoverable costs incurred as a result of previous decisions.

--

**Examples:** Fixed costs in the short run, classes you've already completed, the amount of time you've been with the same company, *etc.*

--

**Punchline:** .pink[You should ignore sunk costs when making decisions!]

- **Q:** Why?

--

- **A:** .pink[You must pay them regardless of your choice!]

---
# Long-Run Decisions

**Q:** Should a firm exit or enter the market in the long run?

- Benefit of exiting market .mono[=] cost savings .mono[=] TC.

- Cost of exiting market .mono[=] revenue loss .mono[=] TR.
    
--

**A:** Exit if TC .mono[>] TR, enter if TC .mono[<] TR.

---
# Long-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

lr_conditions <- ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["Break Even"]))) +
  theme_market +
  labs(x = "Q", y = "$") +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "LRATC", x = 6.9, y = 25, color = purple, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = "Fira Sans", size = 9)
lr_conditions 
```
]

.less-right[

**Q:** When does a firm operate? When does it exit?

]

---
count: false
# Long-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions 
```
]

.less-right[

**Q:** When does a firm operate? When does it exit?

**A:** Depends on price.

]

---
count: false
# Long-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "Profit", x = 8.35, y = p_zero_profit + 3, color = green, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

**Q:** When does a firm operate? When does it exit?

**A:** Depends on price.

1. P .mono[>] ATC <br> .mono[-->] .green[Profit.]

]

---
count: false
# Long-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "Exit", x = 8.35, y = p_zero_profit - 3, color = orange, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank")
```
]

.less-right[

**Q:** When does a firm operate? When does it exit?

**A:** Depends on price.

1. P .mono[>] ATC <br> .mono[-->] .green[Profit.]

2. ATC .mono[>] P <br> .mono[-->] .orange[Exit.]

]

---
count: false
# Long-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
lr_conditions +
  annotate("label", label = "Exit", x = 8.35, y = p_zero_profit - 3, color = orange, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = 0, ymax = p_zero_profit), fill = orange, alpha = 0.2, linetype = "blank") +
  annotate("label", label = "Profit", x = 8.35, y = p_zero_profit + 3, color = green, family = "Fira Sans", size = 5, hjust = 1) +
  geom_ribbon(aes(x = x, ymin = p_zero_profit, ymax = 32.5), fill = green, alpha = 0.2, linetype = "blank")
```
]

.less-right[

**Q:** When does a firm operate? When does it exit?

**A:** Depends on price.

1. P .mono[>] ATC <br> .mono[-->] .green[Profit.]

2. ATC .mono[>] P <br> .mono[-->] .orange[Exit.]

]

---
# Long-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["Break Even"]))) +
  theme_market +
  labs(x = "Q", y = "$") +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function(aes(x), fun = atc, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = "LRATC", x = 6.9, y = 25, color = purple, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = "MC", x = 3.5, y = 31, color = red_pink, family = "Fira Sans", size = 9, alpha = 0.5) +
  stat_function(aes(x), xlim = c(atc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "longdash") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "longdash", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = "Fira Sans", size = 9)
```
]

.less-right[

## .purple[Long-Run Supply]

P .mono[>] P.sub[Break Even] .mono[-->] long-run supply curve <br> .mono[=] marginal cost curve.

P .mono[<] P.sub[Break Even] .mono[-->] long-run supply curve <br> .mono[=]  vertical line at 0.

]

---
# Long-Run Decisions

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 9, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
atc_min <- 3
p_zero_profit <- atc(atc_min)

ggplot() +
  scale_x_continuous(limits = c(0, 8.5), expand=c(0,0), breaks = NULL) +
  scale_y_continuous(limits = c(0, 32.5), expand=c(0,0), breaks = c(p_zero_profit), labels = c(expression(P["Break Even"]))) +
  theme_market +
  labs(x = "Q", y = "$") +
  geom_hline(yintercept = p_zero_profit, size = 1, linetype = "dashed", color = met_slate) +
  stat_function(aes(x), xlim = c(atc_min, 8.5), fun = marginal_cost, color = purple, size = 1.5, linetype = "solid") +
  geom_segment(aes(x = 0.05, xend = 0.05, y = 0, yend = p_zero_profit), color = purple, linetype = "solid", size = 1.5) +
  annotate("text", label = "S", x = 3.5, y = 28, color = purple, family = "Fira Sans", size = 9)
```
]

.less-right[

## .purple[Long-Run Supply]

P .mono[>] P.sub[Break Even] .mono[-->] long-run supply curve <br> .mono[=] marginal cost curve.

P .mono[<] P.sub[Break Even] .mono[-->] long-run supply curve <br> .mono[=]  vertical line at 0.

]

---
class: clear-slide

**Q:** Assume that AVC .mono[<] $3. Is this firm earning a profit or operating at a loss? 

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 14
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

p_max_4 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(30)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p, cost), labels = c(3, 5)) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 9) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = "Fira Sans", size = 9) +
  geom_point(aes(x = q, y = cost), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q, y = cost, yend = cost), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = q, xend = q, y = p, yend = cost), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
p_max_4
```
]

.less-right[

> **A.** Earning a profit.

> **B.** Operating at a loss.

> **C.** Neither.

]

---
count: false
class: clear-slide

**Q:** Assume that AVC .mono[<] $3. Is this firm earning a profit or operating at a loss? 

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_4 <- p_max_4 +
  geom_ribbon(aes(x = z, ymin = p, ymax = cost), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "Loss", x = q/2, y = (p + cost)/2, color = red_pink, family = "Fira Sans", size = 6) 
p_max_4
```
]

.less-right[

> **A.** Earning a profit.

> .pink[**B.** Operating at a loss.]

> **C.** Neither.

]

---
class: clear-slide

**Q:** Assume that AVC .mono[<] $3. How much money is this firm losing?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_4
```
]

.less-right[

> **A:** 

]

---
count: false
class: clear-slide

**Q:** Assume that AVC .mono[<] $3. How much money is this firm losing?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_4
```
]

.less-right[

> **A:** .pink[$60.]

]

---
count: false
class: clear-slide

**Q:** Assume that AVC .mono[<] $3. How much money is this firm losing?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_4
```
]

.less-right[

> **A:** .pink[$60.]

.pink[Loss .mono[=] (ATC - P) &times; Q]

]

---
class: clear-slide

**Q:** What will this firm do in the long run?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_4
```
]

.less-right[

> **A.** Earn positive profits.

> **B.** Operate at a loss.

> **C.** Exit the market.

> **D.** `r emo::ji("shrug")`.

]

---
count: false
class: clear-slide

**Q:** What will this firm do in the long run?

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
p_max_4
```
]

.less-right[

> **A.** Earn positive profits.

> **B.** Operate at a loss.

> .pink[**C.** Exit the market.]

> **D.** `r emo::ji("shrug")`.

]

---
# Competitive Markets

**Q:** How do we understand the consequences of the decisions of many firms on market outcomes?

**A:** Construct a market supply curve.

- Market supply .mono[=] sum of individual supply curves.

---
# Competitive Markets

## Conditions

1. Many buyers and sellers.

2. Identical, undifferentiated products.

3. Free entry and exit.

    - *e.g.,* same technology available to all firms.

4. Each firm is small relative to the market.

5. Input prices to industry do not change as the market expands.

---
# Competitive Markets

## Results

Conditions 1 through 4 .mono[==>] each firm is a price-taker.

Conditions 1 through 5 .mono[==>] perfectly elastic long-run market supply curve.

---
# Competitive Markets

## Intuition

**Case 1:** Short-run price .mono[>] long-run price. 

- Firms make a profit <br> .mono[-->] entrepreneurs see that they can make a profit, too <br> .mono[-->] number of firms increases <br> .mono[-->] short-run supply shifts right <br> .mono[-->] short-run price falls.

---
# Competitive Markets

## Intuition

**Case 2:** Short-run price .mono[<] long-run price.

- Firms operate at a loss (or shut down) <br> .mono[-->] firms exit market <br> .mono[-->] number of firms decreases <br> .mono[-->] short-run supply shifts left <br> .mono[-->] short-run price rises.

---
# Long-Run Equilibrium
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[Firm]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(expression(Q[Market]))) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(expression(P[LR]))) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("Minimum of ATC"),
  v2 = c("Q that minimizes ATC"),
  v3 = c("Q.sub[Firm] &times; N.sub[Firms]"),
  v4 = c("Q.sub[Market] &divide; Q.sub[Firm]")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[Firm]", "Q.sub[Market]", "N.sub[Firms]"),
  align = c("c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
# Long-Run Equilibrium
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
cost <- atc(q)
z <- seq(0, q, 0.001)

firm_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c(5)) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = "MR", x = 7, y = p - 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
firm_1
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
p <- supply(q)

market_1 <- ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c(5)) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = "S", x = 6, y = 32, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1) +
  annotate("text", label = "D", x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("$5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c("")
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[Firm]", "Q.sub[Market]", "N.sub[Firms]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
count: false
# Long-Run Equilibrium
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
firm_1
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.75, dev = "svg"}
market_1
```
]
```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("$5.00"),
  v2 = c(4),
  v3 = c(3000),
  v4 = c(750)
) %>% kable(
  escape = F,
  col.names = c("P.sub[LR]", "Q.sub[Firm]", "Q.sub[Market]", "N.sub[Firms]"),
  align = c("c", "c", "c", "c", "c", "c")
) %>%
  kable_styling(full_width = T) 
tab 
```

---
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  # scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function(aes(x), fun = marginal_revenue_2, color = green, size = 1) +
  # annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = "Fira Sans", size = 6) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  # 
  # geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  # annotate("text", label = "Loss", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = "Fira Sans", size = 5) 
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  # scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  # annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  # geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  # geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[Firm]", "Q.sub[Market]", "N.sub[Firms]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("", "", "", ""),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("Equilibrium", "Initial", "New Short-Run", "New Long-Run"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

---
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) 
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q), labels = c(4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(cost), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q), labels = c(3000)) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1)
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
count: false
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function(aes(x), fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "Loss", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = "Fira Sans", size = 5)
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1)

```
]

---
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the short run*?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[Firm]", "Q.sub[Market]", "N.sub[Firms]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("$3.00", 3, 2250, 750),
  v4 = c("", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("Equilibrium", "Initial", "New Short-Run", "New Long-Run"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

**A.sub[1]:** .pink[Farmers reduce production .mono[-->] market quantity supplied decreases.]

**A.sub[2]:** .pink[Farmers operate at a loss in the short run.]

---
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the long run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function(aes(x), fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "Loss", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = "Fira Sans", size = 5)
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_2, q), labels = c(2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1) #+
  
  # stat_function(aes(x), fun = supply_2, color = purple, size = 1) +
  # annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  # geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  # geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1) 
```
]

---
count: false
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the long run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[1]), x = 7, y = p + 2, color = green, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  
  stat_function(aes(x), fun = marginal_revenue_2, color = green, size = 1) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1) +

  geom_ribbon(aes(x = z, ymin = p_2, ymax = cost_2), fill = red_pink, alpha = 0.2, linetype = "blank") +
  annotate("text", label = "Loss", x = q_2/2, y = (p_2 + cost_2)/2, color = red_pink, family = "Fira Sans", size = 5)
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6, alpha = 0.5) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
count: false
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the long run*?
.pull-left[
.center[**Firm**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 8, 0.1)
atc <- function(x) (18 + 12*x - 2*x^2 + (2/3)*x^3)/x
marginal_cost <- function(x) 12 - 4*x + 2*x^2
marginal_revenue <- function(x) 18
marginal_revenue_2 <- function(x) 12.04
q <- uniroot(function(x) marginal_revenue(x) - marginal_cost(x), range(x))$root
q_2 <- uniroot(function(x) marginal_revenue_2(x) - marginal_cost(x), range(x))$root
p <- marginal_revenue(1)
p_2 <- marginal_revenue_2(1)
cost <- atc(q)
cost_2 <- atc(q_2)
z <- seq(0, q_2, 0.001)

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = c(q_2, q), labels = c(3, 4)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(12.04, cost, cost_2), labels = c("3.00", "5.00", "5.25")) +
  theme_market +
  labs(x = "Q", y = "$") +
  stat_function(aes(x), fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 6.5, y = 35, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 1, y = 8, color = red_pink, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = marginal_revenue, color = green, size = 1) +
  annotate("text", label = expression(MR[1]==MR[3]), x = 6.1, y = p + 2, color = green, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q, y = p), color = met_slate, size = 2) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = p), color = met_slate, linetype = "dashed", size = 1) +
  
  stat_function(aes(x), fun = marginal_revenue_2, color = green, size = 1, alpha = 0.5) +
  annotate("text", label = expression(MR[2]), x = 7, y = p_2 - 2, color = green, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_point(aes(x = q_2, y = cost_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = p_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = cost_2, yend = cost_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5)
```
]
.pull-right[
.center[**Market**]
```{r, echo = FALSE, fig.height = 4.5, fig.width = 3.75, dev = "svg"}
x <- seq(0, 7, 0.1)
demand <- function(x) 36 - 6*x
demand_2 <- function(x) 21.1 - 6*x
supply <- function(x) 6 + 4*x
supply_2 <- function(x) 15 + (14/15) + 4*x
lr_supply <- function(x) 18
q <- uniroot(function(x) demand(x) - supply(x), range(x))$root
q_2 <- uniroot(function(x) demand_2(x) - supply(x), range(x))$root
q_3 <- uniroot(function(x) demand_2(x) - supply_2(x), range(x))$root
p <- supply(q)
p_2 <- supply(q_2)
p_3 <- supply_2(q_3)

ggplot() +
  scale_x_continuous(limits = c(0, 6.5), expand=c(0,0), breaks = c(q_3, q_2, q), labels = c(500, 2250, 3000)) +
  scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(p_2, lr_supply(q)), labels = c("3.00", "5.00")) +
  # scale_y_continuous(limits = c(0, 37.5), expand=c(0,0), breaks = c(lr_supply(q)), labels = c("5.00")) +
  theme_market +
  labs(x = "Q", y = "P") +
  stat_function(aes(x), fun = supply, color = purple, size = 1, alpha = 0.5) +
  annotate("text", label = expression(S[1]), x = 6, y = 32.5, color = purple, family = "Fira Sans", size = 6, alpha = 0.5) +
  stat_function(aes(x), fun = lr_supply, color = purple, size = 1) +
  annotate("text", label = expression(S[LR]), x = 6, y = lr_supply(q) - 2, color = purple, family = "Fira Sans", size = 6) +
  stat_function(aes(x), fun = demand, color = red_pink, size = 1, alpha = 0.5) +
  annotate("text", label = expression(D[1]), x = 6, y = 3, color = red_pink, family = "Fira Sans", size = 6, alpha = 0.5) +
  geom_point(aes(x = q, y = lr_supply(q)), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q, xend = q, y = 0, yend = lr_supply(q)), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = demand_2, color = red_pink, size = 1) +
  annotate("text", label = expression(D[2]), x = 3.5, y = 3, color = red_pink, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_2, y = p_2), color = met_slate, size = 2, alpha = 0.5) +
  geom_segment(aes(x = q_2, xend = q_2, y = 0, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  geom_segment(aes(x = 0, xend = q_2, y = p_2, yend = p_2), color = met_slate, linetype = "dashed", size = 1, alpha = 0.5) +
  stat_function(aes(x), fun = supply_2, color = purple, size = 1) +
  annotate("text", label = expression(S[2]), x = 3.5, y = 32.5, color = purple, family = "Fira Sans", size = 6) +
  geom_point(aes(x = q_3, y = p_3), color = met_slate, size = 2) +
  geom_segment(aes(x = q_3, xend = q_3, y = 0, yend = p_3), color = met_slate, linetype = "dashed", size = 1)
```
]

---
class: clear-slide
**Q:** A newfound taste for gluten-free diets decreases demand for wheat. How do wheat farmers adjust *in the long run*?

```{R, echo = F, escape = F}
tab <- data.frame(
  v1 = c("P", "Q.sub[Firm]", "Q.sub[Market]", "N.sub[Firms]"),
  v2 = c("$5.00", 4, 3000, 750),
  v3 = c("$3.00", 3, 2250, 750),
  v4 = c("$5.00", 4, 500, 125)
) %>% kable(
  escape = F,
  col.names = c("Equilibrium", "Initial", "New Short-Run", "New Long-Run"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(full_width = T) %>% 
  row_spec(1:3, extra_css = "line-height: 110%;")
tab 
```

**A:** .pink[Farmers exit until economic profit returns to 0 .mono[-->] market supply falls.]


---
class: inverse, middle

# Practice

---
class: clear-slide

**Q:** Which of the following is not a characteristic of a perfectly competitive market?

> **A.** Firms produce a homogenous product.

> **B.** Sellers have better information about the product than consumers.

> **C.** There is a large number of buyers and sellers.

> **D.** Firms earn zero profit.

> **E.** Firms can easily enter or exit the industry.

---
coun: false
class: clear-slide

**Q:** Which of the following is not a characteristic of a perfectly competitive market?

> **A.** Firms produce a homogenous product.

> .pink[**B.** Sellers have better information about the product than consumers.]

> **C.** There is a large number of buyers and sellers.

> **D.** Firms earn zero profit.

> **E.** Firms can easily enter or exit the industry.

---
class: clear-slide

**Q:** Which of the following provides the closest example of a perfectly competitive market?

> **A.** Market for cars.

> **B.** Market for bread.

> **C.** Market for handmade soaps.

> **D.** Market for athletic shoes.

> **E.** Market for newspapers.

---
count: false
class: clear-slide

**Q:** Which of the following provides the closest example of a perfectly competitive market?

> **A.** Market for cars.

> .pink[**B.** Market for bread.]

> **C.** Market for handmade soaps.

> **D.** Market for athletic shoes.

> **E.** Market for newspapers.

---
class: clear-slide

**Q:** What should a firm do when marginal revenue is greater than marginal cost?

> **A.** Increase the level of output until price is equal to average variable cost.

> **B.** Stop producing.

> **C.** Stay at the same level of output.

> **D.** Reduce the level of output.

> **E.** Increase the level of output.

---
count: false
class: clear-slide

**Q:** What should a firm do when marginal revenue is greater than marginal cost?

> **A.** Increase the level of output until price is equal to average variable cost.

> **B.** Stop producing.

> **C.** Stay at the same level of output.

> **D.** Reduce the level of output.

> .pink[**E.** Increase the level of output.]









