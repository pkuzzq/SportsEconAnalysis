---
title: "体育经济分析：原理与应用"
subtitle: "第⼀讲：概要与预备知识"
author: 
   - 周正卿
date: "`r format(Sys.time(), '%d %B %Y')`"
# xaringan模板
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: yes
      countIncrementalSlides: yes
      ratio: '16:10.85'
    seal: true
    lib_dir: libs
  html_document:
    keep_md: yes

knit: pagedown::chrome_print

# beamer模板

# mainfont: Times New Roman
# fontsize: 10pt
# output: 
#   beamer_presentation: 
#     fonttheme: structurebold
#     theme: Madrid
#     colortheme: lily
#     includes:
#         in_header: "../beamer_header.tex"
#     df_print: tibble
#     latex_engine: xelatex

---
class: center, middle, inverse

```{R, setup, include = F}
# devtools::install_github("dill/emoGG")
library(pacman)
p_load(
  broom, tidyverse,
  ggplot2, ggthemes, ggforce, ggridges,
  latex2exp, viridis, extrafont, gridExtra,
  kableExtra, snakecase, janitor,
  data.table, dplyr, estimatr,
  lubridate, knitr, parallel,
  lfe,dslabs,
  here, magrittr, RcmdrPlugin.KMggplot2
)

options(htmltools.dir.version = FALSE)

# Notes directory
dir_slides <- "/Users/zhouzhengqing/Desktop/SportsEconAnalysis/SportsEconAnalysis_2023/Lec03/"
# Define pink color
red_pink <- "#e64173"
turquoise <- "#20B2AA"
orange <- "#FFA500"
red <- "#fb6107"
blue <- "#3b3b9a"
green <- "#8bb174"
grey_light <- "grey70"
grey_mid <- "grey50"
grey_dark <- "grey20"
purple <- "#6A5ACD"
slate <- "#314f4f"
met_slate <- "#272822" # metropolis font color 

# Dark slate grey: #314f4f

# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  warning = F,
  message = F
)
opts_chunk$set(dev = "svg")
options(device = function(file, width, height) {
  svg(tempfile(), width = width, height = height)
})
options(crayon.enabled = F)
options(knitr.table.format = "html")
# A blank theme for ggplot
theme_empty <- theme_bw() + theme(
  line = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  plot.margin = structure(c(0, 0, -0.5, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_simple <- theme_bw() + theme(
  line = element_blank(),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text.x = element_text(size = 18, family = "STIXGeneral"),
  axis.text.y = element_blank(),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  # plot.margin = structure(c(0, 0, -1, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_math <- theme_void() + theme(
  text = element_text(family = "MathJax_Math"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_serif <- theme_void() + theme(
  text = element_text(family = "MathJax_Main"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes <- theme_void() + theme(
  text = element_text(family = "Fira Sans Book"),
  axis.title = element_text(size = 18),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = grey_light,
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_market <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.title.x = element_text(hjust = 1, size = 17),
  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),
  # axis.text.x = element_text(size = 12),
  # axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_gif <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  text = element_text(family = cnfont, color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_goods <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 17, family = cnfont), 
  axis.text.x = element_text(size = 17),
  axis.text.y = element_text(size = 17, angle = 90, hjust = 0.5),
  axis.title.x = element_text(color = purple, size = 19),
  axis.title.y = element_text(color = red_pink, size = 19),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
theme_game <- theme_bw() + theme(
  axis.line = element_line(),
  panel.grid = element_blank(),
  rect = element_rect(size = 1),
  strip.text = element_blank(),
  text = element_text(size = 20, family = cnfont), 
  axis.text.x = element_text(size = 20, color = met_slate),
  axis.text.y = element_text(size = 20, angle = 90, color = met_slate, hjust = 0.5),
  axis.title.x = element_text(color = met_slate, size = 20),
  axis.title.y = element_text(color = met_slate, size = 20),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
shift_axis <- function(p, y=0){
  g <- ggplotGrob(p)
  dummy <- data.frame(y=y)
  ax <- g[["grobs"]][g$layout$name == "axis-b"][[1]]
  p + annotation_custom(grid::grobTree(ax, vp = grid::viewport(y=1, height=sum(ax$height))), 
                        ymax=y, ymin=y) +
    geom_hline(aes(yintercept=y), data = dummy, size = 0.5, color = met_slate) +
    theme(axis.text.x = element_blank(), 
          axis.ticks.x = element_blank())
}
wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = "\n")
# functions
demand <- function(x) 10 - x
demand_2 <- function(x) 9 - x
demand_3 <- function(x) 8 - x
demand_inc <- function(x) 11 - x
demand_dec <- function(x) 5 - x
supply <- function(x) 1 + (4/5)*x
step_demand <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8), mv = c(8, 7, 6, 5, 4, 3, 2, 1, 0))
step_demand2 <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(10, 10, 9, 9, 8, 8, 7, 7, 6, 6, 5, 4, 4))
step_supply <- tibble(x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), mv = c(2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 8, 8))
step_supply_tax <- step_supply %>% 
  mutate(mv = mv + 2)
# 
# data <- read_csv("/Users/zhouzhengqing/Desktop/SportsEconAnalysis-master/05_MicroeconBasics2/Activity_Pit_Market/Results.csv") %>% 
#   dplyr::filter(!is.na(price))

theme_set(theme_gray(base_size = 20))
# Column names for regression results
reg_columns <- c("Term", "Est.", "S.E.", "t stat.", "p-Value")
# Function for formatting p values
format_pvi <- function(pv) {
  return(ifelse(
    pv < 0.0001,
    "<0.0001",
    round(pv, 4) %>% format(scientific = F)
  ))
}
format_pv <- function(pvs) lapply(X = pvs, FUN = format_pvi) %>% unlist()
# Tidy regression results table
tidy_table <- function(x, terms, highlight_row = 1, highlight_color = "black", highlight_bold = T, digits = c(NA, 3, 3, 2, 5), title = NULL) {
  x %>%
    tidy() %>%
    select(1:5) %>%
    mutate(
      term = terms,
      p.value = p.value %>% format_pv()
    ) %>%
    kable(
      col.names = reg_columns,
      escape = F,
      digits = digits,
      caption = title
    ) %>%
    kable_styling(font_size = 20) %>%
    row_spec(1:nrow(tidy(x)), background = "white") %>%
    row_spec(highlight_row, bold = highlight_bold, color = highlight_color)
}
```

```{css, echo = F, eval = T}
@media print {
  .has-continuation {
    display: block !important;
  }
}
```

# 供给：成本衍生的生产决策

---
## 大纲

.hi[目标] 生产者理论的分析路线（高级）

- 生产者如何决策？要素、技术、定价能力
- 供给曲线从何而来？

.hi[问题:] 为什么要深入厂商理论？

.hi[答案:] 对理解职业球队决策、职业联盟市场结构与规制有帮助 


---
layout: false
## 生产决策

.less-right[生产决策是每个职业球队会应用的。职业联盟是由多球队构成，球队行为决定了联盟竞争程度。

- .hi.orange[成本线：生产成本、生产技术、厂商决策]

- 收入线：定价能力、市场结构
]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="530">

]

---
### 利润最大化目标

- 长期内，所有球队都以利润最大化为目标，否则就会被市场淘汰。

- 但短期呢？

- 利润 .mono[=]总收入 .mono[-] 总成本

- 在短期内，由于所有者(董事长)与经营者（总经理）分离，可能会在一定程度上偏离企业利润最大化的目标，而追求其他利益的目标（个人享受，政治特权，社会知名度等）。

<br>
**问：**体育领域是否所有产权主体都试图实现利润最大化？

**答：** 未必。升降级制的联赛俱乐部(为生存，先求胜)；国际体育NGO(国际政治)。

---
### 利润最大化

为了实现利润最大化，厂商必须回答的几个问题:

- 应该生产多少？

- 应该设定什么价格？

- 应该投入多少生产要素。雇佣劳动力？购买资本？

- 应该继续生产还是停产？

---
### 利润最大化

对这些问题的回答取决于 

1. 生产技术 .mono[-->] 成本结构(资本密集、技术密集、劳动密集)

2. 市场结构 .mono[-->] 单个企业的定价能力

3. 短期 *vs.* 长期

---
class: inverse, middle

# 生产成本

---
### 成本

- 稀缺性  .mono[->] 机会成本。生产成本应从机会成本来理解。

- 总成本.mono[=] .purple[显成本] .mono[+] .pink[隐成本]

### .purple[显成本]

- *一般是* 工资、租金、原材料、维修费、缴纳税款, *等*

### .pink[隐成本]

- 丧失的次优投资品价值，例如，*等额的固定资产投入，在股票市场的回报*等等。

---

### 例子：给你100万去投资，该如何选？

启动资金是100万，利息是5%。

.pink[投资方案1：]借100万

- 显成本 .mono[=] 5万

.pink[投资方案2：]动用40万的储蓄，借60万

- 显成本 .mono[=] 3万 .mono[<--] 偿还5%的贷款利息

- 隐成本 .mono[=] 2万 .mono[<--] 从储蓄中拿出40万RMB，放弃5%的利息

.pink[任一方案的总成本 .mono[=] 5万]

---
###  会计利润 *vs.* 经济利润 

#### 会计利润 <br> $\quad$ .mono[=] 总收入 .mono[-] .pink[显成本]

#### 经济利润 <br> $\quad$ .mono[=] 总收入 .mono[-] (.pink[显成本] .mono[+] .purple[隐成本])  <br> $\quad$ .mono[=] 会计利润 .mono[-] .purple[隐成本]

**重要** 

.center[
## 会计利润 .mono[>] 经济利润
]

所以一家仍赚钱的公司，并不总是意味着一家公司做得很好

---
### 生产技术

经济中的生产技术，是指的投入要素的组合方式。一般要素：土地、劳动力、资本、技术（有时候以人力资本的形式表达）、数据。

数学上，用.hi.pink[生产函数]来反映：对企业生产过程中投入和产出之间关系的数学描述。

.center[
.hi.pink[要素投入 .mono[-->]  生产技术 .mono[-->] 产出方式]
] 

---
### 总产量函数

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "TP") +
  stat_function(fun = total_product, color = purple, size = 1)
```
]

.less-right[
#### 定义

> 一定数量的要素投入对应的产量

假设生产函数 $TP=f(L, K)$ ，其中在一定时期内 $K$ 的数量固定，所以厂商要改变产量就只能改变 $L$ 。这种单可变要素的生产函数称为**短期生产函数**
$TP=f(L, \bar{K})$ 
]

---
count: false
### 总产量的三个阶段

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 

ggplot() +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) + 
   theme_market +
  labs(x = "L", y = "TP") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速度递增", 15), x = 2.67/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速度递增", 15), x = (2.67 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 15), x = (7.5 + 5.68)/2, y = 58.5, color = purple, family = cnfont, size = 4) +
  geom_ribbon(aes(x = z, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank") + # PS
  geom_ribbon(aes(x = u, ymin = 0, ymax = 65), fill = purple, alpha = 0.2, linetype = "blank")
```
]

.less-right[
#### 定义

> 一定数量的要素投入对应的产量

**例子：**假设生产函数 $TP=f(L, K)$ ，其中在一定时期内 $K$ 的数量固定，所以厂商要改变产量就只能改变 $L$ 。这种单可变要素的生产函数称为**短期生产函数**
$TP=f(L, \bar{K})$ 
]
---
### 边际产量

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
total_product <- function(x) 3*x - 0.5*x^3 + 4*x^2 
q_1 <- total_product(3)
q_2 <- total_product(4)

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(0,7,1)) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = seq(0,60,10)) +
  theme_market +
  labs(x = "L", y = "TP") +
  stat_function(fun = total_product, color = purple, size = 1) +
  geom_point(aes(x = 3, y = q_1), color = met_slate, size = 2) +
  geom_point(aes(x = 4, y = q_2), color = met_slate, size = 2) +
  geom_segment(aes(x = 3, y = 0, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 4, y = 0, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_1, xend = 3, yend = q_1), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 0, y = q_2, xend = 4, yend = q_2), linetype  = "dashed", color = met_slate, size = 1) +
  geom_segment(aes(x = 3 + 0.1, y = 10, xend = 4 - 0.1, yend = 10), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  geom_segment(aes(x = 0.5, y = q_1 + 0.75, xend = 0.5, yend = q_2 - 0.75), arrow = arrow(angle = 20, length = unit(0.4,"cm"), type = "closed"), color = met_slate, size = 1) +
  annotate("text", label = expression(Delta*"TP"=="边际产量"), x = 2, y = (q_1 + q_2)/2, color = met_slate, family = cnfont, size = 4) +
  annotate("text", label = expression(Delta*"L"==1), x = 3.5, y = 7.5, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
#### 定义

> 增加一单位可变要素劳动投入量所增加的产量

**例子:** 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
count: false
### 边际产量

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) 

shift_axis(mp1)
```
]

.less-right[
#### 定义

> 增加一单位可变要素劳动投入量所增加的产量

**例子:** 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
count: false
### 边际产量

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
z <- seq(0, 2.67, 0.01)
w <- seq(2.67, 5.68, 0.01)
u <- seq(5.68, 7.5, 0.01)
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  geom_vline(xintercept = 5.68, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("加速递增", 22), x = 2.67/2 - 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("减速递增", 22), x = (2.67 + 5.68)/2 + 0.0, y = 14.75, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("总产量下降", 22), x = (7.5 + 5.68)/2, y = 14.75, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.less-right[
#### 定义

> 增加一单位可变要素劳动投入量所增加的产量

**例子:** 保持技术水平不变,保持其他要素（资本）投入不变，只改变劳动力投入

]

---
### 边际产量递减规律

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- 0:10
marginal_product <- function(x) 3 + 8*x - 1.5*x^2

mp1 <- ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 7.5), expand=c(0,0), breaks = seq(1,7,1)) +
  scale_y_continuous(limits = c(-6, 16), expand=c(0,0), breaks = seq(-5,15,5)) +
  theme_market +
  #geom_hline(yintercept = 0, color = met_slate, size = 0.5) + 
  labs(x = "L", y = "MP") +
  stat_function(fun = marginal_product, color = purple, size = 1) +
  theme(axis.line.x = element_blank(),
        axis.title.x = element_text(hjust = 1, vjust = 21, size = 17)) +
  geom_vline(xintercept = 2.67, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = wrapper("边际产量上升", 18), x = 2.67/2 - 0.0, y = 14.85, color = purple, family = cnfont, size = 4) +
  annotate("label", label = wrapper("边际产量下降", 18), x = (2.67 + 7.5)/2 + 0.0, y = 14.85, color = purple, family = cnfont, size = 4)

shift_axis(mp1)
```
]

.less-right[
#### 解释

当在其他投入数量固定的情况下，只有一种要素投入时.purple[边际产品最终为负]。

]
---
### 总产量、平均产量和边际产量的关系

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
第一阶段，**边际产量始终大于平均产量**：
- 投入量**在0到L1**之间，平均产量始终上升，达到最大值Max；
- 边际产量上升，达到最大值后并开始下降
- 这一阶段总产量始终是增加的。这说明：在这一阶段不变要素的投入量是相对过剩，生产者追加**可变要素（比如劳动）投入量**有利可图。
]
---
count: false

### 总产量、平均产量和边际产量的关系

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
第二阶段，截止到**边际产量等于零**：
- 继续追加要素在**L1到L2**
- **平均产量曲线和边际产量曲线相交**，即平均产量达到最高点。
]
---
count: false

### 总产量、平均产量和边际产量的关系

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
第三阶段，**总产量也呈现下降**：
- 投入量**超过L2**，**平均产量下降**，**边际产量为负**。
- 这一阶段减少可变要素投入是有利的。
]

---
count: false

### 生产阶段的决策

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/oBpv6y.png  height="390" width="500" >
]

.less-right[
- 理性的生产者既不会将生产停留在第一阶段，也不会将生产扩张到第三阶段。
- 因此第二阶段是生产者进行短期生产的决策区间。
**至于在第二阶段的哪一点才能达到利润最大化，需要结合成本、收入和利润进行深入分析**。
]

---
### 自学时间：MP 对 AP 影响的数学表达

设 $T P=Q=f(L) ; A P_{L}=T P / L$，
$L$ 的平均产量对 $L$ 投入的变化率 :


$\frac{d A P_{L}}{d L}=\frac{d(T P / L)}{d L}=\frac{d(Q / L)}{d L}=\frac{\frac{d Q}{d L} L-\frac{d L}{d L} Q}{L^{2}}$


$=\frac{\frac{d Q}{d L} L-Q}{L^{2}}=\frac{1}{L}(\underbrace{\frac{d Q}{d L}}_{M P_{L}}-\underbrace{\frac{Q}{L}}_{A P_{L}})$


- 当 $M P_{L}>A P_{L}, A P_{L}$ 处于递增阶段
- 当 $M P_{L}<A P_{L}, A P_{L}$ 处于递减阶段
- 当 $M P_{L}=A P_{L}, A P_{L}$ 达到最大值

---
layout: false
## 生产决策

.less-right[即使我们知道企业会继续在第二阶段选择生产，那么什么决定了产量多少？

- .hi.orange[成本线：生产成本、生产技术、厂商决策]

- 收入线：定价能力、市场结构
]

.more-left[
<img src=https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/atpI5Q.png  height="350" width="530">

]
---
### 理性人在边际处行动：边际收益与边际成本的比较

- 利润角度 .mono[->] 只要能增加利润，就会生产
- 利润只有收入和成本两部分
- Max 利润 .mono[->] 边际收益MR=边际成本MC

然而，边际收益（MR）就是边际产量*销售价格。

已知：边际产量、平均产量和总产量的关系

那么就差边际成本了？
- 参照着总产量到边际产量的分析思路，接着看边际成本是怎样的？

---
class: clear-slide
### 自学时间：一个例子理解总成本
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("", "", "", "", "", ""),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
### 自学时间：一个例子理解总成本
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("￥1000", "￥1000", "￥1000", "￥1000", "￥1000", "￥1000"),
  v4 = c("", "", "", "", "", ""),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
### 自学时间：一个例子理解总成本
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("￥1000", "￥1000", "￥1000", "￥1000", "￥1000", "￥1000"),
  v4 = c("￥0", "￥2000", "￥4000", "￥6000", "￥8000", "￥10000"),
  v5 = c("", "", "", "", "", "")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```

---
count: false
class: clear-slide
### 自学时间：一个例子理解总成本
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

```{R, echo = F, escape = F}
data.frame(
  v1 = c(0, 1, 2, 3, 4, 5),
  v2 = c(0, 1000, 1800, 2400, 2800, 3000),
  v3 = c("￥1000", "￥1000", "￥1000", "￥1000", "￥1000", "￥1000"),
  v4 = c("￥0", "￥2000", "￥4000", "￥6000", "￥8000", "￥10000"),
  v5 = c("￥1000", "￥3000", "￥5000", "￥7000", "￥9000", "￥11000")
) %>% kable(
  escape = F,
  col.names = c("工人 (L)", "西瓜 (Q)", "土地的成本", "劳动力的成本", "Total Cost"),
  align = c("c", "c", "c", "c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```
---
class: clear-slide
### 自学时间：一个例子理解总成本
.pink.hi[投入：]土地.mono[-->]必须每月支付1000元的租金，无论种植多少西瓜。

.pink.hi[投入：]劳动力.mono[-->] 市场工资为每月2000元。

.center[.purple[**TC曲线**]]

.pull-left[
```{R, echo = F, escape = F}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c("￥1000", "￥3000", "￥5000", "￥7000", "￥9000", "￥11000")
) 
cost_data %>% 
  kable(
  escape = F,
  col.names = c("西瓜 (Q)", "Total Cost"),
  align = c("c", "c")#,
) %>%
row_spec(1:6, color = met_slate) %>%
row_spec(1:6, extra_css = "line-height: 110%;")
```
]

.pull-right[
```{r, echo = FALSE, fig.height = 3.25, fig.width = 4.25, dev = "svg"}
cost_data <- data.frame(
  q = c(0, 1000, 1800, 2400, 2800, 3000),
  tc = c(1000, 3000, 5000, 7000, 9000, 11000)
) 
cost_data %>% 
  ggplot(aes(x = q, y = tc)) +
  scale_x_continuous(limits = c(0, 3500)) +
  scale_y_continuous(limits = c(0, 12000), expand=c(0, 0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "TC") +
  geom_point(size = 2, color = purple) +
  geom_line(size = 1, color = purple)
```
]

---
### S型总成本曲线

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "TC") +
  stat_function(fun = total_cost, color = purple, size = 1) 
```
]


TP函数 .mono[+] 投入要素价格 <br> .mono[-->] .purple.hi[**TC曲线**] 。

.pink[思考]为什么总成本曲线是S型？

.purple.hi[边际产量递减先增后减。但产量其实企业的最终行为结果。既然边际产量一段时间会增加，意味着该时期内的边际成本很可能是降低的。] 

---

### 边际成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
marginal_cost <- function(x) 10 - 8*x + 3*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "SMC") +
  stat_function(fun = marginal_cost, color = purple, size = 1) 
```
]


#### 定义

> 产量增加一个单位所产生的总成本的变化。 


基于深入理解边际成本，我们就要走进**成本世界**的内部看看了。

---
### 总成本的构成

#### 总成本 .mono[=] .green[固定成本] .mono[+] .pink[可变成本]

#### .green[固定成本]

> .green[成本不随产出数量的变化而变化]

- 如租金、设备成本、贷款支付等
- 对边际成本MC没有影响

#### .pink[可变成本]

> .pink[成本随产出数量变化而变化]

- 如工资, 原材料成本等
- 对边际成本MC有影响

---
### 总成本的构成

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
vc <- function(x) 10*x - 4*x^2 + x^3
fc <- function(x) 10

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = fc, color = green, size = 1) +
  stat_function(fun = total_cost, color = purple, size = 1) +
  stat_function(fun = vc, color = red_pink, size = 1) +
  annotate("text", label = "TC", x = 3.6, y = 50, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = "VC", x = 4.75, y = 50, color = red_pink, family = cnfont, size = 7.7) +
  annotate("text", label = "FC", x = 4.75, y = 13, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
#### .green[固定成本(FC)]


#### .pink[可变成本 (VC)]

]

---
### 平均固定成本AFC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
afc <- function(x) 10/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = afc, color = green, size = 1) +
  annotate("text", label = "AFC", x = 4.75, y = 5.5, color = green, family = cnfont, size = 7.7)

```
]

.less-right[
#### 定义

> AFC .mono[=] FC &divide; TP

随着产量上升而减少 <br> .mono[-->] 更多产出分摊FC

]

---
### 平均可变成本AVC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = avc, color = red_pink, size = 1) +
  annotate("text", label = "AVC", x = 4.75, y = 18, color = red_pink, family = cnfont, size = 7.7)

```
]

.less-right[
#### 定义

> AVC .mono[=] VC &divide; TP

]

---
### 平均总成本 ATC

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[
#### 定义

> ATC .mono[=] TC &divide; TP <br> .mono[=] AFC .mono[+] AVC

]

---
count: false
### 有效规模

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 7.7) +
  geom_vline(xintercept = 2.69, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = "有效规模", x = 2.69, y = 60, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
#### 定义

使平均总成本最小化的生成规模
]

---
### 边际成本与平均成本的关系

.more-left[

```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
total_cost <- function(x) 10 + 10*x - 4*x^2 + x^3
atc <- function(x) (10 + 10*x - 4*x^2 + x^3)/x
marginal_cost <- function(x) 10 - 8*x + 3*x^2
avc <- function(x) (10*x - 4*x^2 + x^3)/x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 65), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "ATC", x = 0.7, y = 50, color = purple, family = cnfont, size = 7.7) +
  stat_function(fun = marginal_cost, color = red_pink, size = 1) +
  annotate("text", label = "MC", x = 4.8, y = 50, color = red_pink, family = cnfont, size = 7.7) +
  geom_vline(xintercept = 2.69, color = met_slate, size = 1, linetype = "dashed") +
  annotate("label", label = "有效规模", x = 2.69, y = 60, color = met_slate, family = cnfont, size = 4)
```
]

.less-right[
类比MP与AP

.hi.red_pink[MC] .mono[<] .hi.purple[ATC] .mono[==>] .hi.purple[ATC]下降

.hi.red_pink[MC] .mono[>] .hi.purple[ATC] .mono[==>] .hi.purple[ATC]上升

.hi.red_pink[MC] **在最小ATC处** 穿过

]
---
### 短期成本分类

![umcxI1](https://pkuzzq-image.oss-cn-beijing.aliyuncs.com/uPic/umcxI1.png)


---
### 短期决策与长期决策

#### 短期决策

某些要素投入是固定的，如土地、工厂、装配线机器人等资本要素投入固定
- 固定成本不变

#### 长期决策

- 所有要素投入是可变的，如厂商可以建立新工厂或出售现有工厂
- 厂商**必须而且可以**配给(rationing)最有效的要素组合
- 达到**有效规模**

---
### 长期平均总成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data <- tibble(
  q = seq(0, 6, 0.01),
  atc_s = 18 - 8*q + 3*q^2,
  atc_m = 30- 16*q + 3*q^2,
  atc_l = 60 - 24*q + 3*q^2
) %>% 
  mutate(atc = case_when(atc_s <= atc_m & atc_s <= atc_l ~ atc_s,
                         atc_m <= atc_s & atc_m <= atc_l ~ atc_m,
                         atc_l <= atc_s & atc_l <= atc_m ~ atc_l))

cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = atc_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_l), color = orange, size = 1, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SATC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SATC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SATC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "TP", y = "￥")
```
]

.less-right[
- 长期可以改变规模类型，但短期不能
- 厂商可以选择从3个工厂规模: S、M、L，按照发展规模从小到大
- 每种规模都有自己的SATC曲线
]

---
### 长期平均总成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
cost_data %>% 
  ggplot() +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 27), expand=c(0,0), breaks = scales::pretty_breaks()) +
  geom_line(aes(x = q, y = atc_s), color = red_pink, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_m), color = green, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc_l), color = orange, size = 1, linetype = "solid") +
  geom_line(aes(x = q, y = atc), color = purple, size = 1.5, linetype = "solid") +
  theme_market +
  annotate("text", label = expression(SATC[S]), x = 0.7, y = 16, color = red_pink, family = cnfont, size = 4.5) +
  annotate("text", label = expression(SATC[M]), x = 2.7, y = 10, color = green, family = cnfont, size = 4.5) +
  annotate("text", label = expression(LATC), x = 4, y = 8.5, color = purple, family = cnfont, size = 7.7) +
  annotate("text", label = expression(SATC[L]), x = 4.95, y = 18, color = orange, family = cnfont, size = 4.5) +
  labs(x = "TP", y = "￥")
```
]

.less-right[



]

---
### 长期平均总成本

.more-left[
```{r, echo = FALSE, fig.height = 5, fig.width = 5, dev = "svg"}
x <- seq(0, 6, 0.1)
atc <- function(x) 10 - 2.75*x + 0.5*x^2

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 5.5), expand=c(0,0), breaks = scales::pretty_breaks()) +
  scale_y_continuous(limits = c(0, 11), expand=c(0,0), breaks = scales::pretty_breaks()) +
  theme_market +
  labs(x = "TP", y = "￥")+
  stat_function(fun = atc, color = purple, size = 1) +
  annotate("text", label = "LATC", x = 4.5, y = 6.4, color = purple, family = cnfont, size = 7.7)
```
]

.less-right[
经典的LATC曲线
- "微笑曲线"
- **规模报酬** 决定了企业的长期平均总成本在什么位置

]

---
### 规模报酬 Returns to Scale

- 规模经济，也叫内在经济(economies of scale)
> LATC 随着产出数量的增加而下降的阶段
- 专业化程度变高、知识和技术的溢出效应。例如初创科技公司？

- 规模报酬不变 (constant returns to scale)
> LATC 随着产出数量的增加而保持不变的阶段。例如连锁店?

- 规模不经济，也叫内在经济(diseconomies of scale)
> LATC 随着产出数量的增加而上升的阶段
- 大而慢。例如医院？

---

exclude: true

```{R, generate pdfs, include = F, eval = F}

pagedown::chrome_print("Lec03.html", output = "Lec03.pdf")

```


